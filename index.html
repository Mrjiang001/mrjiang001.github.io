<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Mr Jiang</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="野生程序员一枚，对我温柔点。。。。。。">
<meta property="og:type" content="website">
<meta property="og:title" content="Mr Jiang">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Mr Jiang">
<meta property="og:description" content="野生程序员一枚，对我温柔点。。。。。。">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Mr Jiang">
<meta property="article:tag" content="Python">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Mr Jiang" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Mr Jiang</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">头发还够，那就再多学点</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-并发编程基础" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/29/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/" class="article-date">
  <time datetime="2018-11-28T17:09:46.000Z" itemprop="datePublished">2018-11-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/29/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/">并发编程基础</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="并发编程"><a href="#并发编程" class="headerlink" title="并发编程"></a>并发编程</h2><h3 id="1-操作系统发展史"><a href="#1-操作系统发展史" class="headerlink" title="1) 操作系统发展史"></a>1) 操作系统发展史</h3><h4 id="1-1-穿孔卡片"><a href="#1-1-穿孔卡片" class="headerlink" title="1.1 穿孔卡片 -"></a>1.1 穿孔卡片 -</h4><ul>
<li>读取数据速度特别慢</li>
<li>CPU的利用率极低</li>
<li>单用户(一份代码)使用</li>
</ul>
<h4 id="1-2-批处理"><a href="#1-2-批处理" class="headerlink" title="1.2 批处理"></a>1.2 批处理</h4><ul>
<li><p>读取数据速度特别慢</p>
</li>
<li><p>CPU的利用率极低</p>
</li>
<li><p>联机（多份代码）使用</p>
</li>
<li><p>效率还是很低</p>
</li>
</ul>
<h4 id="1-3-脱机批处理（现代操作系统的设计原理）"><a href="#1-3-脱机批处理（现代操作系统的设计原理）" class="headerlink" title="1.3 脱机批处理（现代操作系统的设计原理）"></a>1.3 脱机批处理（现代操作系统的设计原理）</h4><ul>
<li>读取数据速度提高</li>
<li>CPU的利用率提高</li>
<li>每次运行期间发出I/O请求后后,高速 的cpu便会处于空闲</li>
</ul>
<h3 id="2-多道技术-基于单核背景下产生的"><a href="#2-多道技术-基于单核背景下产生的" class="headerlink" title="2)多道技术(基于单核背景下产生的)"></a>2)多道技术(基于单核背景下产生的)</h3><h4 id="单道-串行"><a href="#单道-串行" class="headerlink" title="单道:(串行)"></a>单道:(串行)</h4><ul>
<li>比如: a,b程序同时需要使用cpu，会让a程序先使用，b等待a使用完毕后，b才能使用cpu。</li>
</ul>
<h4 id="多道"><a href="#多道" class="headerlink" title="多道:"></a>多道:</h4><ul>
<li>比如: a,b程序需要使用cpu，a先使用，b等待a，直到a进入“IO或执行时间过长” a会（切换 + 保存状态），然后b可以使用cpu，待b执行遇到 “IO或执行时间过长” 再将cpu执行权限交给a，直到两个程序结束。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">多路复用:</span><br><span class="line"><span class="comment"># 空间上的复用（*******）:多个程序使用一个CPU。</span></span><br><span class="line">将内存分为几部分，每个部分放入一个程序，这样，同一时间内存中就有了多道程序</span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">空间上的复用最大的问题是：程序之间的内存必须分割，这种分割需要在硬件层面实现，由操作系统控制。如果内存彼此不分割，则一个程序可以访问另外一个程序的内存，</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">首先丧失的是安全性，比如你的qq程序可以访问操作系统的内存，这意味着你的qq可以拿到操作系统的所有权限。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">其次丧失的是稳定性，某个程序崩溃时有可能把别的程序的内存也给回收了，比方说把操作系统的内存给回收了，则操作系统崩溃。</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">时间上的复用（*******）:即切换 + 保存状态</span><br><span class="line">当一个程序在等待I/O时，另一个程序可以使用cpu，如果内存中可以同时存放足够多的作业，则cpu的利用率可以接近<span class="number">100</span>%，类似于我们小学数学所学的统筹方法。（操作系统采用了多道技术后，可以控制进程的切换，或者说进程之间去争抢cpu的执行权限。这种切换不仅会在一个进程遇到io时进行，一个进程占用cpu时间过长也会切换，或者说被操作系统夺走cpu的执行权限）</span><br><span class="line">    </span><br><span class="line"><span class="number">1</span>) 当执行程序遇到IO时，操作系统会将CPU的执行权限剥夺。</span><br><span class="line">优点: CPU的执行效率提高</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>) 当执行程序执行时间过长时，操作系统会将CPU的执行权限剥夺。    </span><br><span class="line">缺点: 程序的执行效率低</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">    特点：</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">　　（1）多路性。若干个用户同时使用一台计算机。微观上看是各用户轮流使用计算机；宏观上看是各用户并行工作。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">　　（2）交互性。用户可根据系统对请求的响应结果，进一步向系统提出新的请求。这种能使用户与系统进行人机对话的工作方式，明显地有别于批处理系统，因而，分时系统又被称为交互式系统。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">　　（3）独立性。用户之间可以相互独立操作，互不干扰。系统保证各用户程序运行的完整性，不会发生相互混淆或破坏现象。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">　　（4）及时性。系统可对用户的输入及时作出响应。分时系统性能的主要指标之一是响应时间，它是指：从终端发出命令到系统予以应答所需的时间。</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure>

<p><img src="https://user-images.githubusercontent.com/57135669/88485351-c6cc7e80-cfa7-11ea-85de-7b83fac73242.png" alt="并1"><br><img src="https://user-images.githubusercontent.com/57135669/88485355-c92ed880-cfa7-11ea-9860-fc5d13052db8.png" alt="并2"></p>
<h4 id="并发与并行-（-）"><a href="#并发与并行-（-）" class="headerlink" title="并发与并行:（***）"></a>并发与并行:（<strong>***</strong>）</h4><p><strong>并发:</strong> 在单核（一个cpu）情况下，当执行两个a,b程序时，a先执行，当a遇到IO时，b开始争抢cpu的执行权限，再让b执行，他们看起像同时运行。</p>
<p><strong>并行:</strong> 在多核（多个cpu）的情况下，当执行两个a,b程序时，a与b同时执行。他们是真正意义上的同时运行。</p>
<p><strong>面试题:</strong> 在单核情况下能否实现并行？ 不行</p>
<h3 id="3-进程"><a href="#3-进程" class="headerlink" title="3) 进程"></a>3) 进程</h3><h4 id="1-什么是进程？"><a href="#1-什么是进程？" class="headerlink" title="1.什么是进程？"></a>1.什么是进程？</h4><p>正在进行的一个过程或者说一个任务。是系统进行资源分配和调度的基本单位，是操作系统结构的基础。</p>
<p>进程是操作系统中最基本、重要的概念。是多道程序系统出现后，为了刻画系统内部出现的动态情况，描述系统内部各道程序的活动规律引进的一个抽象概念,所有多道程序设计操作系统都建立在进程的基础上。</p>
<h4 id="2-进程与程序"><a href="#2-进程与程序" class="headerlink" title="2.进程与程序:"></a>2.进程与程序:</h4><ul>
<li>程序: 一对代码文件。</li>
<li>进程: 执行代码的过程，称之为进程。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 举个例子</span></span><br><span class="line">想象一位tom猫正在给他的宿敌jerry做奶油蛋糕。</span><br><span class="line"></span><br><span class="line">他有做奶油蛋糕的食谱及所需的所有原料:面粉、鸡蛋、奶油等。</span><br><span class="line"></span><br><span class="line">在这个比喻中：</span><br><span class="line"></span><br><span class="line">做蛋糕的食谱就是程序</span><br><span class="line"></span><br><span class="line">tom猫就是处理器(cpu)</span><br><span class="line"></span><br><span class="line">而做蛋糕的各种原料就是输入数据</span><br><span class="line"></span><br><span class="line">进程就是tom阅读食谱、取来各种原料以及烘制蛋糕等一系列动作的总和</span><br><span class="line"></span><br><span class="line">现在假设tom猫的主人站在门外需要tom去开门</span><br><span class="line"></span><br><span class="line">tom想了想，给主人开门的任务比给jerry鼠做蛋糕的任务更重要，于是tom立马先记下照着食谱做到第几步(保存进程的当前状态)，然后跑去给主人开门。这里，我们看到处理机从一个进程(做蛋糕)切换到另一个高优先级的进程(开门)，每个进程拥有各自的程序(食谱和开锁)。开门之后，tom又回来从他离开时的那一步继续做蛋糕</span><br><span class="line"></span><br><span class="line">需要强调的是：同一个程序执行两次，那也是两个进程，比如打开快播，虽然都是同一个软件，但是一个可以播放苍井空,一个可以播放饭岛爱,分别做不同的事情也不会混乱</span><br></pre></td></tr></table></figure>

<h4 id="3-进程调度-了解"><a href="#3-进程调度-了解" class="headerlink" title="3 进程调度: (了解)"></a>3 进程调度: (了解)</h4><ul>
<li><p>先来先服务调度算法(了解)</p>
<p>比如程序 a，b，若a先来，则让a先服务，待a服务完毕后，b再服务。</p>
<p>缺点: 执行效率低。</p>
</li>
<li><p>短作业优先调度算法(了解)</p>
<p>执行时间越短，则先先调度。</p>
<p>缺点: 导致执行时间长的程序，需要等待所有时间短的程序执行完毕后，才能执行。</p>
<p>现代操作系统的进程调度算法: 时间片轮转法 + 多级反馈队列 (知道)</p>
</li>
<li><p>时间片轮转法</p>
</li>
</ul>
<p>时间片轮转(Round Robin，RR)法的基本思路是让每个进程在就绪队列中的等待时间与享受服务的时间成比例。在时间片轮转法中，需要将CPU的处理时间分成固定大小的时间片，例如，几十毫秒至几百毫秒。如果一个进程在被调度选中之后用完了系统规定的时间片，但又未完成要求的任务，则它自行释放自己所占有的CPU而排到就绪队列的末尾，等待下一次调度。同时，进程调度程序又去调度当前就绪队列中的第一个进程。</p>
<p>比如同时有10个程序需要执行，操作系统会给你10秒，然后时间片轮转法会将10秒分成10等分。</p>
<ul>
<li>多级反馈队列:</li>
</ul>
<p>1级队列: 优先级最高，先执行次队列中程序。</p>
<p>2级队列: 优先级以此类推</p>
<p>3级队列:</p>
<ul>
<li><pre><code class="python">前面介绍的各种用作进程调度的算法都有一定的局限性。如短进程优先的调度算法，仅照顾了短进程而忽略了长进程，而且如果并未指明进程的长度，则短进程优先和基于进程长度的抢占式调度算法都将无法使用。
而多级反馈队列调度算法则不必事先知道各种进程所需的执行时间，而且还可以满足各种类型进程的需要，因而它是目前被公认的一种较好的进程调度算法。在采用多级反馈队列调度算法的系统中，调度算法的实施过程如下所述。
(<span class="number">1</span>) 应设置多个就绪队列，并为各个队列赋予不同的优先级。第一个队列的优先级最高，第二个队列次之，其余各队列的优先权逐个降低。该算法赋予各个队列中进程执行时间片的大小也各不相同，在优先权愈高的队列中，为每个进程所规定的执行时间片就愈小。例如，第二个队列的时间片要比第一个队列的时间片长一倍，……，第i+<span class="number">1</span>个队列的时间片要比第i个队列的时间片长一倍。
(<span class="number">2</span>) 当一个新进程进入内存后，首先将它放入第一队列的末尾，按FCFS原则排队等待调度。当轮到该进程执行时，如它能在该时间片内完成，便可准备撤离系统；如果它在一个时间片结束时尚未完成，调度程序便将该进程转入第二队列的末尾，再同样地按FCFS原则等待调度执行；如果它在第二队列中运行一个时间片后仍未完成，再依次将它放入第三队列，……，如此下去，当一个长作业(进程)从第一队列依次降到第n队列后，在第n 队列便采取按时间片轮转的方式运行。

(<span class="number">3</span>) 仅当第一队列空闲时，调度程序才调度第二队列中的进程运行；仅当第<span class="number">1</span>～(i<span class="number">-1</span>)队列均空时，才会调度第i队列中的进程运行。如果处理机正在第i队列中为某进程服务时，又有新进程进入优先权较高的队列(第<span class="number">1</span>～(i<span class="number">-1</span>)中的任何一个队列)，则此时新进程将抢占正在运行进程的处理机，即由调度程序把正在运行的进程放回到第i队列的末尾，把处理机分配给新到的高优先权进程。
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#### 4) 同步与异步(*******):</span><br><span class="line"></span><br><span class="line">同步与异步 指的是 “提交任务的方式”。</span><br><span class="line"></span><br><span class="line">同步（串行）: 两个a，b程序都要提交并执行，假如a先提交执行，b必须等a执行完毕后，才能提交任务。</span><br></pre></td></tr></table></figure>
一个任务的完成需要依赖另外一个任务时，只有等待被依赖的任务完成后，依赖的任务才能算完成，这是一种可靠的任务序列。要么成功都成功，失败都失败，两个任务的状态可以保持一致。
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">异步（并发）: 两个a，b程序都要提交并执行，假如a先提交并执行，b无需等a执行完毕，就可以直接提交任务。</span><br></pre></td></tr></table></figure>
不需要等待被依赖的任务完成，只是通知被依赖的任务要完成什么工作，依赖的任务也立即执行，只要自己完成了整个任务就算完成了。至于被依赖的任务最终是否真正完成，依赖它的任务无法确定，所以它是不可靠的任务序列。
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#### 5)阻塞与非阻塞(*******):</span><br><span class="line"></span><br><span class="line">- 阻塞（等待）: 凡是遇到IO都会阻塞。</span><br><span class="line"></span><br><span class="line">  IO: input &#x2F;output , time.sleep(3) , 文件的读写 , 数据的传输</span><br><span class="line"></span><br><span class="line">- 非阻塞 (不等待) : 除了IO都是非阻塞 （比如: 从1+1开始计算到100万这种计算过程不是阻塞）</span><br><span class="line"></span><br><span class="line">#### 6) 进程的三种状态（*******）:</span><br><span class="line"></span><br><span class="line">- 就绪态: 同步与异步</span><br><span class="line">- 运行态: 程序的执行时间过长 ----&gt; 将程序返回给就绪态(这是非阻塞)</span><br><span class="line">- 阻塞态: 遇到IO</span><br><span class="line"></span><br><span class="line">![并3](https:&#x2F;&#x2F;user-images.githubusercontent.com&#x2F;57135669&#x2F;88485365-d3e96d80-cfa7-11ea-9ab0-36f3669b1421.png)</span><br><span class="line"></span><br><span class="line">**面试题:** 阻塞与同步是一样的吗？非阻塞与异步是一样的吗？</span><br><span class="line"></span><br><span class="line">答:</span><br><span class="line">IO密集型:这时阻塞与同步是不一样的,</span><br><span class="line">计算密集型:这是阻塞与同步看起来一样,但是本质上仍然不一样</span><br><span class="line">同步与异步:提交任务的方式</span><br><span class="line"></span><br><span class="line">阻塞与非阻塞: 进程的状态。</span><br><span class="line"></span><br><span class="line">异步非阻塞: ----&gt; cpu的利用率最大化!</span><br><span class="line"></span><br><span class="line">#### 7) 创建进程的方式:</span><br><span class="line"></span><br><span class="line">但凡是硬件，都需要有操作系统去管理，只要有操作系统，就有进程的概念，就需要有创建进程的方式，一些操作系统只为一个应用程序设计，比如扫地机器人，一旦启动，所有的进程都已经存在。</span><br><span class="line"></span><br><span class="line">　　而对于通用系统（跑很多应用程序），需要有系统运行过程中创建或撤销进程的能力，主要分为4中形式创建新的进程：</span><br><span class="line"></span><br><span class="line">　　1. 系统初始化（查看进程linux中用ps命令，windows中用任务管理器，前台进程负责与用户交互，后台运行的进程与用户无关，运行在后台并且只在需要时才唤醒的进程，称为守护进程，如电子邮件、web页面、新闻、打印）</span><br><span class="line"></span><br><span class="line">　　2. 一个进程在运行过程中开启了子进程（如nginx开启多进程，os.fork,subprocess.Popen等）</span><br><span class="line"></span><br><span class="line">　　3. 用户的交互式请求，而创建一个新进程（如用户用鼠标双击任意一款软件图片:qq,微信,暴风影音等）</span><br><span class="line"></span><br><span class="line">　　4. 一个批处理作业的初始化（只在大型机的批处理系统中应用）</span><br><span class="line"></span><br><span class="line">　　无论哪一种，新进程的创建都是由一个已经存在的进程执行了一个用于创建进程的系统调用而创建的。　</span><br><span class="line"></span><br><span class="line">##### **multiprocess模块**</span><br><span class="line"></span><br><span class="line">仔细说来，multiprocess不是一个模块而是python中一个操作、管理进程的包。 之所以叫multi是取自multiple的多功能的意思,在这个包中几乎包含了和进程有关的所有子模块。由于提供的子模块非常多，为了方便大家归类记忆，我将这部分大致分为四个部分：创建进程部分，进程同步部分，进程池部分，进程之间数据共享。</span><br><span class="line"></span><br><span class="line">##### **Process类创建进程的两种方式**</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;python</span><br><span class="line">from multiprocessing import Process</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 方式1: 直接调用Process</span><br><span class="line">def task(name):  # 任务  # name &#x3D;&#x3D; &#39;jason_sb&#39;</span><br><span class="line">    print(f&#39;start...&#123;name&#125;的子进程&#39;)</span><br><span class="line">    time.sleep(3)</span><br><span class="line">    print(f&#39;end...&#123;name&#125;的子进程&#39;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    # target&#x3D;任务(函数地址) ---&gt; 创建一个子进程</span><br><span class="line">    # 异步提交了三个任务</span><br><span class="line">    p_obj1 &#x3D; Process(target&#x3D;task, args&#x3D;(&#39;jason_sb&#39;, ))</span><br><span class="line">    p_obj1.start()  # 告诉操作系统，去创建一个子进程</span><br><span class="line">    p_obj1.join()  # 告诉主进程，等待子进程结束后，再结束</span><br><span class="line"></span><br><span class="line">    p_obj2 &#x3D; Process(target&#x3D;task, args&#x3D;(&#39;sean_sb&#39;, ))</span><br><span class="line">    p_obj2.start()  # 告诉操作系统，去创建一个子进程</span><br><span class="line">    p_obj2.join()  # 告诉主进程，等待子进程结束后，再结束</span><br><span class="line"></span><br><span class="line">    p_obj3 &#x3D; Process(target&#x3D;task, args&#x3D;(&#39;大饼_sb&#39;, ))</span><br><span class="line">    p_obj3.start()  # 告诉操作系统，去创建一个子进程</span><br><span class="line">    p_obj3.join()  # 告诉主进程，等待子进程结束后，再结束</span><br><span class="line"></span><br><span class="line">    print(&#39;正在执行当前主进程...&#39;)</span><br><span class="line"></span><br><span class="line">    list1 &#x3D; []</span><br><span class="line"></span><br><span class="line">    for line in range(10):</span><br><span class="line">        p_obj &#x3D; Process(target&#x3D;task, args&#x3D;(&#39;jason_sb&#39;,))</span><br><span class="line">        p_obj.start()</span><br><span class="line">        list1.append(p_obj)</span><br><span class="line"></span><br><span class="line">    for obj in list1:</span><br><span class="line">        obj.join()</span><br><span class="line"></span><br><span class="line">    print(&#39;主进程&#39;)</span><br><span class="line"># 方式二:</span><br><span class="line">from multiprocessing import Process</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class MyProcess(Process):</span><br><span class="line">    def run(self):</span><br><span class="line">        print(f&#39;start...&#123;self.name&#125;的子进程&#39;)</span><br><span class="line">        time.sleep(3)</span><br><span class="line">        print(f&#39;end...&#123;self.name&#125;的子进程&#39;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    list1 &#x3D; []</span><br><span class="line"></span><br><span class="line">    for line in range(10):</span><br><span class="line">        obj &#x3D; MyProcess()</span><br><span class="line">        obj.start()</span><br><span class="line">        list1.append(obj)</span><br><span class="line"></span><br><span class="line">    for obj in list1:</span><br><span class="line">        obj.join()</span><br><span class="line"></span><br><span class="line">    print(&#39;主进程...&#39;)</span><br></pre></td></tr></table></figure>
</code></pre>
</li>
</ul>
<p>‘’’<br>强调:在Windows操作系统中由于没有fork(linux操作系统中创建进程的机制)，在创建子进程的时候会自动 import 启动它的这个文件，而在 import 的时候又执行了整个文件。因此如果将process()直接写在文件中就会无限递归创建子进程报错。所以必须把创建子进程的部分使用if <strong>name ==‘</strong>main’ 判断保护起来，import 的时候 ，就不会递归运行了。</p>
<p>‘’’</p>
<h4 id="8-回收进程的两种方式"><a href="#8-回收进程的两种方式" class="headerlink" title="8)回收进程的两种方式"></a>8)回收进程的两种方式</h4><ul>
<li>join让主进程等待子进程结束，并回收子进程资源，主进程再结束并回收资源。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 第一种</span></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span>  Process</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment">#任务</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">task</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">'start...'</span>)</span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line">    print(<span class="string">'end...'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    p = Process(target=task)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 告诉操作系统帮你开启一个新的进程</span></span><br><span class="line">    p.start()</span><br><span class="line">    <span class="comment"># 告诉操作系统等待子进程结束</span></span><br><span class="line">    p.join()</span><br><span class="line"></span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">'主进程结束'</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>主进程 “正常结束” ，子进程与主进程一并被回收资源。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 第二种</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string"> 主进程 “正常结束” ，子进程与主进程一并被回收资源。</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span>  Process</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment">#任务</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">task</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">'start...'</span>)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    print(<span class="string">'end...'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    p = Process(target=task)</span><br><span class="line">    <span class="comment"># 告诉操作系统帮你开启一个新的进程</span></span><br><span class="line">    p.start()</span><br><span class="line"></span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line">    print(<span class="string">'主进程结束'</span>)</span><br></pre></td></tr></table></figure>

<h4 id="9-僵尸进程与孤儿进程（了解）"><a href="#9-僵尸进程与孤儿进程（了解）" class="headerlink" title="9)僵尸进程与孤儿进程（了解）"></a>9)僵尸进程与孤儿进程（了解）</h4><ul>
<li><p><strong>僵尸进程 (有坏处):</strong></p>
<p>在子进程结束后，主进程没有正常结束, 子进程PID不会被回收。 <strong>缺点:</strong> 操作系统中的PID号是有限的，如有子进程PID号无法正常回收，则会占用PID号,造成资源浪费,若PID号满了,则无法创建新的进程。</p>
<p>词语解释:PID</p>
<p>进程pID（英语：processID）、PID）是大多数操作系统的内核用于唯一标识进程的一个数值。（简言之，就是进程的绰号。）这一数值可以作为许多函数调用的参数，以使调整进程优先级、kill(命令)进程之类的进程控制行为成为可能。</p>
</li>
<li><p><strong>孤儿进程（没有坏处）</strong>:</p>
<p>在子进程没有结束时，主进程没有“正常结束”, 子进程PID不会被回收。</p>
<p><strong>操作系统优化机制（孤儿院）:</strong> 当主进程意外终止，操作系统会检测是否有正在运行的子进程，会他们放入孤儿院中，让操作系统帮你自动回收。</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">僵尸进程</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在子进程中调用可以拿到子进程对象,.pid可以获取pid号</span></span><br><span class="line"><span class="comment"># 在主进程中调用可以拿到主进程对象,.pid可以获取pid号</span></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> current_process</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="comment"># current_porcess模块中的current_process().pid和os模块的os.getpid()</span></span><br><span class="line"><span class="comment"># 都可以获取子进程和主进程的pid号</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># 任务</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">task</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">f'start...<span class="subst">&#123;current_process().pid&#125;</span>'</span>)</span><br><span class="line">    time.sleep(<span class="number">3</span>)</span><br><span class="line">    print(<span class="string">f'end.....<span class="subst">&#123;current_process().pid&#125;</span>'</span>)</span><br><span class="line">    print(<span class="string">'子进程结束了'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    p = Process(target=task)</span><br><span class="line"></span><br><span class="line">    p.start()</span><br><span class="line"></span><br><span class="line">    print(<span class="string">f'进入主进程的IO---&gt;<span class="subst">&#123;current_process().pid&#125;</span>'</span>)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">f'进入主进程的IO---&gt;<span class="subst">&#123;os.getpid()&#125;</span>'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 主进程结束</span></span><br><span class="line">    print(<span class="string">'主进程结束...'</span>)</span><br><span class="line">    print(<span class="string">f'查看主进程<span class="subst">&#123;os.getpid()&#125;</span>'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 为了让主程序异常报错结束</span></span><br><span class="line">    f = open(<span class="string">'tank.txt'</span>)</span><br><span class="line">    print(<span class="string">f'查看主进程<span class="subst">&#123;os.getpid()&#125;</span>'</span>)</span><br></pre></td></tr></table></figure>

<h4 id="10-守护进程"><a href="#10-守护进程" class="headerlink" title="10)守护进程"></a>10)守护进程</h4><p>当主进程结束时，子进程也必须结束，并回收。</p>
<p>主进程创建守护进程</p>
<p>　　其一：守护进程会在主进程代码执行结束后就终止</p>
<p>　　其二：守护进程内无法再开启子进程,否则抛出异常：AssertionError: daemonic processes are not allowed to have children</p>
<p>注意：进程之间是互相独立的，主进程代码运行结束，守护进程随即终止</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Myprocess</span><span class="params">(Process)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,person)</span>:</span></span><br><span class="line">        super().__init__()</span><br><span class="line">        self.person = person</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(os.getpid(),self.name)</span><br><span class="line">        print(<span class="string">'%s正在和女主播聊天'</span> %self.person)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p=Myprocess(<span class="string">'炮王'</span>)</span><br><span class="line">p.daemon=<span class="literal">True</span>  <span class="comment"># 一定要在p.start()前设置,设置p为守护进程,禁止p创建子进程,并且父进程代码执行结束,p即终止运行</span></span><br><span class="line">p.start()</span><br><span class="line">time.sleep(<span class="number">10</span>)  <span class="comment"># 在sleep时查看进程id对应的进程ps -ef|grep id</span></span><br><span class="line">print(<span class="string">'主'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 一个迷惑性的例子</span></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="number">123</span>)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    print(<span class="string">"end123"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bar</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="number">456</span>)</span><br><span class="line">    time.sleep(<span class="number">3</span>)</span><br><span class="line">    print(<span class="string">"end456"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p1=Process(target=foo)</span><br><span class="line">p2=Process(target=bar)</span><br><span class="line"></span><br><span class="line">p1.daemon=<span class="literal">True</span></span><br><span class="line">p1.start()</span><br><span class="line">p2.start()</span><br><span class="line">time.sleep(<span class="number">0.1</span>)</span><br><span class="line">print(<span class="string">"main-------"</span>)<span class="comment">#打印该行则主进程代码结束,则守护进程p1应该被终止.#可能会有p1任务执行的打印信息123,因为主进程打印main----时,p1也执行了,但是随即被终止.</span></span><br></pre></td></tr></table></figure>

<h4 id="11-进程间数据隔离"><a href="#11-进程间数据隔离" class="headerlink" title="11)进程间数据隔离"></a>11)进程间数据隔离</h4><p><strong>进程隔离</strong>是为保护操作系统中进程互不干扰而设计的一组不同硬件和软件的技术</p>
<p>这个技术是为了避免进程A写入进程B的情况发生。 进程的隔离实现，使用了虚拟地址空间。进程A的虚拟地址和进程B的虚拟地址不同，这样就防止进程A将数据信息写入进程B</p>
<p>进程隔离的安全性通过禁止进程间内存的访问可以方便实现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line">n=<span class="number">100</span> </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">work</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span> n  </span><br><span class="line">    n=<span class="number">0</span></span><br><span class="line">    print(<span class="string">'子进程内: '</span>,n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    p=Process(target=work)</span><br><span class="line">    p.start()</span><br><span class="line">    print(<span class="string">'主进程内: '</span>,n)</span><br></pre></td></tr></table></figure>

<h4 id="12-进程互斥锁-multiprocess-Lock"><a href="#12-进程互斥锁-multiprocess-Lock" class="headerlink" title="12)进程互斥锁(multiprocess.Lock)"></a>12)进程互斥锁(multiprocess.Lock)</h4><p>进程之间数据不共享,但是共享同一套文件系统,所以访问同一个文件,或同一个打印终端,是没有问题的,</p>
<p>而共享带来的是竞争，竞争带来的结果就是错乱，如何控制，就是加锁处理</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#文件db的内容为：&#123;"count":1&#125;</span></span><br><span class="line"><span class="comment">#注意一定要用双引号，不然json无法识别</span></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process,Lock</span><br><span class="line"><span class="keyword">import</span> time,json,random</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">search</span><span class="params">()</span>:</span></span><br><span class="line">    dic=json.load(open(<span class="string">'db'</span>))</span><br><span class="line">    print(<span class="string">'\033[43m剩余票数%s\033[0m'</span> %dic[<span class="string">'count'</span>])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">()</span>:</span></span><br><span class="line">    dic=json.load(open(<span class="string">'db'</span>))</span><br><span class="line">    time.sleep(<span class="number">0.1</span>) <span class="comment">#模拟读数据的网络延迟</span></span><br><span class="line">    <span class="keyword">if</span> dic[<span class="string">'count'</span>] &gt;<span class="number">0</span>:</span><br><span class="line">        dic[<span class="string">'count'</span>]-=<span class="number">1</span></span><br><span class="line">        time.sleep(<span class="number">0.2</span>) <span class="comment">#模拟写数据的网络延迟</span></span><br><span class="line">        json.dump(dic,open(<span class="string">'db'</span>,<span class="string">'w'</span>))</span><br><span class="line">        print(<span class="string">'\033[43m购票成功\033[0m'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">task</span><span class="params">()</span>:</span></span><br><span class="line">    search()</span><br><span class="line">    get()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100</span>): <span class="comment">#模拟并发100个客户端抢票</span></span><br><span class="line">        p=Process(target=task)</span><br><span class="line">        p.start()</span><br><span class="line"><span class="comment"># 引发问题:数据写入错乱</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">互斥锁保证数据安全</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process,Lock</span><br><span class="line"><span class="keyword">import</span> time,json,random</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">search</span><span class="params">()</span>:</span></span><br><span class="line">    dic=json.load(open(<span class="string">'db'</span>))</span><br><span class="line">    print(<span class="string">'\033[43m剩余票数%s\033[0m'</span> %dic[<span class="string">'count'</span>])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get</span><span class="params">()</span>:</span></span><br><span class="line">    dic=json.load(open(<span class="string">'db'</span>))</span><br><span class="line">    time.sleep(random.random())  <span class="comment"># 模拟读数据的网络延迟</span></span><br><span class="line">    <span class="keyword">if</span> dic[<span class="string">'count'</span>] &gt;<span class="number">0</span>:</span><br><span class="line">        dic[<span class="string">'count'</span>]-=<span class="number">1</span></span><br><span class="line">        time.sleep(random.random())  <span class="comment"># 模拟写数据的网络延迟</span></span><br><span class="line">        json.dump(dic,open(<span class="string">'db'</span>,<span class="string">'w'</span>))</span><br><span class="line">        print(<span class="string">'\033[32m购票成功\033[0m'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'\033[31m购票失败\033[0m'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">task</span><span class="params">(lock)</span>:</span></span><br><span class="line">    search()</span><br><span class="line">    lock.acquire()  <span class="comment"># 将买票这一环节由并发变成了串行，牺牲了运行效率但是保证了数据的安全</span></span><br><span class="line">    get()</span><br><span class="line">    lock.release()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    lock = Lock()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100</span>):  <span class="comment"># 模拟并发100个客户端抢票</span></span><br><span class="line">        p=Process(target=task,args=(lock,))</span><br><span class="line">        p.start()</span><br><span class="line">总结:加锁可以保证多个进程修改同一块数据时，同一时间只能有一个任务可以进行修改，即串行的修改，没错，速度是慢了，</span><br><span class="line">    </span><br><span class="line">    但牺牲了速度却保证了数据安全。</span><br><span class="line"></span><br><span class="line">问题:虽然可以用文件共享数据显示进程间数据通信但问题是</span><br><span class="line"></span><br><span class="line">效率低(共享数据基于文件，而文件是硬盘上的数据)</span><br><span class="line">需要自己加锁处理</span><br></pre></td></tr></table></figure>

<h4 id="13-队列"><a href="#13-队列" class="headerlink" title="13)队列:"></a>13)队列:</h4><p>FIFO:先进先出简写，指的就是队列<br>FILO:先进后出，指的就是堆栈</p>
<p>先进先出 进—-》 [3, 2, 1] —-》 出 1, 2, 3 ,先存放的数据，就先取出来。</p>
<p>相当于一个第三方的管道，可以存放数据。</p>
<p>应用: 让进程之间数据进行交互。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">基本用法</span><br><span class="line">Queue([maxsize]) <span class="comment"># 创建共享的进程队列 队列底层使用管道和锁定实现。</span></span><br><span class="line"><span class="comment"># 参数 ：maxsize是队列中允许的最大项数。如果省略此参数，则无大小限制。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">代码实现</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Queue</span><br><span class="line">q=Queue(<span class="number">3</span>)  <span class="comment"># 创建一个最大只能容纳3个数据的队列</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">常用方法</span></span><br><span class="line"><span class="string">put ,get ,put_nowait,get_nowait,full,empty</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">q.put(<span class="number">3</span>)  <span class="comment"># 往队列中存放数据</span></span><br><span class="line">q.put(<span class="number">3</span>)</span><br><span class="line">q.put(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">q.put(<span class="number">3</span>)  <span class="comment"># 如果队列已经满了，程序就会停在这里，等待数据被别人取走，再将数据放入队列。如果队列中的数据一直不被取走，程序就会永远停在这里。</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    q.put_nowait(<span class="number">3</span>) <span class="comment"># 可以使用put_nowait，如果队列满了不会阻塞，但是会因为队列满了而报错。</span></span><br><span class="line"><span class="keyword">except</span>:  <span class="comment"># 因此我们可以用一个try语句来处理这个错误。这样程序不会一直阻塞下去，但是会丢掉这个消息。</span></span><br><span class="line">    print(<span class="string">'队列已经满了'</span>)</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="comment"># 因此，我们再放入数据之前，可以先看一下队列的状态，如果已经满了，就不继续put了。</span></span><br><span class="line">print(q.full())  <span class="comment"># 判断队列中数据是否已存放满了</span></span><br><span class="line"></span><br><span class="line">print(q.get())  <span class="comment"># 从队列中获取数据</span></span><br><span class="line">print(q.get())</span><br><span class="line">print(q.get())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(q.get()) <span class="comment"># 同put方法一样，如果队列已经空了，那么继续取就会出现阻塞。</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    q.get_nowait(<span class="number">3</span>) <span class="comment"># 可以使用get_nowait，如果队列满了不会阻塞，但是会因为没取到值而报错。</span></span><br><span class="line"><span class="keyword">except</span>: <span class="comment"># 因此我们可以用一个try语句来处理这个错误。这样程序不会一直阻塞下去。</span></span><br><span class="line">    print(<span class="string">'队列已经空了'</span>)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">print(q.empty())  <span class="comment"># 判断队列中数据是否已经被全部取出</span></span><br><span class="line">基于队列实现进程间通信</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process, Queue</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(q)</span>:</span></span><br><span class="line">    q.put(<span class="string">'hello'</span>)  <span class="comment">#调用主函数中p进程传递过来的进程参数 put函数为向队列中添加一条数据。</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    q = Queue()  <span class="comment"># 创建一个Queue对象</span></span><br><span class="line">    p = Process(target=f, args=(q,)) <span class="comment">#创建一个进程</span></span><br><span class="line">    p.start()</span><br><span class="line">    print(q.get())  <span class="comment"># 从队列中获取数据</span></span><br><span class="line">    p.join()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Queue,Process</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">producer</span><span class="params">(q)</span>:</span></span><br><span class="line">    q.put(<span class="string">'hello big baby!'</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">consumer</span><span class="params">(q)</span>:</span></span><br><span class="line">    print(q.get())</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    q = Queue()</span><br><span class="line">    p = Process(target=producer,args=(q,))</span><br><span class="line">    p.start()</span><br><span class="line">    p1 = Process(target=consumer,args=(q,))</span><br><span class="line">    p1.start()</span><br></pre></td></tr></table></figure>

<h4 id="13-IPC机制（进程间实现通信）"><a href="#13-IPC机制（进程间实现通信）" class="headerlink" title="13)IPC机制（进程间实现通信）"></a>13)IPC机制（进程间实现通信）</h4><p>Inter-Process Communication</p>
<p>我们知道进程之间数据是相互隔离的，要想实现进程间的通信(IPC机制),就必须借助于一些技术才可以，比如multiprocessing模块中的：队列和管道，这两种方式都是可以实现进程间数据传输的，由于队列是管道+锁的方式实现，所以我们着重研究队列即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> JoinableQueue</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">task1</span><span class="params">(q)</span>:</span></span><br><span class="line">    x = <span class="number">100</span></span><br><span class="line">    q.put(x)</span><br><span class="line">    print(<span class="string">'添加数据'</span>)</span><br><span class="line"></span><br><span class="line">    time.sleep(<span class="number">3</span>)</span><br><span class="line">    print(q.get())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">task2</span><span class="params">(q)</span>:</span></span><br><span class="line">    <span class="comment"># 想要在task2中获取task1的x</span></span><br><span class="line">    res = q.get()</span><br><span class="line">    print(<span class="string">f'获取的数据是<span class="subst">&#123;res&#125;</span>'</span>)</span><br><span class="line">    q.put(<span class="number">9527</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="comment"># 产生队列</span></span><br><span class="line">    q = JoinableQueue(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 产生两个不同的子进程</span></span><br><span class="line">    p1 = Process(target=task1, args=(q, ))</span><br><span class="line">    p2 = Process(target=task2, args=(q, ))</span><br><span class="line"></span><br><span class="line">    p1.start()</span><br><span class="line">    p2.start()</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">基于队列实现进程间通信   </span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process, Queue</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(q)</span>:</span></span><br><span class="line">    q.put(<span class="string">'hello'</span>)  <span class="comment">#调用主函数中p进程传递过来的进程参数 put函数为向队列中添加一条数据。</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    q = Queue()  <span class="comment"># 创建一个Queue对象</span></span><br><span class="line">    p = Process(target=f, args=(q,)) <span class="comment">#创建一个进程</span></span><br><span class="line">    p.start()</span><br><span class="line">    print(q.get())  <span class="comment"># 从队列中获取数据</span></span><br><span class="line">    p.join()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Queue,Process</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">producer</span><span class="params">(q)</span>:</span></span><br><span class="line">    q.put(<span class="string">'hello big baby!'</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">consumer</span><span class="params">(q)</span>:</span></span><br><span class="line">    print(q.get())</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    q = Queue()</span><br><span class="line">    p = Process(target=producer,args=(q,))</span><br><span class="line">    p.start()</span><br><span class="line">    p1 = Process(target=consumer,args=(q,))</span><br><span class="line">    p1.start()</span><br></pre></td></tr></table></figure>

<h4 id="14-生产者消费者模型"><a href="#14-生产者消费者模型" class="headerlink" title="14)生产者消费者模型"></a>14)生产者消费者模型</h4><p><strong>生产者消费者模型</strong></p>
<p>在并发编程中使用生产者和消费者模式能够解决绝大多数并发问题。该模式通过平衡生产线程和消费线程的工作能力来提高程序的整体处理数据的速度。</p>
<p><strong>什么是生产者消费者模式</strong></p>
<p>生产者消费者模式是通过一个容器来解决生产者和消费者的强耦合问题。生产者和消费者彼此之间不直接通讯，而通过阻塞队列来进行通讯，所以生产者生产完数据(做包子的)之后不用等待消费者(吃包子的)处理，直接扔给阻塞队列(盘子)，消费者不找生产者要数据，而是直接从阻塞队列里取，阻塞队列就相当于一个缓冲区，平衡了生产者和消费者的处理能力。</p>
<p><strong>为什么要使用生产者和消费者模式</strong></p>
<p>在线程世界里，生产者就是生产数据的线程，消费者就是消费数据的线程。在多线程开发当中，如果生产者处理速度很快，而消费者处理速度很慢，那么生产者就必须等待消费者处理完，才能继续生产数据。同样的道理，如果消费者的处理能力大于生产者，那么消费者就必须等待生产者。为了解决这个问题于是引入了生产者和消费者模式。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">基于队列实现生产者消费者模型</span><br><span class="line"><span class="comment"># 第一个例子</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process,Queue</span><br><span class="line"><span class="keyword">import</span> time,random,os</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">consumer</span><span class="params">(q)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        res=q.get()</span><br><span class="line">        time.sleep(random.randint(<span class="number">1</span>,<span class="number">3</span>))</span><br><span class="line">        print(<span class="string">'%s 吃 %s'</span> %(os.getpid(),res))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">producer</span><span class="params">(q)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">        time.sleep(random.randint(<span class="number">1</span>,<span class="number">3</span>))</span><br><span class="line">        res=<span class="string">'包子%s'</span> %i</span><br><span class="line">        q.put(res)</span><br><span class="line">        print(<span class="string">'%s 生产了 %s'</span> %(os.getpid(),res))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    q=Queue()</span><br><span class="line">    <span class="comment">#生产者们:即厨师们</span></span><br><span class="line">    p1=Process(target=producer,args=(q,))</span><br><span class="line"></span><br><span class="line">    <span class="comment">#消费者们:即吃货们</span></span><br><span class="line">    c1=Process(target=consumer,args=(q,))</span><br><span class="line"></span><br><span class="line">    <span class="comment">#开始</span></span><br><span class="line">    p1.start()</span><br><span class="line">    c1.start()</span><br><span class="line">    print(<span class="string">'主'</span>)</span><br><span class="line">    </span><br><span class="line">   </span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二个例子</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> JoinableQueue</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生产者: 生产数据 ---》 队列</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">producer</span><span class="params">(name, food, q)</span>:</span></span><br><span class="line">    msg = <span class="string">f'<span class="subst">&#123;name&#125;</span> 生产了 <span class="subst">&#123;food&#125;</span> 食物'</span></span><br><span class="line">    <span class="comment"># 生产一个食物，添加到队列中</span></span><br><span class="line">    q.put(food)</span><br><span class="line">    print(msg)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 消费者: 使用数据 《---  列队</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">customer</span><span class="params">(name, q)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            time.sleep(<span class="number">0.5</span>)</span><br><span class="line">            <span class="comment"># 若报错，则跳出循环</span></span><br><span class="line">            food = q.get_nowait()</span><br><span class="line">            msg = <span class="string">f'<span class="subst">&#123;name&#125;</span> 吃了 <span class="subst">&#123;food&#125;</span> 食物!'</span></span><br><span class="line">            print(msg)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    q = JoinableQueue()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 创建两个生产者</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">        p1 = Process(target=producer, args=(<span class="string">'tank1'</span>, <span class="string">f'Pig饲料<span class="subst">&#123;line&#125;</span>'</span>, q))</span><br><span class="line">        p1.start()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 创建两个消费者</span></span><br><span class="line">    c1 = Process(target=customer, args=(<span class="string">'jason'</span>, q))</span><br><span class="line">    c2 = Process(target=customer, args=(<span class="string">'sean'</span>, q))</span><br><span class="line">    c1.start()</span><br><span class="line">    c2.start()</span><br></pre></td></tr></table></figure>

<h3 id="4-线程"><a href="#4-线程" class="headerlink" title="4)线程"></a>4)线程</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">线程:</span><br><span class="line">    <span class="number">1.</span>什么是线程？</span><br><span class="line">        进程: 资源单位。</span><br><span class="line">        线程: 执行单位。</span><br><span class="line"></span><br><span class="line">        线程与进程都是虚拟的概念，为了更好表达某种事物。</span><br><span class="line"></span><br><span class="line">        注意: 开启一个进程，一定会自带一个线程，线程才是真正的执行者。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="number">2.</span>为什么要使用线程？</span><br><span class="line">        节省资源的占用。</span><br><span class="line"></span><br><span class="line">        - 开启进程:</span><br><span class="line">            - <span class="number">1</span>) 会产生一个内存空间，申请一块资源。</span><br><span class="line">            - <span class="number">2</span>) 会自带一个主线程</span><br><span class="line">            - <span class="number">3</span>) 开启子进程的速度要比开启子线程的速度慢</span><br><span class="line"></span><br><span class="line">        - 开启线程</span><br><span class="line">            - <span class="number">1</span>) 一个进程内可以开启多个线程，从进程的内存空间中申请执行单位。</span><br><span class="line">            - <span class="number">2</span>) 节省资源。</span><br><span class="line"></span><br><span class="line">        - 开启三个进程:</span><br><span class="line">            - 占用三份内存资源</span><br><span class="line"></span><br><span class="line">        - 开启三个线程:</span><br><span class="line">            - 从一个内存资源中，申请三个小的执行单位</span><br><span class="line"></span><br><span class="line">        - IO密集型用: 多线程</span><br><span class="line">            - IO(时间由用户定):</span><br><span class="line">                - 阻塞: 切换 + 保存状态</span><br><span class="line"></span><br><span class="line">        - 计算密集型用: 多进程</span><br><span class="line">            - 计算(时间由操作系统定):</span><br><span class="line">                - 计算时间很长 ---&gt; 切换 + 保存状态</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    注意: 进程与进程之间数据是隔离的，线程与线程之间的数据是共享的。</span><br></pre></td></tr></table></figure>

<h4 id="1-什么是线程"><a href="#1-什么是线程" class="headerlink" title="1) 什么是线程"></a>1) 什么是线程</h4><p>在传统操作系统中，每个进程有一个地址空间，而且默认就有一个控制线程</p>
<p>线程顾名思义，就是一条流水线工作的过程，一条流水线必须属于一个车间，一个车间的工作过程是一个进程</p>
<p>车间负责把资源整合到一起，是一个资源单位，而一个车间内至少有一个流水线</p>
<p>流水线的工作需要电源，电源就相当于cpu</p>
<p>所以，<strong>进程只是用来把资源集中到一起（进程只是一个资源单位，或者说资源集合），而线程才是cpu上的执行单位。</strong></p>
<p><strong>多线程（即多个控制线程）</strong>:在一个进程中存在多个控制线程，多个控制线程共享该进程的地址空间，相当于一个车间内有多条流水线，都共用一个车间的资源。</p>
<p>例如，北京地铁与上海地铁是不同的进程，而北京地铁里的13号线是一个线程，北京地铁所有的线路共享北京地铁所有的资源，比如所有的乘客可以被所有线路拉。</p>
<h4 id="2-线程的创建开销小"><a href="#2-线程的创建开销小" class="headerlink" title="2) 线程的创建开销小"></a>2) 线程的创建开销小</h4><p>创建进程的开销要远大于线程？</p>
<p>如果我们的软件是一个工厂，该工厂有多条流水线，流水线工作需要电源，电源只有一个即cpu（单核cpu）</p>
<p>一个车间就是一个进程，一个车间至少一条流水线（一个进程至少一个线程）</p>
<p>创建一个进程，就是创建一个车间（申请空间，在该空间内建至少一条流水线）</p>
<p>而建线程，就只是在一个车间内造一条流水线，无需申请空间，所以创建开销小</p>
<p><strong>进程之间是竞争关系，线程之间是协作关系？</strong></p>
<p>车间直接是竞争/抢电源的关系，竞争（不同的进程直接是竞争关系，是不同的程序员写的程序运行的，迅雷抢占其他进程的网速，360把其他进程当做病毒干死）<br>一个车间的不同流水线式协同工作的关系（同一个进程的线程之间是合作关系，是同一个程序写的程序内开启动，迅雷内的线程是合作关系，不会自己干自己）</p>
<h4 id="3-线程与进程的区别"><a href="#3-线程与进程的区别" class="headerlink" title="3)线程与进程的区别"></a>3)线程与进程的区别</h4><p>线程共享创建它的进程的地址空间;进程有自己的地址空间。</p>
<p>线程可以直接访问其进程的数据段;进程有自己的父进程数据段的副本。</p>
<p>线程可以直接与进程中的其他线程通信;进程必须使用进程间通信来与同级进程通信。</p>
<p>新线程很容易创建;新的进程需要父进程的复制。</p>
<p>线程可以对同一进程的线程进行相当大的控制;流程只能对子流程进行控制。</p>
<p>主线程的更改(取消、优先级更改等)可能会影响进程中其他线程的行为;对父进程的更改不会影响子进程。</p>
<h4 id="4-为何要用多线程"><a href="#4-为何要用多线程" class="headerlink" title="4)为何要用多线程"></a>4)为何要用多线程</h4><p>多线程指的是，在一个进程中开启多个线程，简单的讲：如果多个任务共用一块地址空间，那么必须在一个进程内开启多个线程。详细的讲分为4点：</p>
<ol>
<li>多线程共享一个进程的地址空间</li>
<li>线程比进程更轻量级，线程比进程更容易创建可撤销，在许多操作系统中，创建一个线程比创建一个进程要快10-100倍，在有大量线程需要动态和快速修改时，这一特性很有用</li>
<li>若多个线程都是cpu密集型的，那么并不能获得性能上的增强，但是如果存在大量的计算和大量的I/O处理，拥有多个线程允许这些活动彼此重叠运行，从而会加快程序执行的速度。</li>
<li>在多cpu系统中，为了最大限度的利用多核，可以开启多个线程，比开进程开销要小的多。（这一条并不适用于python）</li>
</ol>
<h4 id="5-多线程的应用举例"><a href="#5-多线程的应用举例" class="headerlink" title="5)多线程的应用举例"></a>5)多线程的应用举例</h4><p><img src="https://user-images.githubusercontent.com/57135669/88485366-d4820400-cfa7-11ea-8848-e70f2ef5cecd.png" alt="并4"></p>
<p>开启一个字处理软件进程，该进程肯定需要办不止一件事情，比如监听键盘输入，处理文字，定时自动将文字保存到硬盘，这三个任务操作的都是同一块数据，因而不能用多进程。只能在一个进程里并发地开启三个线程,如果是单线程，那就只能是，键盘输入时，不能处理文字和自动保存，自动保存时又不能输入和处理文字。</p>
<h4 id="6-经典的线程模型（了解）"><a href="#6-经典的线程模型（了解）" class="headerlink" title="6)经典的线程模型（了解）"></a>6)经典的线程模型（了解）</h4><p>多个线程共享同一个进程的地址空间中的资源，是对一台计算机上多个进程的模拟，有时也称线程为轻量级的进程</p>
<p>　　而对一台计算机上多个进程，则共享物理内存、磁盘、打印机等其他物理资源。</p>
<p>　　多线程的运行也多进程的运行类似，是cpu在多个线程之间的快速切换。</p>
<p><img src="https://user-images.githubusercontent.com/57135669/88485358-ce8c2300-cfa7-11ea-801a-35c60fefcc4e.png" alt="并5"></p>
<p>不同的进程之间是充满敌意的，彼此是抢占、竞争cpu的关系，如果迅雷会和QQ抢资源。而同一个进程是由一个程序员的程序创建，所以同一进程内的线程是合作关系，一个线程可以访问另外一个线程的内存地址，大家都是共享的，一个线程干死了另外一个线程的内存，那纯属程序员脑子有问题。</p>
<p>　　类似于进程，每个线程也有自己的堆栈</p>
<p><img src="https://user-images.githubusercontent.com/57135669/88485359-cf24b980-cfa7-11ea-9a64-1be5254ff1ee.png" alt="并6"></p>
<p>不同于进程，线程库无法利用时钟中断强制线程让出CPU，可以调用thread_yield运行线程自动放弃cpu，让另外一个线程运行。</p>
<p>　　</p>
<p>　　线程通常是有益的，但是带来了不小程序设计难度，线程的问题是：</p>
<p>　　1. 父进程有多个线程，那么开启的子线程是否需要同样多的线程</p>
<p>　　　如果是，那么附近中某个线程被阻塞，那么copy到子进程后，copy版的线程也要被阻塞吗，想一想nginx的多线程模式接收用户连接。</p>
<p>　　2. 在同一个进程中，如果一个线程关闭了问题，而另外一个线程正准备往该文件内写内容呢？</p>
<p>如果一个线程注意到没有内存了，并开始分配更多的内存，在工作一半时，发生线程切换，新的线程也发现内存不够用了，又开始分配更多的内存，这样内存就被分配了多次，这些问题都是多线程编程的典型问题，需要仔细思考和设计。</p>
<h4 id="7-POSIX线程（了解）"><a href="#7-POSIX线程（了解）" class="headerlink" title="7) POSIX线程（了解）"></a>7) POSIX线程（了解）</h4><p>为了实现可移植的线程程序,IEEE在IEEE标准1003.1c中定义了线程标准，它定义的线程包叫Pthread。大部分UNIX系统都支持该标准，简单介绍如下</p>
<p><img src="https://user-images.githubusercontent.com/57135669/88485360-cfbd5000-cfa7-11ea-8cfe-2739add1d085.png" alt="并7"></p>
<h4 id="8-在用户空间实现的线程（了解）"><a href="#8-在用户空间实现的线程（了解）" class="headerlink" title="8) 在用户空间实现的线程（了解）"></a>8) 在用户空间实现的线程（了解）</h4><p>线程的实现可以分为两类：用户级线程(User-Level Thread)和内核线线程(Kernel-Level Thread)，后者又称为内核支持的线程或轻量级进程。在多线程操作系统中，各个系统的实现方式并不相同，在有的系统中实现了用户级线程，有的系统中实现了内核级线程。</p>
<p>用户级线程内核的切换由用户态程序自己控制内核切换,不需要内核干涉，少了进出内核态的消耗，但不能很好的利用多核Cpu,目前Linux pthread大体是这么做的。</p>
<p><img src="https://user-images.githubusercontent.com/57135669/88485361-d0ee7d00-cfa7-11ea-877e-4418dc005bd1.png" alt="并8"></p>
<h4 id="9-在内核空间实现的线程（了解）"><a href="#9-在内核空间实现的线程（了解）" class="headerlink" title="9)在内核空间实现的线程（了解）"></a>9)在内核空间实现的线程（了解）</h4><p>内核级线程:切换由内核控制，当线程进行切换的时候，由用户态转化为内核态。切换完毕要从内核态返回用户态；可以很好的利用smp，即利用多核cpu。windows线程就是这样的。</p>
<p><img src="https://user-images.githubusercontent.com/57135669/88485362-d21faa00-cfa7-11ea-8b1f-31da80ec0e79.png" alt="并9"></p>
<h4 id="10-用户级与内核级线程的对比（了解）"><a href="#10-用户级与内核级线程的对比（了解）" class="headerlink" title="10)用户级与内核级线程的对比（了解）"></a>10)用户级与内核级线程的对比（了解）</h4><p><strong>一： 以下是用户级线程和内核级线程的区别：</strong></p>
<ol>
<li>内核支持线程是OS内核可感知的，而用户级线程是OS内核不可感知的。</li>
<li>用户级线程的创建、撤消和调度不需要OS内核的支持，是在语言（如Java）这一级处理的；而内核支持线程的创建、撤消和调度都需OS内核提供支持，而且与进程的创建、撤消和调度大体是相同的。</li>
<li>用户级线程执行系统调用指令时将导致其所属进程被中断，而内核支持线程执行系统调用指令时，只导致该线程被中断。</li>
<li>在只有用户级线程的系统内，CPU调度还是以进程为单位，处于运行状态的进程中的多个线程，由用户程序控制线程的轮换运行；在有内核支持线程的系统内，CPU调度则以线程为单位，由OS的线程调度程序负责线程的调度。</li>
<li>用户级线程的程序实体是运行在用户态下的程序，而内核支持线程的程序实体则是可以运行在任何状态下的程序。</li>
</ol>
<p><strong>二： 内核线程的优缺点</strong></p>
<p>　　<strong>优点：</strong></p>
<ol>
<li>当有多个处理机时，一个进程的多个线程可以同时执行。</li>
</ol>
<p>　　<strong>缺点：</strong></p>
<ol>
<li>由内核进行调度。</li>
</ol>
<p><strong>三： 用户进程的优缺点</strong></p>
<p>　　<strong>优点：</strong></p>
<ol>
<li>线程的调度不需要内核直接参与，控制简单。</li>
<li>可以在不支持线程的操作系统中实现。</li>
<li>创建和销毁线程、线程切换代价等线程管理的代价比内核线程少得多。</li>
<li>允许每个进程定制自己的调度算法，线程管理比较灵活。</li>
<li>线程能够利用的表空间和堆栈空间比内核级线程多。</li>
<li>同一进程中只能同时有一个线程在运行，如果有一个线程使用了系统调用而阻塞，那么整个进程都会被挂起。另外，页面失效也会产生同样的问题。</li>
</ol>
<p>　　<strong>缺点：</strong></p>
<ol>
<li>资源调度按照进程进行，多个处理机下，同一个进程中的线程只能在同一个处理机下分时复用</li>
</ol>
<h4 id="11-混合实现（了解）"><a href="#11-混合实现（了解）" class="headerlink" title="11) 混合实现（了解）"></a>11) 混合实现（了解）</h4><p>用户级与内核级的多路复用，内核同一调度内核线程，每个内核线程对应n个用户线程</p>
<p><img src="https://user-images.githubusercontent.com/57135669/88485363-d2b84080-cfa7-11ea-8dd5-33101161be6f.png" alt="并10"></p>
<h4 id="12-守护线程"><a href="#12-守护线程" class="headerlink" title="12)守护线程"></a>12)守护线程</h4><p>无论是进程还是线程，都遵循：守护xxx会等待主xxx运行完毕后被销毁</p>
<p>需要强调的是：运行完毕并非终止运行</p>
<h4 id="1-对主进程来说，运行完毕指的是主进程代码运行完毕"><a href="#1-对主进程来说，运行完毕指的是主进程代码运行完毕" class="headerlink" title="1.对主进程来说，运行完毕指的是主进程代码运行完毕"></a>1.对主进程来说，运行完毕指的是主进程代码运行完毕</h4><h4 id="2-对主线程来说，运行完毕指的是主线程所在的进程内所有非守护线程统统运行完毕，主线程才算运行完毕"><a href="#2-对主线程来说，运行完毕指的是主线程所在的进程内所有非守护线程统统运行完毕，主线程才算运行完毕" class="headerlink" title="2.对主线程来说，运行完毕指的是主线程所在的进程内所有非守护线程统统运行完毕，主线程才算运行完毕"></a>2.对主线程来说，运行完毕指的是主线程所在的进程内所有非守护线程统统运行完毕，主线程才算运行完毕</h4><p>详细解释：</p>
<h4 id="1-主进程在其代码结束后就已经算运行完毕了（守护进程在此时就被回收）-然后主进程会一直等非守护的子进程都运行完毕后回收子进程的资源-否则会产生僵尸进程-，才会结束，"><a href="#1-主进程在其代码结束后就已经算运行完毕了（守护进程在此时就被回收）-然后主进程会一直等非守护的子进程都运行完毕后回收子进程的资源-否则会产生僵尸进程-，才会结束，" class="headerlink" title="1 主进程在其代码结束后就已经算运行完毕了（守护进程在此时就被回收）,然后主进程会一直等非守护的子进程都运行完毕后回收子进程的资源(否则会产生僵尸进程)，才会结束，"></a>1 主进程在其代码结束后就已经算运行完毕了（守护进程在此时就被回收）,然后主进程会一直等非守护的子进程都运行完毕后回收子进程的资源(否则会产生僵尸进程)，才会结束，</h4><h4 id="2-主线程在其他非守护线程运行完毕后才算运行完毕（守护线程在此时就被回收）。因为主线程的结束意味着进程的结束，进程整体的资源都将被回收，而进程必须保证非守护线程都运行完毕后才能结束。"><a href="#2-主线程在其他非守护线程运行完毕后才算运行完毕（守护线程在此时就被回收）。因为主线程的结束意味着进程的结束，进程整体的资源都将被回收，而进程必须保证非守护线程都运行完毕后才能结束。" class="headerlink" title="2 主线程在其他非守护线程运行完毕后才算运行完毕（守护线程在此时就被回收）。因为主线程的结束意味着进程的结束，进程整体的资源都将被回收，而进程必须保证非守护线程都运行完毕后才能结束。"></a>2 主线程在其他非守护线程运行完毕后才算运行完毕（守护线程在此时就被回收）。因为主线程的结束意味着进程的结束，进程整体的资源都将被回收，而进程必须保证非守护线程都运行完毕后才能结束。</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sayhi</span><span class="params">(name)</span>:</span></span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line">    print(<span class="string">'%s say hello'</span> %name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    t=Thread(target=sayhi,args=(<span class="string">'egon'</span>,))</span><br><span class="line">    t.setDaemon(<span class="literal">True</span>) <span class="comment">#必须在t.start()之前设置</span></span><br><span class="line">    t.start()</span><br><span class="line"></span><br><span class="line">    print(<span class="string">'主线程'</span>)</span><br><span class="line">    print(t.is_alive())</span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    主线程</span></span><br><span class="line"><span class="string">    True</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">迷惑人的例子</span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="number">123</span>)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br><span class="line">    print(<span class="string">"end123"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bar</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="number">456</span>)</span><br><span class="line">    time.sleep(<span class="number">3</span>)</span><br><span class="line">    print(<span class="string">"end456"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">t1=Thread(target=foo)</span><br><span class="line">t2=Thread(target=bar)</span><br><span class="line"></span><br><span class="line">t1.daemon=<span class="literal">True</span></span><br><span class="line">t1.start()</span><br><span class="line">t2.start()</span><br><span class="line">print(<span class="string">"main-------"</span>)</span><br></pre></td></tr></table></figure>

<h4 id="13-线程池"><a href="#13-线程池" class="headerlink" title="13)线程池"></a>13)线程池</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor</span><br><span class="line"> <span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># pool只能创建100个线程</span></span><br><span class="line"> pool = ThreadPoolExecutor(<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">def</span> <span class="title">task</span><span class="params">(line)</span>:</span></span><br><span class="line">     print(line)</span><br><span class="line">     time.sleep(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">     <span class="keyword">for</span> line <span class="keyword">in</span> range(<span class="number">1000</span>):</span><br><span class="line">        pool.submit(task, line)</span><br></pre></td></tr></table></figure>

<h4 id="14-其他方法"><a href="#14-其他方法" class="headerlink" title="14)其他方法"></a>14)其他方法</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br></pre></td><td class="code"><pre><span class="line">一 开启线程的两种方式</span><br><span class="line"><span class="comment">#方式一</span></span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sayhi</span><span class="params">(name)</span>:</span></span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line">    print(<span class="string">'%s say hello'</span> %name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    t=Thread(target=sayhi,args=(<span class="string">'egon'</span>,))</span><br><span class="line">    t.start()</span><br><span class="line">    print(<span class="string">'主线程'</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment">#方式二</span></span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sayhi</span><span class="params">(Thread)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,name)</span>:</span></span><br><span class="line">        super().__init__()</span><br><span class="line">        self.name=name</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line">        print(<span class="string">'%s say hello'</span> % self.name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    t = Sayhi(<span class="string">'tony'</span>)</span><br><span class="line">    t.start()</span><br><span class="line">    print(<span class="string">'主线程'</span>)</span><br><span class="line"><span class="number">343434</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">二 在一个进程下开启多个线程与在一个进程下开启多个子进程的区别</span><br><span class="line">开启速度</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">work</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">'hello'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="comment">#在主进程下开启线程</span></span><br><span class="line">    t=Thread(target=work)</span><br><span class="line">    t.start()</span><br><span class="line">    print(<span class="string">'主线程/主进程'</span>)</span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    打印结果:</span></span><br><span class="line"><span class="string">    hello</span></span><br><span class="line"><span class="string">    主线程/主进程</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#在主进程下开启子进程</span></span><br><span class="line">    t=Process(target=work)</span><br><span class="line">    t.start()</span><br><span class="line">    print(<span class="string">'主线程/主进程'</span>)</span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    打印结果:</span></span><br><span class="line"><span class="string">    主线程/主进程</span></span><br><span class="line"><span class="string">    hello</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">进程编号</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">work</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">'hello'</span>,os.getpid())</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="comment">#part1:在主进程下开启多个线程,每个线程都跟主进程的pid一样</span></span><br><span class="line">    t1=Thread(target=work)</span><br><span class="line">    t2=Thread(target=work)</span><br><span class="line">    t1.start()</span><br><span class="line">    t2.start()</span><br><span class="line">    print(<span class="string">'主线程/主进程pid'</span>,os.getpid())</span><br><span class="line"></span><br><span class="line">    <span class="comment">#part2:开多个进程,每个进程都有不同的pid</span></span><br><span class="line">    p1=Process(target=work)</span><br><span class="line">    p2=Process(target=work)</span><br><span class="line">    p1.start()</span><br><span class="line">    p2.start()</span><br><span class="line">    print(<span class="string">'主线程/主进程pid'</span>,os.getpid())</span><br><span class="line">同一进程内的线程共享数据</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span>  threading <span class="keyword">import</span> Thread</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">work</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span> n</span><br><span class="line">    n=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="comment"># n=100</span></span><br><span class="line">    <span class="comment"># p=Process(target=work)</span></span><br><span class="line">    <span class="comment"># p.start()</span></span><br><span class="line">    <span class="comment"># p.join()</span></span><br><span class="line">    <span class="comment"># print('主',n) #毫无疑问子进程p已经将自己的全局的n改成了0,但改的仅仅是它自己的,查看父进程的n仍然为100</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    n=<span class="number">1</span></span><br><span class="line">    t=Thread(target=work)</span><br><span class="line">    t.start()</span><br><span class="line">    t.join()</span><br><span class="line">    print(<span class="string">'主'</span>,n) <span class="comment">#查看结果为0,因为同一进程内的线程之间共享进程内的数据</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">四 练习</span><br><span class="line"></span><br><span class="line">练习<span class="number">1</span></span><br><span class="line">多线程并发的socket服务端</span><br><span class="line"></span><br><span class="line"><span class="comment">#_*_coding:utf-8_*_</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">s.bind((<span class="string">'127.0.0.1'</span>,<span class="number">8080</span>))</span><br><span class="line">s.listen(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">action</span><span class="params">(conn)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        data=conn.recv(<span class="number">1024</span>)</span><br><span class="line">        print(data)</span><br><span class="line">        conn.send(data.upper())</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        conn,addr=s.accept()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        p=threading.Thread(target=action,args=(conn,))</span><br><span class="line">        p.start()</span><br><span class="line">客户端</span><br><span class="line"></span><br><span class="line"><span class="comment">#_*_coding:utf-8_*_</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">s.connect((<span class="string">'127.0.0.1'</span>,<span class="number">8080</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    msg=input(<span class="string">'&gt;&gt;: '</span>).strip()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> msg:<span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    s.send(msg.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">    data=s.recv(<span class="number">1024</span>)</span><br><span class="line">    print(data)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">练习<span class="number">2</span></span><br><span class="line">三个任务，一个接收用户输入，一个将用户输入的内容格式化成大写，一个将格式化后的结果存入文件</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line">msg_l=[]</span><br><span class="line">format_l=[]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">talk</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        msg=input(<span class="string">'&gt;&gt;: '</span>).strip()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> msg:<span class="keyword">continue</span></span><br><span class="line">        msg_l.append(msg)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">format_msg</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> msg_l:</span><br><span class="line">            res=msg_l.pop()</span><br><span class="line">            format_l.append(res.upper())</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">if</span> format_l:</span><br><span class="line">            <span class="keyword">with</span> open(<span class="string">'db.txt'</span>,<span class="string">'a'</span>,encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">                res=format_l.pop()</span><br><span class="line">                f.write(<span class="string">'%s\n'</span> %res)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    t1=Thread(target=talk)</span><br><span class="line">    t2=Thread(target=format_msg)</span><br><span class="line">    t3=Thread(target=save)</span><br><span class="line">    t1.start()</span><br><span class="line">    t2.start()</span><br><span class="line">    t3.start()</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">五 线程相关的其他方法</span><br><span class="line">Thread实例对象的方法</span><br><span class="line">  <span class="comment"># isAlive(): 返回线程是否活动的。</span></span><br><span class="line">  <span class="comment"># getName(): 返回线程名。</span></span><br><span class="line">  <span class="comment"># setName(): 设置线程名。</span></span><br><span class="line"></span><br><span class="line">threading模块提供的一些方法：</span><br><span class="line">  <span class="comment"># threading.currentThread(): 返回当前的线程变量。</span></span><br><span class="line">  <span class="comment"># threading.enumerate(): 返回一个包含正在运行的线程的list。正在运行指线程启动后、结束前，不包括启动前和终止后的线程。</span></span><br><span class="line">  <span class="comment"># threading.activeCount(): 返回正在运行的线程数量，与len(threading.enumerate())有相同的结果。</span></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">work</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">import</span> time</span><br><span class="line">    time.sleep(<span class="number">3</span>)</span><br><span class="line">    print(threading.current_thread().getName())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="comment">#在主进程下开启线程</span></span><br><span class="line">    t=Thread(target=work)</span><br><span class="line">    t.start()</span><br><span class="line"></span><br><span class="line">    print(threading.current_thread().getName())</span><br><span class="line">    print(threading.current_thread()) <span class="comment">#主线程</span></span><br><span class="line">    print(threading.enumerate()) <span class="comment">#连同主线程在内有两个运行的线程</span></span><br><span class="line">    print(threading.active_count())</span><br><span class="line">    print(<span class="string">'主线程/主进程'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    打印结果:</span></span><br><span class="line"><span class="string">    MainThread</span></span><br><span class="line"><span class="string">    &lt;_MainThread(MainThread, started 140735268892672)&gt;</span></span><br><span class="line"><span class="string">    [&lt;_MainThread(MainThread, started 140735268892672)&gt;, &lt;Thread(Thread-1, started 123145307557888)&gt;]</span></span><br><span class="line"><span class="string">    主线程/主进程</span></span><br><span class="line"><span class="string">    Thread-1</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">主线程等待子线程结束</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sayhi</span><span class="params">(name)</span>:</span></span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line">    print(<span class="string">'%s say hello'</span> %name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    t=Thread(target=sayhi,args=(<span class="string">'egon'</span>,))</span><br><span class="line">    t.start()</span><br><span class="line">    t.join()</span><br><span class="line">    print(<span class="string">'主线程'</span>)</span><br><span class="line">    print(t.is_alive())</span><br><span class="line">    <span class="string">'''</span></span><br><span class="line"><span class="string">    egon say hello</span></span><br><span class="line"><span class="string">    主线程</span></span><br><span class="line"><span class="string">    False</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">八 死锁现象与递归锁</span><br><span class="line">进程也有死锁与递归锁，在进程那里忘记说了，放到这里一切说了额</span><br><span class="line"></span><br><span class="line">所谓死锁： 是指两个或两个以上的进程或线程在执行过程中，因争夺资源而造成的一种互相等待的现象，若无外力作用，它们都将无法推进下去。此时称系统处于死锁状态或系统产生了死锁，这些永远在互相等待的进程称为死锁进程，如下就是死锁</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread,Lock</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">mutexA=Lock()</span><br><span class="line">mutexB=Lock()</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyThread</span><span class="params">(Thread)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.func1()</span><br><span class="line">        self.func2()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func1</span><span class="params">(self)</span>:</span></span><br><span class="line">        mutexA.acquire()</span><br><span class="line">        print(<span class="string">'\033[41m%s 拿到A锁\033[0m'</span> %self.name)</span><br><span class="line"></span><br><span class="line">        mutexB.acquire()</span><br><span class="line">        print(<span class="string">'\033[42m%s 拿到B锁\033[0m'</span> %self.name)</span><br><span class="line">        mutexB.release()</span><br><span class="line"></span><br><span class="line">        mutexA.release()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func2</span><span class="params">(self)</span>:</span></span><br><span class="line">        mutexB.acquire()</span><br><span class="line">        print(<span class="string">'\033[43m%s 拿到B锁\033[0m'</span> %self.name)</span><br><span class="line">        time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        mutexA.acquire()</span><br><span class="line">        print(<span class="string">'\033[44m%s 拿到A锁\033[0m'</span> %self.name)</span><br><span class="line">        mutexA.release()</span><br><span class="line"></span><br><span class="line">        mutexB.release()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">        t=MyThread()</span><br><span class="line">        t.start()</span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">Thread-1 拿到A锁</span></span><br><span class="line"><span class="string">Thread-1 拿到B锁</span></span><br><span class="line"><span class="string">Thread-1 拿到B锁</span></span><br><span class="line"><span class="string">Thread-2 拿到A锁</span></span><br><span class="line"><span class="string">然后就卡住，死锁了</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">解决方法，递归锁，在Python中为了支持在同一线程中多次请求同一资源，python提供了可重入锁RLock。</span><br><span class="line"></span><br><span class="line">这个RLock内部维护着一个Lock和一个counter变量，counter记录了acquire的次数，从而使得资源可以被多次require。直到一个线程所有的acquire都被release，其他的线程才能获得资源。上面的例子如果使用RLock代替Lock，则不会发生死锁：</span><br><span class="line"></span><br><span class="line">mutexA=mutexB=threading.RLock() <span class="comment">#一个线程拿到锁，counter加1,该线程内又碰到加锁的情况，则counter继续加1，这期间所有其他线程都只能等待，等待该线程释放所有锁，即counter递减到0为止</span></span><br><span class="line">九 信号量Semaphore</span><br><span class="line">同进程的一样</span><br><span class="line"></span><br><span class="line">Semaphore管理一个内置的计数器，</span><br><span class="line">每当调用acquire()时内置计数器<span class="number">-1</span>；</span><br><span class="line">调用release() 时内置计数器+<span class="number">1</span>；</span><br><span class="line">计数器不能小于<span class="number">0</span>；当计数器为<span class="number">0</span>时，acquire()将阻塞线程直到其他线程调用release()。</span><br><span class="line"></span><br><span class="line">实例：(同时只有<span class="number">5</span>个线程可以获得semaphore,即可以限制最大连接数为<span class="number">5</span>)：</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread,Semaphore</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="comment"># def func():</span></span><br><span class="line"><span class="comment">#     if sm.acquire():</span></span><br><span class="line"><span class="comment">#         print (threading.currentThread().getName() + ' get semaphore')</span></span><br><span class="line"><span class="comment">#         time.sleep(2)</span></span><br><span class="line"><span class="comment">#         sm.release()</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">()</span>:</span></span><br><span class="line">    sm.acquire()</span><br><span class="line">    print(<span class="string">'%s get sm'</span> %threading.current_thread().getName())</span><br><span class="line">    time.sleep(<span class="number">3</span>)</span><br><span class="line">    sm.release()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    sm=Semaphore(<span class="number">5</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">23</span>):</span><br><span class="line">        t=Thread(target=func)</span><br><span class="line">        t.start()</span><br><span class="line">与进程池是完全不同的概念，进程池Pool(<span class="number">4</span>)，最大只能产生<span class="number">4</span>个进程，而且从头到尾都只是这四个进程，不会产生新的，而信号量是产生一堆线程/进程</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">十 Event</span><br><span class="line">同进程的一样</span><br><span class="line"></span><br><span class="line">线程的一个关键特性是每个线程都是独立运行且状态不可预测。如果程序中的其 他线程需要通过判断某个线程的状态来确定自己下一步的操作,这时线程同步问题就会变得非常棘手。为了解决这些问题,我们需要使用threading库中的Event对象。 对象包含一个可由线程设置的信号标志,它允许线程等待某些事件的发生。在 初始情况下,Event对象中的信号标志被设置为假。如果有线程等待一个Event对象, 而这个Event对象的标志为假,那么这个线程将会被一直阻塞直至该标志为真。一个线程如果将一个Event对象的信号标志设置为真,它将唤醒所有等待这个Event对象的线程。如果一个线程等待一个已经被设置为真的Event对象,那么它将忽略这个事件, 继续执行</span><br><span class="line"></span><br><span class="line">event.isSet()：返回event的状态值；</span><br><span class="line">event.wait()：如果 event.isSet()==<span class="literal">False</span>将阻塞线程；</span><br><span class="line">event.set()： 设置event的状态值为<span class="literal">True</span>，所有阻塞池的线程激活进入就绪状态， 等待操作系统调度；</span><br><span class="line">event.clear()：恢复event的状态值为<span class="literal">False</span>。</span><br><span class="line"><span class="number">55555</span></span><br><span class="line"></span><br><span class="line">例如，有多个工作线程尝试链接MySQL，我们想要在链接前确保MySQL服务正常才让那些工作线程去连接MySQL服务器，如果连接不成功，都会去尝试重新连接。那么我们就可以采用threading.Event机制来协调各个工作线程的连接操作</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Thread,Event</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> time,random</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">conn_mysql</span><span class="params">()</span>:</span></span><br><span class="line">    count=<span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> event.is_set():</span><br><span class="line">        <span class="keyword">if</span> count &gt; <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">raise</span> TimeoutError(<span class="string">'链接超时'</span>)</span><br><span class="line">        print(<span class="string">'&lt;%s&gt;第%s次尝试链接'</span> % (threading.current_thread().getName(), count))</span><br><span class="line">        event.wait(<span class="number">0.5</span>)</span><br><span class="line">        count+=<span class="number">1</span></span><br><span class="line">    print(<span class="string">'&lt;%s&gt;链接成功'</span> %threading.current_thread().getName())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_mysql</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">'\033[45m[%s]正在检查mysql\033[0m'</span> % threading.current_thread().getName())</span><br><span class="line">    time.sleep(random.randint(<span class="number">2</span>,<span class="number">4</span>))</span><br><span class="line">    event.set()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    event=Event()</span><br><span class="line">    conn1=Thread(target=conn_mysql)</span><br><span class="line">    conn2=Thread(target=conn_mysql)</span><br><span class="line">    check=Thread(target=check_mysql)</span><br><span class="line"></span><br><span class="line">    conn1.start()</span><br><span class="line">    conn2.start()</span><br><span class="line">    check.start()</span><br><span class="line">获得cpu数量</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">print(os.cpu_count())</span><br></pre></td></tr></table></figure>

<h4 id="15）GIL-globl-interpreter-lock-全局解释锁"><a href="#15）GIL-globl-interpreter-lock-全局解释锁" class="headerlink" title="15）GIL(globl interpreter lock)全局解释锁"></a>15）GIL(globl interpreter lock)全局解释锁</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">定义：</span></span><br><span class="line"><span class="string">In CPython, the global interpreter lock, or GIL, is a mutex that prevents multiple </span></span><br><span class="line"><span class="string">native threads from executing Python bytecodes at once. This lock is necessary mainly </span></span><br><span class="line"><span class="string">because CPython’s memory management is not thread-safe. (However, since the GIL </span></span><br><span class="line"><span class="string">exists, other features have grown to depend on the guarantees that it enforces.)</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">结论：在Cpython解释器中，同一个进程下开启的多线程，同一时刻只能有一个线程执行，无法利用多核优势</span><br></pre></td></tr></table></figure>

<p><img src="https://user-images.githubusercontent.com/57135669/88485364-d350d700-cfa7-11ea-88b1-49c4cc3cf756.png" alt="并11"></p>
<p><strong>注意：GIL并不是Python的特性，它是在实现Python解析器(CPython)时所引入的一个概念， Python完全可以不依赖于GIL</strong></p>
<p><strong>什么是GIL?</strong></p>
<p>GIL本质就是一个互斥锁，相当于执行权限，每个进程内都会存在一把CIL,同一个进程内多个线程必须抢到GIL之后才能使用Cpytho解释器来执行自己的代码，即同一个进程内的多个线程只能使用并发，无法使用并行</p>
<p><strong>为什么要使用GIL?</strong></p>
<p>因为cpython中的垃圾回收机制不是线程安全的，就是为了数据安全才设置的GIL</p>
<p>GIL全局解释器锁的优缺点:</p>
<p>优点: 保证数据的安全</p>
<p>缺点: 单个进程下，开启多个线程，牺牲执行效率，无法实现并行，只能实现并发。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">IO密集型下使用多线程.</span><br><span class="line">计算密集型下使用多进程.</span><br><span class="line"></span><br><span class="line">IO密集型任务，每个任务<span class="number">4</span>s</span><br><span class="line">    - 单核:</span><br><span class="line">        - 开启线程比进程节省资源。</span><br><span class="line">        </span><br><span class="line">    - 多核:</span><br><span class="line">        - 多线程: </span><br><span class="line">            - 开启<span class="number">4</span>个子线程: <span class="number">16</span>s </span><br><span class="line">            </span><br><span class="line">        - 多进程:</span><br><span class="line">            - 开启<span class="number">4</span>个进程: <span class="number">16</span>s + 申请开启资源消耗的时间</span><br><span class="line">        </span><br><span class="line">    </span><br><span class="line">计算密集型任务，每个任务<span class="number">4</span>s</span><br><span class="line">    - 单核:</span><br><span class="line">        - 开启线程比进程节省资源。</span><br><span class="line">        </span><br><span class="line">    - 多核:</span><br><span class="line">        - 多线程:</span><br><span class="line">            - 开启<span class="number">4</span>个子线程: <span class="number">16</span>s</span><br><span class="line">            </span><br><span class="line">        - 多进程:</span><br><span class="line">            - 开启多个进程: <span class="number">4</span>s</span><br></pre></td></tr></table></figure>

<h4 id="16-协程"><a href="#16-协程" class="headerlink" title="16)协程"></a>16)协程</h4><p><strong>协程:单线程实现并发</strong></p>
<p>注意:协程是程序员想出来的，操作系统里面只有进程和线程的概念，操作系统调度的是线程</p>
<p>在单线程下实现多个任务遇到IO就切换就可以降低单线程的IO时间，从而最大限度的提升单线程的效率（若不是遇到io，比如遇到计算就切反而会降低效率）</p>
<p>注意：yield并不能解决遇到io就切换的操作</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gevent <span class="keyword">import</span> monkey  <span class="comment"># 猴子补丁</span></span><br><span class="line"></span><br><span class="line">monkey.patch_all()</span><br><span class="line"><span class="keyword">from</span> gevent <span class="keyword">import</span> spawn</span><br><span class="line"><span class="keyword">from</span> gevent <span class="keyword">import</span> joinall</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="comment"># 注意，gevent模块不能识别他本身以外的IO类型,本身time模块已经封装一份在gevent内，可</span></span><br><span class="line"><span class="comment"># 以调用gevent内部的sleep，如果需要其他类型的IO，则需要打一个猴子补丁</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">play</span><span class="params">(name)</span>:</span></span><br><span class="line">    print(<span class="string">"%s paly 1 "</span>%name)</span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">"%s paly 2 "</span>%name)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">eat</span><span class="params">(name)</span>:</span></span><br><span class="line">    print(<span class="string">"%s eat 1"</span>%name)</span><br><span class="line">    time.sleep(<span class="number">5</span>)</span><br><span class="line">    print(<span class="string">"%s eat 2"</span>%name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">time_start = time.time()</span><br><span class="line">g1 = spawn(play, <span class="string">'tank'</span>)</span><br><span class="line">g2 = spawn(play, <span class="string">'sean'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># g1.join()</span></span><br><span class="line"><span class="comment"># g2.join()</span></span><br><span class="line">joinall([g1, g2]) <span class="comment"># 取代join</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'主进程'</span>, time.time()-time_start)</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/11/29/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/" data-id="ckd3cw4ii000xrcut0l9y745q" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E5%92%8C%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" rel="tag">网络和并发编程</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-网络编程基础" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/25/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/" class="article-date">
  <time datetime="2018-11-25T12:09:29.000Z" itemprop="datePublished">2018-11-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/25/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/">网络编程基础</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="网络编程"><a href="#网络编程" class="headerlink" title="网络编程:"></a>网络编程:</h1><h2 id="1-软件开发架构"><a href="#1-软件开发架构" class="headerlink" title="1.软件开发架构"></a>1.软件开发架构</h2><ul>
<li><p><strong>C/S架构:(应用类</strong>)</p>
<p> Client: 客户端</p>
<p> Server: 服务端</p>
<p> 比如: 微信客户端、QQ客户端等…</p>
<ul>
<li><p>优点:软件使用稳点,节省网络资源</p>
</li>
<li><p>缺点:安装麻烦,需要占用手机或计算机内存资源,每次跟新都需要下载更新版本</p>
</li>
</ul>
</li>
</ul>
<p><img src="https://user-images.githubusercontent.com/57135669/88485172-85879f00-cfa6-11ea-9cf6-dd3888c443bb.png" alt="网编1"></p>
<ul>
<li><p><strong>B/S架构:(web类)</strong></p>
<p> Browser(本质上也是一个客户端): 浏览器 S</p>
<p> erver: 服务端</p>
<p> 比如: 在浏览器上输入一个 网址 就可以访问服务器</p>
<ul>
<li>优点:软件的使用方便,不需要下载和更新</li>
<li>缺点:极度依赖网络环境</li>
</ul>
</li>
</ul>
<p><img src="https://user-images.githubusercontent.com/57135669/88485175-87e9f900-cfa6-11ea-870e-83cf1414ec18.png" alt="网编2"></p>
<p>客户端与服务端都需要唯一的地址，但是客户端不需要固定地址，而服务端需要固定地址，并且保证一直稳定运行提供服务，并且支持并发</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 世界五大浏览器</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">一.IE浏览器： </span></span><br><span class="line"><span class="string">IE是微软公司旗下浏览器，是目国内用户量最多的浏览器。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">二.Opera浏览器（欧朋浏览器）： </span></span><br><span class="line"><span class="string">Opera是挪威Opera Software ASA公司旗下的浏览器,使用自己研发的Presto内核。2016年奇虎360和昆仑万维收购了Oprea浏览器，改用当时Google开源的webkit内核</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">三.Safari浏览器</span></span><br><span class="line"><span class="string">2003年，苹果公司在苹果手机上开发Safari浏览器，利用自己得天独厚的手机市场份额使Safari浏览器迅速成为世界主流浏览器。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">四.Firefox浏览器：</span></span><br><span class="line"><span class="string">采用Gecko作为内核。Gecko是一个开源的项目，代码完全公开，因此受到很多人的青睐。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">五.Chrome浏览器： </span></span><br><span class="line"><span class="string">Chrome浏览器是google旗下的浏览器,最开始Chrome采用webkit作为浏览器内核，直到2013年，google宣布不再使用苹果的webkit内核，开始使用webkit的分支内核Blink。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 四大浏览器内核</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">四大内核分别是：</span></span><br><span class="line"><span class="string">Trident（也称IE内核,IE浏览器内核）、</span></span><br><span class="line"><span class="string">webkit(Safari浏览器内核)、</span></span><br><span class="line"><span class="string">Blink(Chrome浏览器内核,Opera浏览器内核)、</span></span><br><span class="line"><span class="string">Gecko(Firefox浏览器内核)。</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">不同的浏览器由于内核不同会在前端开发时遇到兼容问题</span><br></pre></td></tr></table></figure>

<h2 id="2-互联网协议"><a href="#2-互联网协议" class="headerlink" title="2.互联网协议"></a>2.互联网协议</h2><ul>
<li>如何实现计算机与计算机之间进行无障碍通信<ul>
<li>物理链接介质(电话线,网线,网卡等)</li>
<li>互联网协议(一套所有计算机都遵循的标准)</li>
</ul>
</li>
</ul>
<p>补充:</p>
<p>以太网: 以太网是目前应用最普遍的局域网技术</p>
<p> 第一类是经典以太网，第二类是交换式以太网，使用了一种称为<a href="https://baike.baidu.com/item/交换机/103532" target="_blank" rel="noopener">交换机</a>的设备连接不同的计算机</p>
<p>交换机:所有链接了同一个交换机的电脑彼此都是互联的</p>
<p>了解:</p>
<p>三层交换机:即具有交换机又具有路由器功能</p>
<p>四层交换机:能够根据你走的什么协议找到对应的应用</p>
<p>互联网协议按照功能不同可以分为osi （开放系统互联(Open System Interconnection)） 七层或tcp/ip五层或tcp/ip四层</p>
<p><img src="https://user-images.githubusercontent.com/57135669/88485177-89b3bc80-cfa6-11ea-96f6-a3f0e2938b4c.png" alt="网编3"></p>
<h3 id="物理层"><a href="#物理层" class="headerlink" title="物理层:"></a>物理层:</h3><p>物理链接介质,接收和传递电信号(高低电平),即一堆二进制字符0111010101010</p>
<p>物理层无法获取具体数据内容以及分解字符串,故将电信号传给数据链路层</p>
<h3 id="数据链路层-遵循ARP协议"><a href="#数据链路层-遵循ARP协议" class="headerlink" title="数据链路层(遵循ARP协议)"></a>数据链路层(遵循ARP协议)</h3><p>地址解析协议，即ARP（Address Resolution Protocol），是根据IP地址获取物理地址的一个TCP/IP协议。</p>
<p>拿到物理层电信号后:</p>
<p> 我要知道数据是什么？</p>
<p> 我要知道数据是给谁的？</p>
<p>“以太网协议”:</p>
<p>将一组电信号称为一组数据报或者数据帧</p>
<p>1)规定一套分组的方式:</p>
<p> 获取电信号真实数据。</p>
<p> 电信号是一个数据报。</p>
<p> 报头(head): 18个字节,发送者（源地址）, 6个: 接收者（目标地址）,6个: 数据类型6个</p>
<p> 数据(data):电信号具体的数据（最短45个字节，最长1500字节）</p>
<ol>
<li>规定每一台电脑必须要有一个网卡（电脑插入网线的地方）:</li>
</ol>
<ul>
<li>每一块网卡都会有一串世界上独一无二的数字: - 12位16进制的数字，称之为 “mac地址” : - 前6位: 产商号 - 后6位: 流水号</li>
<li>mac地址作用（<strong>***</strong>）: 标识全世界上一台独一无二的计算机。</li>
</ul>
<p>3)工作的方式:</p>
<p>单播:</p>
<p>广播:</p>
<p>缺点:</p>
<p>广播风暴:只能在局域网内实现通信, 无法跨局域实现通信</p>
<h3 id="网络层"><a href="#网络层" class="headerlink" title="网络层"></a>网络层</h3><p>规定计算机都必须有一个ip地址,ip协议可以跨局域网传输</p>
<ul>
<li><p>ip地址（ip协议):点分十进制的数字组成 180.101.49.11</p>
<p>最小范围: 0.0.0.0 -</p>
<p>最大范围: 255.255.255.255</p>
</li>
<li><p>ip的版本:</p>
<ul>
<li>IPV4:</li>
<li>IPV6:</li>
</ul>
<p>ip的作用:</p>
<p>用于表示全世界某一台计算机的位置在局域网的位置。</p>
<p>总结: ip地址 + mac地址: 标识全世界某一个局域网内的，某一台计算机。</p>
</li>
</ul>
<h3 id="传输层"><a href="#传输层" class="headerlink" title="传输层:"></a>传输层:</h3><p>tcp与udp都是基于 “端口” 实现通信的。</p>
<ul>
<li>TCP协议 (Transmission Control Protocol) : 传输控制协议,提供的是面向连接、可靠的字节流服务。当客户和服务器彼此交换数据前，必须先在双方之间建立一个TCP连接，之后才能传输数据。TCP提供超时重发，丢弃重复数据，检验数据，流量控制等功能，保证数据能从一端传到另一端。</li>
<li>UDP协议 (User Datagram Protocol) : 用户数据报协议，是一个简单的面向数据报的运输层协议。UDP不提供可靠性，它只是把应用程序传给IP层的数据报发送出去，但是并不能保证它们能到达目的地。由于UDP在传输数据报前不用在客户和服务器之间建立一个连接，且没有超时重发等机制，故而传输速度很快</li>
</ul>
<p>主要是软件与软件之间进行通信。</p>
<ul>
<li><strong>port端口:</strong> 0～65535用来标识一台计算机之上<strong>基于网络通信</strong>的应用软件，0～1024操作系统自己用的，一般情况下8000之后的端口我们可以任意使用，8000之前的通常会有相应的程序默认使用 用于标识计算机中某一个独一无二软件。</li>
</ul>
<h4 id="三次握手和四次挥手"><a href="#三次握手和四次挥手" class="headerlink" title="三次握手和四次挥手"></a>三次握手和四次挥手</h4><p><strong>三次握手</strong></p>
<p>建立双向通道的过程称之为三次握手,建立通道的发起者可以是客户端也可以是服务端，下面我们就以客户端先主动发起为例</p>
<ul>
<li><p>客户端会朝服务端发送一个请求询问服务端:”我能不能挖一条通往你家的地道”</p>
</li>
<li><p>服务端收到请求，回复说:”好吧 你挖吧”，由于TCP是双向通道，客户端挖向服务端的通道只能给客户端朝服务端发消息使用，服务端要向给客户端发消息是没办法走这一条通道的，需要自己挖一条通往客户端的通道</p>
<p>所以服务端在回复同意客户端挖通道的同时还会问一句:”那我能不能也挖一条通往你家的通道”</p>
</li>
<li><p>客户端收到服务端请求后客户端到服务端的通道就挖成功了，然后也会同意服务端的请求，服务端挖向客户端的通道也会成功</p>
</li>
</ul>
<p>总结:之所以称之为三次握手就是因为中间的服务端的同意，和请求合并成了一次请求</p>
<p><strong>四次挥手</strong></p>
<p>建立一个连接需要三次握手，而终止一个连接要经过四次握手</p>
<p>当服务端或者客户端不想再与对方进行通信之后，双方任意一方都可以主动发起断开链接的请求，我们还是以客户端主动发起为例</p>
<ul>
<li><p>客户端由于已经没有任何需要发送给服务端的消息了，所以发起断开客户端到服务端的通道请求</p>
</li>
<li><p>服务端收到该请求后同意了 至此客户端到服务端的单项通道断开</p>
</li>
<li><p>服务端这个时候不会立刻朝客户端发器请求说那我也断开到你家的通道吧，服务端需要想想我手上还有没有需要发送给客户端的消息，如果还有的话，那我不能立马断开，先把数据发完才能断</p>
<p>等服务端检查完毕之后发送也没有数据要给客户端了，这个时候就会朝客户端发起断开服务端到客户端的通道请求</p>
</li>
<li><p>客户端同意该请求，至此四次挥手完成</p>
</li>
</ul>
<p>总结:挥手必须是四次，中间的两次不能合并成一次，原因就在于需要检查是否还有数据需要给对方发送</p>
<ul>
<li><p>反馈机制: 客户端往服务端发送请求,服务端必须返回响应,告诉客户端收到请求了，并且将服务端的数据一并返回给客户端。</p>
<p>C–&gt;S: 一次请求，必须有一次响应。</p>
<p>缺点:</p>
<p>洪水攻击: 指的是通过伪造大量的请求，往对方服务器发送请求,导致对方服务器响应跟不上，以至于瘫痪。linux系统有个参数可以限制。</p>
<p>半连接池listen: 限制用户在同一个时间段内的访问数量。</p>
</li>
</ul>
<p>总结： mac地址 + ip地址 + port端口: 标识的是全世界范围内某一个局域网内某一台计算机上的某一个软件。</p>
<h3 id="应用层"><a href="#应用层" class="headerlink" title="应用层:"></a>应用层:</h3><ul>
<li>http协议</li>
<li>ftp协议</li>
</ul>
<h2 id="3-socket套接字通信"><a href="#3-socket套接字通信" class="headerlink" title="3.socket套接字通信"></a>3.socket套接字通信</h2><p><img src="https://user-images.githubusercontent.com/57135669/88485182-90423400-cfa6-11ea-8cb7-5d5d18670b90.png" alt="网编4"></p>
<ul>
<li><p>什么是socket？</p>
<p>socket是一个模块, 又称套接字，用来封装 互联网协议(应用层以下的层)。</p>
</li>
<li><p>为什么要有socket？</p>
<p>socket可以实现 互联网协议应用层以下的层的工作。提高开发效率</p>
</li>
<li><p>怎么使用socket？</p>
<p>import socket</p>
<p>写socket套接字:</p>
<p>Client (客户端)/Server(服务端)</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">客户端</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取套接字</span></span><br><span class="line">client = socket.socket()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 尝试与服务端建立链接</span></span><br><span class="line">client.connect(</span><br><span class="line">   (<span class="string">'127.0.0.1'</span>, <span class="number">8472</span>)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">   <span class="comment"># 输入向服务端发送的信息</span></span><br><span class="line">   send_data = input(<span class="string">'客户端&gt;&gt;&gt;: '</span>)</span><br><span class="line"></span><br><span class="line">   <span class="comment"># 将信息编码</span></span><br><span class="line">   client.send(send_data.encode(<span class="string">'utf-8'</span>))</span><br><span class="line">   <span class="comment"># 接收服务端端的数据,1024表示接收数据长度,可修改</span></span><br><span class="line">   data = client.recv(<span class="number">1024</span>)</span><br><span class="line">   <span class="comment"># 判断是否服务端申请关闭通道</span></span><br><span class="line">   <span class="keyword">if</span> data.decode(<span class="string">'utf-8'</span>) == <span class="string">'q'</span>:</span><br><span class="line">       <span class="keyword">break</span></span><br><span class="line">   <span class="keyword">if</span> len(data) == <span class="number">0</span>:</span><br><span class="line">       <span class="keyword">break</span></span><br><span class="line">   <span class="comment"># 打印数据信息</span></span><br><span class="line">   print(data.decode(<span class="string">'utf-8'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭通道</span></span><br><span class="line">client.close()</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">服务端优先启动</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取套接字(类似于买了一个手机)</span></span><br><span class="line">server = socket.socket()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绑定ip和端口地址(类似于手机绑定手机卡)</span></span><br><span class="line">server.bind(</span><br><span class="line">    (<span class="string">'127.0.0.1'</span>, <span class="number">8472</span>)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 半连接池(监听链接)</span></span><br><span class="line">server.listen(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment"># 接收客户端链接信息</span></span><br><span class="line">    conn, addr = server.accept()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:  <span class="comment"># 监听代码块是否有异常出现</span></span><br><span class="line">            <span class="comment"># 获取客服端数据</span></span><br><span class="line">            data = conn.recv(<span class="number">1024</span>) <span class="comment"># 设置接收数据长度</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 判断是否接收数据0</span></span><br><span class="line">            <span class="keyword">if</span> len(data) == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="comment"># 判断客户端是否申请断绝联系</span></span><br><span class="line">            <span class="keyword">if</span> data.decode(<span class="string">'utf-8'</span>) == <span class="string">'q'</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            print(data.decode(<span class="string">'utf-8'</span>))</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 向客服端发送信息</span></span><br><span class="line">            send_data = input(<span class="string">'服务端&gt;&gt;&gt;: '</span>)</span><br><span class="line">            conn.send(send_data.encode(<span class="string">'utf-8'</span>))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 将异常收集返回出来</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            print(e)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 关闭通道</span></span><br><span class="line">    conn.close()</span><br></pre></td></tr></table></figure>

<h3 id="粘包问题"><a href="#粘包问题" class="headerlink" title="粘包问题"></a>粘包问题</h3><ul>
<li><ol>
<li>问题: 无法确认对方发送过来数据的大小。</li>
</ol>
</li>
<li><ol>
<li>问题: 在发送数据间隔短并且数据量小的情况下，会将所有数据一次性发送。</li>
</ol>
</li>
</ul>
<p>解决: 确认对方数据的大小。</p>
<h3 id="解决粘包问题（struct模块）"><a href="#解决粘包问题（struct模块）" class="headerlink" title="解决粘包问题（struct模块）"></a>解决粘包问题（struct模块）</h3><p>无论哪一端先发送数据</p>
<p>客户端 :</p>
<p>1.先制作报头，并发送 （struct）</p>
<p>2.发送真实数据</p>
<p>服务端:</p>
<p>1接收报头，并解包获取真实数据长度</p>
<p>2.根据真实数据长度 接收真实数据 ,recv(真实数据长度)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>struct模块</span><br><span class="line">是一个python内置的模块, 它可以将固定长度的数据，打包成固定格式的长度。</span><br><span class="line">模式i: <span class="number">4</span></span><br><span class="line"><span class="number">2.</span>作用:</span><br><span class="line">可以将真实数据，做成一个固定长度多的报头，客户端发送给服务端，服务端可以接收报头，</span><br><span class="line">然后对报头进行解包，获取真实数据的长度，进行接收即可</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">data =<span class="string">b'snjab'</span></span><br><span class="line"></span><br><span class="line">print(data)</span><br><span class="line"></span><br><span class="line">print(len(data))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打包制作报头</span></span><br><span class="line"></span><br><span class="line">header = struct.pack(<span class="string">'i'</span>, len(data))</span><br><span class="line"></span><br><span class="line">print(header)</span><br><span class="line"></span><br><span class="line">res = struct.unpack(<span class="string">'i'</span>, header)[<span class="number">0</span>]</span><br><span class="line">print(res)</span><br><span class="line"><span class="comment">#客户端</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">client = socket.socket()</span><br><span class="line"></span><br><span class="line">client.connect(</span><br><span class="line">    (<span class="string">'127.0.0.1'</span>, <span class="number">8978</span>)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    movie_name = input(<span class="string">'请上传电影名称: '</span>)</span><br><span class="line">    <span class="comment"># 伪装一个电影长度</span></span><br><span class="line">    movie_len = <span class="number">10000</span></span><br><span class="line"></span><br><span class="line">    send_dic = &#123;<span class="string">'movie_name'</span>: movie_name,</span><br><span class="line">                <span class="string">"movie_len"</span>: movie_len&#125;</span><br><span class="line">    <span class="comment"># 改成json模式</span></span><br><span class="line">    json = json.dumps(send_dic)</span><br><span class="line">    <span class="comment"># print(json)</span></span><br><span class="line">    <span class="comment"># print(json.encode('utf-8'))</span></span><br><span class="line">    <span class="comment"># print(len(json.encode('utf-8')))</span></span><br><span class="line">    json_bytes = json.encode(<span class="string">'utf-8'</span>)</span><br><span class="line"></span><br><span class="line">    header = struct.pack(<span class="string">'i'</span>, json_bytes)</span><br><span class="line">    client.send(header)</span><br><span class="line">    client.send(json_bytes)</span><br><span class="line"><span class="comment"># 服务端</span></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">server = socket.socket()</span><br><span class="line"></span><br><span class="line">server.bind(</span><br><span class="line">    (<span class="string">'127.0.0.1'</span>, <span class="number">8978</span>)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">server.listen(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    conn, addr = server.accept()</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            header = conn.recv(<span class="number">4</span>)  <span class="comment"># 获取报头</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 解开报头</span></span><br><span class="line">            json_len = struct.unpack(<span class="string">'i'</span>, header)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 接收真正长度</span></span><br><span class="line"></span><br><span class="line">            json_bytes_date = conn.recv(json_len)</span><br><span class="line"></span><br><span class="line">            json_data = json_bytes_date.decode(<span class="string">'utf-8'</span>)</span><br><span class="line"></span><br><span class="line">            back_dic = json.loads(json_data)</span><br><span class="line">            print(back_dic)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            print(e)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    conn.close()</span><br></pre></td></tr></table></figure>

<p>.UDP协议 （了解）</p>
<p>称之为数据包协议,不可靠协议</p>
<p>特点:</p>
<ul>
<li>不需要建立链接。</li>
<li>不需要知道对方是否收到。</li>
<li>数据不安全</li>
<li>传输速度快</li>
<li>能支持并发</li>
<li>不会粘包</li>
<li>无需先启动服务端再启动客户端</li>
</ul>
<p>优点:</p>
<ul>
<li>传输速度快</li>
<li>能支持并发</li>
<li>不会粘包</li>
</ul>
<p>缺点:</p>
<ul>
<li>数据不安全, 容易丢失</li>
</ul>
<p>应用场景: 早期的QQ聊天室。</p>
<p>2.TCP协议(称为流式协议):</p>
<p>优点:</p>
<ul>
<li>数据安全 缺点:</li>
<li>传输速度慢</li>
<li>粘包</li>
</ul>
<p>面试: TCP与UDP的区别, 简述优缺点即可。（<strong>***</strong>）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">server,不需要优先启动服务端</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="comment"># socket.SOCK_DGRAM ------&gt;UPD协议</span></span><br><span class="line">server = socket.socket(type=socket.SOCK_DGRAM)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 服务端需要绑定一个地址,让别人知道服务端在哪</span></span><br><span class="line">server.bind(</span><br><span class="line">    (<span class="string">'127.0.0.1'</span>, <span class="number">8594</span>)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 接收数据给服务端的用户地址</span></span><br><span class="line">    date, addr = server.recvfrom(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">    print(addr)</span><br><span class="line">    print(date.decode(<span class="string">'utf-8'</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 无论服务端还是客户端，发送消息时，都必须知道对方是谁</span></span><br><span class="line">    <span class="comment"># server.sendto(msg, addr)</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">客户端</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">client = socket.socket(type=socket.SOCK_DGRAM)</span><br><span class="line"></span><br><span class="line">address = (<span class="string">'127.0.0.1'</span>, <span class="number">8594</span>)</span><br><span class="line">print(address)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    msg = input(<span class="string">'客户端输入信息: '</span>).encode(<span class="string">'utf-8'</span>)</span><br><span class="line">    client.sendto(msg, address)</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/11/25/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/" data-id="ckd3cw4it0019rcut1lagfcuc" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E5%92%8C%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" rel="tag">网络和并发编程</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-MySQL数据库的隔离级别和锁" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/24/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E5%92%8C%E9%94%81/" class="article-date">
  <time datetime="2018-11-24T12:53:03.000Z" itemprop="datePublished">2018-11-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/24/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E5%92%8C%E9%94%81/">MySQL数据库的隔离级别和锁</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="事务是有隔离级别"><a href="#事务是有隔离级别" class="headerlink" title="事务是有隔离级别"></a>事务是有隔离级别</h3><p>read uncommited (读未提交)：不做任何隔离，具有脏读，不可重读，幻读的问题</p>
<p>read committed （读提交）：可以防止脏读，不能防止不可重复读和幻读的问题</p>
<p>repeated read（可重复读）：可以防止脏读，不可重复读，不能防止幻读（mysql的默认隔离级别）</p>
<p>serializable（串行化）：数据库运行为串行，以上问题都可以防止，但是性能低，相当于将整个库都加锁了</p>
<p><strong>下面的解释都用这个user表</strong></p>
<table>
<thead>
<tr>
<th align="left">name</th>
<th align="left">age</th>
</tr>
</thead>
<tbody><tr>
<td align="left">jason</td>
<td align="left">38</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody></table>
<h3 id="脏读（a-b同时开始事务，a-b再事务，没有哪一个结束，只有两个都进入事务后，才能结束期中一个事务，两个事务都是存活的）"><a href="#脏读（a-b同时开始事务，a-b再事务，没有哪一个结束，只有两个都进入事务后，才能结束期中一个事务，两个事务都是存活的）" class="headerlink" title="脏读（a,b同时开始事务，a,b再事务，没有哪一个结束，只有两个都进入事务后，才能结束期中一个事务，两个事务都是存活的）"></a>脏读（a,b同时开始事务，a,b再事务，没有哪一个结束，只有两个都进入事务后，才能结束期中一个事务，两个事务都是存活的）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1 a  开启事务  将jason的年龄改成 18岁，但是没有提交事务</span><br><span class="line">2 b  开始事务  读取jason的年龄，发现是18岁。</span><br><span class="line"></span><br><span class="line">上述的问题，</span><br><span class="line">假设a事务回滚，b事务使用的数据就是错误的，就导致程序数据不正确。</span><br></pre></td></tr></table></figure>

<h3 id="不可重复度（a-b同时开始事务，a-b再事务，没有哪一个结束，只有两个都进入事务后，才能结束期中一个事务，两个事务都是存活的）"><a href="#不可重复度（a-b同时开始事务，a-b再事务，没有哪一个结束，只有两个都进入事务后，才能结束期中一个事务，两个事务都是存活的）" class="headerlink" title="不可重复度（a,b同时开始事务，a,b再事务，没有哪一个结束，只有两个都进入事务后，才能结束期中一个事务，两个事务都是存活的）"></a>不可重复度（a,b同时开始事务，a,b再事务，没有哪一个结束，只有两个都进入事务后，才能结束期中一个事务，两个事务都是存活的）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1 a  开始事务  将jason的年龄改成18岁，但是提交了</span><br><span class="line">2 b  开启事务  读取jason的年龄就能读取a事务修改后的jason年龄18岁。</span><br></pre></td></tr></table></figure>

<h3 id="可重读读（a-b同时开始事务，a-b再事务，没有哪一个结束，只有两个都进入事务后，才能结束期中一个事务，两个事务都是存活的）"><a href="#可重读读（a-b同时开始事务，a-b再事务，没有哪一个结束，只有两个都进入事务后，才能结束期中一个事务，两个事务都是存活的）" class="headerlink" title="可重读读（a,b同时开始事务，a,b再事务，没有哪一个结束，只有两个都进入事务后，才能结束期中一个事务，两个事务都是存活的）"></a>可重读读（a,b同时开始事务，a,b再事务，没有哪一个结束，只有两个都进入事务后，才能结束期中一个事务，两个事务都是存活的）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1 a  开始事务  将jason的年龄改成18岁，但是提交了</span><br><span class="line">2 b  开启事务  读取jason的年龄不能读取a事务修改后的jason年龄18岁。而是读取的是38岁</span><br></pre></td></tr></table></figure>

<h3 id="幻读（a-b同时开始事务，a-b再事务，没有哪一个结束，只有两个都进入事务后，才能结束期中一个事务，两个事务都是存活的）"><a href="#幻读（a-b同时开始事务，a-b再事务，没有哪一个结束，只有两个都进入事务后，才能结束期中一个事务，两个事务都是存活的）" class="headerlink" title="幻读（a,b同时开始事务，a,b再事务，没有哪一个结束，只有两个都进入事务后，才能结束期中一个事务，两个事务都是存活的）"></a>幻读（a,b同时开始事务，a,b再事务，没有哪一个结束，只有两个都进入事务后，才能结束期中一个事务，两个事务都是存活的）</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#概念和不可重读有点像，不可重复度是站在修改的基础上，而幻读是站在新增的基础上</span><br><span class="line">1 a  开始事务  将所有的的年龄改成18岁</span><br><span class="line">2 b  开始事务  新增一条数据数据name&#x3D;tank，age&#x3D;19，而且提交了。</span><br><span class="line">3 a  重新查， 发现有一条数据 的age&#x3D;19，这就是所谓的幻读。</span><br></pre></td></tr></table></figure>

<h3 id="如何看msql的隔离级别"><a href="#如何看msql的隔离级别" class="headerlink" title="如何看msql的隔离级别"></a>如何看msql的隔离级别</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select @@global.tx_isolation;</span><br></pre></td></tr></table></figure>

<h3 id="如何修改事务的隔离级别"><a href="#如何修改事务的隔离级别" class="headerlink" title="如何修改事务的隔离级别"></a>如何修改事务的隔离级别</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#修改配置文件</span><br><span class="line">transaction-isolation&#x3D;Read-Committed</span><br><span class="line">#修改后一定要重启数据库</span><br></pre></td></tr></table></figure>

<p><strong>为什么会出现“脏读”？</strong>因为没有“select”操作没有规矩。</p>
<p><strong>为什么会出现“不可重复读”？</strong>因为“update”操作没有规矩。</p>
<p><strong>为什么会出现“幻读”？</strong>因为“insert”和“delete”操作没有规矩。</p>
<p><strong>“读未提（Read Uncommitted）”能预防啥？</strong>啥都预防不了。</p>
<p><strong>“读提交（Read Committed）”能预防啥？</strong>使用“快照读（Snapshot Read）”，避免“脏读”，但是可能出现“不可重复读”和“幻读”。</p>
<p><strong>“可重复读（Repeated Red）”能预防啥？</strong>使用“快照读（Snapshot Read）”，锁住被读取记录，避免出现“脏读”、“不可重复读”，但是可能出现“幻读”。</p>
<p><strong>“串行化（Serializable）”能预防啥？</strong>排排坐，吃果果，有效避免“脏读”、“不可重复读”、“幻读”，不过效果谁用谁知道。</p>
<p><a href="https://baijiahao.baidu.com/s?id=1611918898724887602&amp;wfr=spider&amp;for=pc" target="_blank" rel="noopener">https://baijiahao.baidu.com/s?id=1611918898724887602&amp;wfr=spider&amp;for=pc</a></p>
<h3 id="数据库的乐观锁与悲观锁-是建立再事务的基础上"><a href="#数据库的乐观锁与悲观锁-是建立再事务的基础上" class="headerlink" title="数据库的乐观锁与悲观锁(是建立再事务的基础上)"></a>数据库的乐观锁与悲观锁(是建立再事务的基础上)</h3><h3 id="悲观锁"><a href="#悲观锁" class="headerlink" title="悲观锁"></a>悲观锁</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">悲观锁的概念，他觉有人会修改我读的数据。那我就再查的时候，对数据进行锁定。</span><br><span class="line"></span><br><span class="line">select age from user where id&#x3D;1 for update;</span><br><span class="line">比如 上面的查出来的 age &#x3D;18 </span><br><span class="line">update age改成age &#x3D; age+ 1</span><br><span class="line">如果别人开启了悲观锁这条数据就会被锁定卡住，只能等别人的事物结束才能操作，所以少用慎用 </span><br><span class="line">如果该次查询走了索引，那就是行锁，如果没有走索引就是表锁。</span><br><span class="line"></span><br><span class="line">如何释放锁呢？结束事务就释 放了锁。</span><br><span class="line">django中的orm是如果用悲观锁？</span><br><span class="line">user.objects.select_for_update().filter(id&#x3D;1).first()</span><br></pre></td></tr></table></figure>

<h3 id="乐观锁"><a href="#乐观锁" class="headerlink" title="乐观锁"></a>乐观锁</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">乐观锁的本质不是锁。他是通过代码来实现锁的。他觉的别人不会修改的他的数据。他就读数据不会被别人修改。最后再修改该条数据，再where条件中添加，之前查出来的数据。以保证数据的安全性</span><br><span class="line">select age from user where id&#x3D;1 ;</span><br><span class="line">比如 上面的查出来的 age &#x3D;18   </span><br><span class="line">20 </span><br><span class="line">update age改成age &#x3D; age+ 1  &#x3D;&#x3D;&#x3D;&#x3D;》19</span><br><span class="line"></span><br><span class="line">乐观锁：</span><br><span class="line">update age改成age &#x3D; age+ 1 where age &#x3D;18 and id &#x3D;1  &#x3D;&#x3D;&#x3D;&#x3D;》19</span><br><span class="line">如果我发现不是18,上面的影响行数是0，这样说明数据是不安全的，重新for循环或者其他方式获取数据重新执行</span><br><span class="line">#如果是可重复读，上面的乐观锁无效，必须改成read committed，因为可重复读会读取到之前的数据，所以乐观锁的条件就会成立</span><br><span class="line">a update age改成age &#x3D; age+ 1  &#x3D;&#x3D;&#x3D;&#x3D;》19 提交</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">b select age from user where id&#x3D;1; ---&gt;18</span><br><span class="line"></span><br><span class="line">update age改成age &#x3D; age+ 1 where age &#x3D;18 and id &#x3D;1  &#x3D;&#x3D;&#x3D;&#x3D;》19  ----&gt;数据已经被改</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/11/24/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E5%92%8C%E9%94%81/" data-id="ckd3cw4hi0004rcuthhae1n3y" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MySQL/" rel="tag">MySQL</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-MySQL数据库的基本操作" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/16/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/" class="article-date">
  <time datetime="2018-11-16T13:52:35.000Z" itemprop="datePublished">2018-11-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/16/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/">MySQL数据库的基本操作</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-什么是外键"><a href="#1-什么是外键" class="headerlink" title="1.什么是外键?"></a>1.什么是外键?</h2><p>外键是用来建立两张表之间的关系</p>
<h2 id="2-为什么要有外键"><a href="#2-为什么要有外键" class="headerlink" title="2.为什么要有外键?"></a>2.为什么要有外键?</h2><p>举个栗子:</p>
<p>先定义一张表</p>
<table>
<thead>
<tr>
<th align="center">id</th>
<th align="left">name</th>
<th align="left">gender</th>
<th align="left">dep_name</th>
<th align="left">dep_desc</th>
<th align="left"></th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="left">tank</td>
<td align="left">male</td>
<td align="left">技术部</td>
<td align="left">技术有限部门</td>
<td align="left"></td>
</tr>
<tr>
<td align="center">2</td>
<td align="left">sean</td>
<td align="left">female</td>
<td align="left">销售部</td>
<td align="left">销售丝袜</td>
<td align="left"></td>
</tr>
<tr>
<td align="center">3</td>
<td align="left">egon</td>
<td align="left">female</td>
<td align="left">销售部</td>
<td align="left">销售丝袜</td>
<td align="left"></td>
</tr>
</tbody></table>
<p>将所有数据存放在一张表中的弊端:</p>
<ul>
<li>1.结构不清晰</li>
<li>2.浪费空间</li>
<li>3.可扩展性极差 —&gt; 不可忽视的弊端</li>
</ul>
<p>类似于将所有python代码存放在一个py文件中，强耦合到一起了,代码解耦合就相当于 拆分表</p>
<p>拆分表解决以上问题.</p>
<p>因此需要给两张表之间，建立一种强有力的关系, 通过使用 “外键”</p>
<h2 id="2-怎么使用外键"><a href="#2-怎么使用外键" class="headerlink" title="2.怎么使用外键?"></a>2.怎么使用外键?</h2><p>先创建两张表(将一张表拆分成两张),确认两张表的关系(关系如下)</p>
<ul>
<li>一对多</li>
<li>多对多</li>
<li>一对一</li>
</ul>
<p>注意:确立两张表的关系必须站在两个位置去思考:</p>
<p>即:站在员工表的位置: 多个员工能否对应一个部门？(很明显可以)</p>
<ul>
<li><p>员工与部门: 多 对 一</p>
</li>
<li><p>员工表单向 多 对 一 部门表</p>
</li>
</ul>
<p>站在部门表的位置: 多个部门能够对应一个员工？(也很明显不能)</p>
<ul>
<li>部门与员工:一 对 多</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">总结: <span class="number">1</span>)凡是单向 多 对 一 的表关系，称之为 一对多 的外键关系。</span><br><span class="line">      <span class="number">2</span>)创建两张表,必须先建立被关联表，再建立关联表</span><br></pre></td></tr></table></figure>

<p>重点:外键语法:</p>
<p>foreign key (当前表中建立关系的外键字段) references 被关联表明(id)</p>
<p><img src="https://user-images.githubusercontent.com/57135669/88484906-cb436800-cfa4-11ea-8071-1cc53c973587.jpg" alt="数据库6"></p>
<h2 id="一对多关系"><a href="#一对多关系" class="headerlink" title="一对多关系"></a>一对多关系</h2><p>先创建被关联表:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create table dep(</span><br><span class="line">id int primary key auto_increment,</span><br><span class="line">dep_name varchar(<span class="number">16</span>),</span><br><span class="line">dep_decs varchar(<span class="number">255</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>再创建关联表:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">create table emp(</span><br><span class="line">id int primary key auto_increment,</span><br><span class="line">name varchar(<span class="number">16</span>),</span><br><span class="line">age int,</span><br><span class="line">gender enum(<span class="string">'male'</span>, <span class="string">'female'</span>, <span class="string">'others'</span>) default <span class="string">'male'</span>,</span><br><span class="line">dep_id int <span class="keyword">not</span> null,</span><br><span class="line">foreign key (dep_id) references dep(id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><img src="https://user-images.githubusercontent.com/57135669/88484907-ce3e5880-cfa4-11ea-9782-810b45ebde22.png" alt="数据库7"></p>
<p>建立好表格和再插入数据</p>
<p>先插入被关联表(dep)的数据,再插入关联表(emp)的数据</p>
<p>被关联表:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into dep(dep_name, dep_decs) values(<span class="string">'nb_外交部'</span>, <span class="string">'国际形象大使部门'</span>),(<span class="string">'sb_教学部'</span>, <span class="string">'造程序员部门!!!!'</span>),(<span class="string">'技术部'</span>, <span class="string">'技术有限部门'</span>);</span><br></pre></td></tr></table></figure>

<p>关联表:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into emp(name, age,gender,dep_id)values(<span class="string">'tank'</span>, <span class="number">17</span>, <span class="string">'male'</span>, <span class="number">1</span>),(<span class="string">'jason'</span>, <span class="number">70</span>, <span class="string">'male'</span>, <span class="number">2</span>),(<span class="string">'sean'</span>, <span class="number">50</span>, <span class="string">'male'</span>, <span class="number">2</span>),(<span class="string">'egon'</span>, <span class="number">88</span>, <span class="string">'male'</span>, <span class="number">2</span>),(<span class="string">'owen'</span>, <span class="number">95</span>, <span class="string">'female'</span>, <span class="number">3</span>);</span><br></pre></td></tr></table></figure>

<h2 id="补充-跟新数据"><a href="#补充-跟新数据" class="headerlink" title="补充:跟新数据:"></a>补充:跟新数据:</h2><p>在没有特殊设置的情况下除了表中的关联字段(dep_id和emp表中的id)都可以跟新</p>
<p>update dep set dep_name=’nb_外联部’ where id=1;</p>
<p>报错:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 报错update emp set dep_id&#x3D;100 where id&#x3D;2;</span><br><span class="line"># 报错update dep set id&#x3D;100 where id&#x3D;1;</span><br><span class="line"></span><br><span class="line">报错信息:ERROR 1451 (23000): Cannot delete or update a parent row: a foreign key constraint fails (&#96;db1&#96;.&#96;emp&#96;, CONSTRAINT &#96;emp_ibfk_1&#96; FOREIGN KEY (&#96;dep_id&#96;) REFERENCES &#96;dep&#96; (&#96;id&#96;))</span><br></pre></td></tr></table></figure>

<h3 id="方法一"><a href="#方法一" class="headerlink" title="方法一:"></a>方法一:</h3><p>可以在开始dep_id不强制设置not null的情况下将dep_id修改为null,使其不关联emp,这样emp中的关联id也可以进行修改</p>
<p>update emp set dep_id=null where id=3;#先修改为null</p>
<p>update dep set id=100 where id=2;# 再修改被关联表的id</p>
<p>这样就不会报错</p>
<h3 id="方法二"><a href="#方法二" class="headerlink" title="方法二:"></a>方法二:</h3><p>先删除已关联的dep_id字段，才能修改dep表中的关联id字段。delete from emp where id=1;</p>
<p>update dep set id=100 where id=1;</p>
<p>删除: 先删除关联表中的记录在删除被关联表中的记录</p>
<ul>
<li>删除emp表中的dep_id为2的记录</li>
<li>delete from emp where dep_id=2;</li>
<li>再删除dep表中id为2的记录</li>
<li>delete from dep where id=2;</li>
</ul>
<p>这样也不会报错</p>
<p>缺点:麻烦,数据会丢失</p>
<h3 id="方法三"><a href="#方法三" class="headerlink" title="方法三:"></a>方法三:</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">- 级联更新与级联删除    </span><br><span class="line">- on update cascade   </span><br><span class="line">- on delete cascade</span><br><span class="line">演示:</span><br><span class="line">    - 创建表</span><br><span class="line">    <span class="comment"># 被关联表:</span></span><br><span class="line">dep2:</span><br><span class="line">create table dep2(</span><br><span class="line">    id int primary key auto_increment,</span><br><span class="line">    dep_name varchar(<span class="number">16</span>),</span><br><span class="line">    dep_desc varchar(<span class="number">255</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关联表:</span></span><br><span class="line">emp2:</span><br><span class="line">create table emp2(</span><br><span class="line">    id int primary key</span><br><span class="line">    auto_increment,</span><br><span class="line">    name varchar(<span class="number">16</span>),</span><br><span class="line">    age int,</span><br><span class="line">    gender enum(<span class="string">'male'</span>, <span class="string">'female'</span>, <span class="string">'others'</span>) default <span class="string">'male'</span>,</span><br><span class="line">    dep_id int <span class="keyword">not</span> null,</span><br><span class="line">    foreign key(dep_id) references dep2(id)</span><br><span class="line">    on update cascade</span><br><span class="line">    on delete cascade</span><br><span class="line">                );</span><br><span class="line">- 插入数据</span><br><span class="line"><span class="comment"># dep:</span></span><br><span class="line">insert into dep2(dep_name, dep_desc) values(<span class="string">'nb_外交部'</span>, <span class="string">'国际形象大使部门'</span>),</span><br><span class="line">(<span class="string">'sb_教学部'</span>, <span class="string">'造程序员部门!!!!'</span>),</span><br><span class="line">(<span class="string">'技术部'</span>, <span class="string">'技术有限部门'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># emp:</span></span><br><span class="line">insert into emp2(name, age, gender, dep_id)</span><br><span class="line">values(<span class="string">'tank'</span>, <span class="number">17</span>, <span class="string">'male'</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">'jason'</span>, <span class="number">70</span>, <span class="string">'male'</span>, <span class="number">2</span>),</span><br><span class="line">(<span class="string">'sean'</span>, <span class="number">50</span>, <span class="string">'male'</span>, <span class="number">2</span>),</span><br><span class="line">(<span class="string">'egon'</span>, <span class="number">88</span>, <span class="string">'male'</span>, <span class="number">2</span>),</span><br><span class="line">(<span class="string">'owen'</span>, <span class="number">95</span>, <span class="string">'female'</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 报错,</span></span><br><span class="line">insert into emp(name, age, gender, dep_id) values(<span class="string">'大饼'</span>, <span class="number">100</span>, <span class="string">'others'</span>, <span class="number">999</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- 更新数据或删除数据</span><br><span class="line">- 更新记录</span><br><span class="line">update dep2 set id=<span class="number">200</span> where id=<span class="number">1</span>;</span><br><span class="line">- 删除记录</span><br><span class="line">delete <span class="keyword">from</span> dep2 where id=<span class="number">200</span>;</span><br></pre></td></tr></table></figure>

<p><strong>注意: mysql中没有 多对一 只要 一对多</strong></p>
<h2 id="多对多关系"><a href="#多对多关系" class="headerlink" title="多对多关系"></a>多对多关系</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">也必须站在两张表的位置去思考；    </span><br><span class="line">- 错误示范:        </span><br><span class="line">- 创建book表            </span><br><span class="line">create table book(</span><br><span class="line">id int primary key auto_increment, </span><br><span class="line">title varchar(<span class="number">20</span>),        </span><br><span class="line">price int,</span><br><span class="line">book_content varchar(<span class="number">255</span>),       </span><br><span class="line">author_id int,</span><br><span class="line">foreign key(author_id) references author(id)</span><br><span class="line">on update cascade                </span><br><span class="line">on delete cascade);        </span><br><span class="line"></span><br><span class="line">- 创建author表            </span><br><span class="line">create table author(                </span><br><span class="line">id int primary key auto_increment,         name varchar(<span class="number">16</span>),                </span><br><span class="line">age int,                </span><br><span class="line">book_id int,                </span><br><span class="line">foreign key(book_id) references book(id)   on update cascade                </span><br><span class="line">on delete cascade           </span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">- 问题: 无法知道哪张表是被关联表</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- 利用第三张表，为两张表建立“多对多外键关系”。   - book:        </span><br><span class="line">create table book(                </span><br><span class="line">id int primary key auto_increment,         title varchar(<span class="number">20</span>),                </span><br><span class="line">price int,                </span><br><span class="line">book_content varchar(<span class="number">255</span>)        </span><br><span class="line">);    </span><br><span class="line"></span><br><span class="line">- author:       </span><br><span class="line">create table author(                </span><br><span class="line">id int primary key auto_increment,         name varchar(<span class="number">16</span>),                </span><br><span class="line">age int        </span><br><span class="line">);    </span><br><span class="line"></span><br><span class="line">- book2author:        </span><br><span class="line">create table book2author(            </span><br><span class="line">id int primary key auto_increment,         book_id int,            </span><br><span class="line">author_id int,            </span><br><span class="line">foreign key(book_id) references book(id)   on update cascade            </span><br><span class="line">on delete cascade,            </span><br><span class="line">foreign key(author_id) references author(id)            </span><br><span class="line">on update cascade            </span><br><span class="line">on delete cascade        </span><br><span class="line">);- 插入数据    </span><br><span class="line"></span><br><span class="line">- book    </span><br><span class="line">insert into book(title, price, book_content) values    </span><br><span class="line">(<span class="string">'金瓶mei'</span>, <span class="number">199</span>, <span class="string">'讲述朦胧时光的小故事'</span>),    (<span class="string">'python从入门到断气'</span>, <span class="number">2000</span>, <span class="string">'学习如何一夜秃头'</span>),    </span><br><span class="line">(<span class="string">'三体'</span>, <span class="number">200</span>, <span class="string">'跟着大佬进入宇宙奇幻世界'</span>)    ;    </span><br><span class="line">- author    </span><br><span class="line">insert into author(name, age) values    (<span class="string">'egon'</span>, <span class="number">68</span>), (<span class="string">'jason'</span>, <span class="number">88</span>);    </span><br><span class="line"></span><br><span class="line">- book2author：    </span><br><span class="line">insert into book2author(book_id, author_id) values (<span class="number">1</span>, <span class="number">1</span>),(<span class="number">1</span>, <span class="number">2</span>),(<span class="number">2</span>, <span class="number">2</span>),(<span class="number">3</span>, <span class="number">1</span>);    </span><br><span class="line"></span><br><span class="line"><span class="comment"># 报错, 插入的数据，</span></span><br><span class="line">book_id, author_id必须存在    </span><br><span class="line">insert into book2author(book_id, author_id) values (<span class="number">4</span>, <span class="number">4</span>);    </span><br><span class="line"></span><br><span class="line"><span class="comment"># 更新或删除        </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 更新            </span></span><br><span class="line"></span><br><span class="line">- update book set price=<span class="number">6666</span> where id=<span class="number">1</span>;    - update book set id=<span class="number">4</span> where id=<span class="number">1</span>;        </span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除            </span></span><br><span class="line">- delete <span class="keyword">from</span> book where id=<span class="number">4</span>;</span><br></pre></td></tr></table></figure>

<h2 id="一对一关系"><a href="#一对一关系" class="headerlink" title="一对一关系"></a>一对一关系</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">- 两张表之间的关系 一一对应，将一张数据量比较大的表，拆分成两张表。</span><br><span class="line">- user_info:</span><br><span class="line">id, name, age, gender, hobby, id_card</span><br><span class="line"></span><br><span class="line">- user:</span><br><span class="line">id , name, age, detail_id（外键）</span><br><span class="line"></span><br><span class="line">- detail:</span><br><span class="line">id, gender, hobby, id_card</span><br><span class="line"></span><br><span class="line">user与detail表建立了 一对一的外键 关系。</span><br><span class="line">foreign key 应该建在 使用频率较高的一方。</span><br><span class="line"></span><br><span class="line">- 创建表</span><br><span class="line"><span class="comment"># 被关联表</span></span><br><span class="line">create table customer(</span><br><span class="line">id int primary key auto_increment,</span><br><span class="line">name varchar(<span class="number">16</span>),</span><br><span class="line">media varchar(<span class="number">32</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 关联表</span></span><br><span class="line">create table student(</span><br><span class="line">id int primary key auto_increment,</span><br><span class="line">addr varchar(<span class="number">255</span>),</span><br><span class="line">phone char(<span class="number">11</span>),</span><br><span class="line">id_card char(<span class="number">18</span>),</span><br><span class="line"></span><br><span class="line"><span class="comment"># 外键必须设置为唯一的</span></span><br><span class="line">customer_id int unique,</span><br><span class="line">foreign key(customer_id) references customer(id)</span><br><span class="line">on update cascade</span><br><span class="line">on delete cascade</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">- 插入数据</span><br><span class="line">insert into customer(name, media) values</span><br><span class="line">(<span class="string">'hcy'</span>, <span class="string">'facebook'</span>),</span><br><span class="line">(<span class="string">'zsb1'</span>, <span class="string">'ig'</span>),</span><br><span class="line">(<span class="string">'zsb2'</span>, <span class="string">'vk'</span>),</span><br><span class="line">(<span class="string">'hb'</span>, <span class="string">'探探'</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">insert into student(addr, phone, id_card, customer_id) values</span><br><span class="line">(<span class="string">'上海'</span>, <span class="string">'15214546711'</span>, <span class="string">'440888888888888888'</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="string">'北京'</span>, <span class="string">'18888888888'</span>, <span class="string">'440777777777777777'</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 报错，一对一，关系必须 一一对应</span></span><br><span class="line">insert into student(addr, phone, id_card, customer_id) values (<span class="string">'上海'</span>, <span class="string">'15214546711'</span>, <span class="string">'440888888888888888'</span>, <span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<h2 id="4-修改表的操作"><a href="#4-修改表的操作" class="headerlink" title="4.修改表的操作"></a>4.修改表的操作</h2><ul>
<li><p>语法： 注意: mysql 关键字不区分大小写</p>
</li>
<li><p>修改表名</p>
<p>ALTER TABLE 表名</p>
<p>RENAME 新表名;</p>
</li>
<li><p>增加字段</p>
<p>ALTER TABLE 表名</p>
<p>ADD 字段名 数据类型 [完整性约束条件…],</p>
<p>ADD 字段名 数据类型 [完整性约束条件…]; # 添加到最后一列</p>
<p>ALTER TABLE 表名</p>
<p>ADD 字段名 数据类型 [完整性约束条件…] FIRST; # 添加到第一列</p>
<p>ALTER TABLE 表名</p>
<p>ADD 字段名 数据类型 [完整性约束条件…] AFTER 字段名; # 添加到某一列之后</p>
</li>
<li><p>删除字段</p>
<p>ALTER TABLE 表名</p>
<p>DROP 字段名;</p>
</li>
<li><p>修改字段</p>
<p>ALTER TABLE 表名</p>
<p>MODIFY 字段名 数据类型 [完整性约束条件…]; # 修改数据类型</p>
<p>ALTER TABLE 表名</p>
<p>CHANGE 旧字段名 新字段名 旧数据类型 [完整性约束条件…]; # 修改字段名，保留字段类型</p>
<p>ALTER TABLE 表名</p>
<p>CHANGE 旧字段名 新字段名 新数据类型 [完整性约束条件…]; # 修改字段名与字段类型</p>
</li>
<li><p>复制表的操作:</p>
<p>复制表结构＋记录 （key不会复制: 主键、外键和索引）</p>
<p>mysql&gt; create table new_service select * from service;</p>
<p>只复制表结构</p>
<p>将select * from service where 1=2; —&gt; 不要真实数据，需要表结构</p>
<p>mysql&gt; create table new_customer select * from customer where 1=2;</p>
</li>
</ul>
<h2 id="一-查询语句的基本操作"><a href="#一-查询语句的基本操作" class="headerlink" title="一.查询语句的基本操作"></a>一.查询语句的基本操作</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>查询语句的基本操作</span><br><span class="line">        - select</span><br><span class="line">        - <span class="keyword">from</span></span><br><span class="line">        - where:约束条件</span><br><span class="line">        - group by:分组</span><br><span class="line">        - having：过滤</span><br><span class="line">        - distinct：去重</span><br><span class="line">        - order by：排序</span><br><span class="line">        - limit：限制查询记录的数量</span><br><span class="line">        - 聚合函数: count（计数）</span><br><span class="line">                   max（最大值）</span><br><span class="line">                   min（最小值）</span><br><span class="line">                   avg（平均值）</span><br><span class="line">                   sum(求和)</span><br></pre></td></tr></table></figure>

<h2 id="二-单表查询"><a href="#二-单表查询" class="headerlink" title="二.单表查询"></a>二.单表查询</h2><h3 id="1、前期表与数据准备"><a href="#1、前期表与数据准备" class="headerlink" title="1、前期表与数据准备"></a>1、前期表与数据准备</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"># 创建一张部门表</span><br><span class="line">create table emp(</span><br><span class="line">  id int not null unique auto_increment,</span><br><span class="line">  name varchar(20) not null,</span><br><span class="line">  sex enum(&#39;male&#39;,&#39;female&#39;) not null default &#39;male&#39;, #大部分是男的</span><br><span class="line">  age int(3) unsigned not null default 28,</span><br><span class="line">  hire_date date not null,</span><br><span class="line">  post varchar(50),</span><br><span class="line">  post_comment varchar(100),</span><br><span class="line">  salary double(15,2),</span><br><span class="line">  office int, # 一个部门一个屋子</span><br><span class="line">  depart_id int</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 插入记录</span><br><span class="line"># 三个部门：教学，销售，运营</span><br><span class="line">insert into emp(name,sex,age,hire_date,post,salary,office,depart_id) values</span><br><span class="line">(&#39;tank&#39;,&#39;male&#39;,17,&#39;20170301&#39;,&#39;张江第一帅形象代言部门&#39;,7300.33,401,1), # 以下是教学部</span><br><span class="line">(&#39;egon&#39;,&#39;male&#39;,78,&#39;20150302&#39;,&#39;teacher&#39;,1000000.31,401,1),</span><br><span class="line">(&#39;kevin&#39;,&#39;male&#39;,81,&#39;20130305&#39;,&#39;teacher&#39;,8300,401,1),</span><br><span class="line">(&#39;jason&#39;,&#39;male&#39;,73,&#39;20140701&#39;,&#39;teacher&#39;,3500,401,1),</span><br><span class="line">(&#39;owen&#39;,&#39;male&#39;,28,&#39;20121101&#39;,&#39;teacher&#39;,2100,401,1),</span><br><span class="line">(&#39;jerry&#39;,&#39;female&#39;,18,&#39;20110211&#39;,&#39;teacher&#39;,9000,401,1),</span><br><span class="line">(&#39;大饼&#39;,&#39;male&#39;,18,&#39;19000301&#39;,&#39;teacher&#39;,30000,401,1),</span><br><span class="line">(&#39;sean&#39;,&#39;male&#39;,48,&#39;20101111&#39;,&#39;teacher&#39;,10000,401,1),</span><br><span class="line"></span><br><span class="line">(&#39;歪歪&#39;,&#39;female&#39;,48,&#39;20150311&#39;,&#39;sale&#39;,3000.13,402,2),# 以下是销售部门</span><br><span class="line">(&#39;丫丫&#39;,&#39;female&#39;,38,&#39;20101101&#39;,&#39;sale&#39;,2000.35,402,2),</span><br><span class="line">(&#39;丁丁&#39;,&#39;female&#39;,18,&#39;20110312&#39;,&#39;sale&#39;,1000.37,402,2),</span><br><span class="line">(&#39;星星&#39;,&#39;female&#39;,18,&#39;20160513&#39;,&#39;sale&#39;,3000.29,402,2),</span><br><span class="line">(&#39;格格&#39;,&#39;female&#39;,28,&#39;20170127&#39;,&#39;sale&#39;,4000.33,402,2),</span><br><span class="line"></span><br><span class="line">(&#39;张野&#39;,&#39;male&#39;,28,&#39;20160311&#39;,&#39;operation&#39;,10000.13,403,3), # 以下是运营部门</span><br><span class="line">(&#39;程咬金&#39;,&#39;male&#39;,18,&#39;19970312&#39;,&#39;operation&#39;,20000,403,3),</span><br><span class="line">(&#39;程咬银&#39;,&#39;female&#39;,18,&#39;20130311&#39;,&#39;operation&#39;,19000,403,3),</span><br><span class="line">(&#39;程咬铜&#39;,&#39;male&#39;,18,&#39;20150411&#39;,&#39;operation&#39;,18000,403,3),</span><br><span class="line">(&#39;程咬铁&#39;,&#39;female&#39;,18,&#39;20140512&#39;,&#39;operation&#39;,17000,403,3);</span><br><span class="line"></span><br><span class="line"># PS：如果在windows系统中，插入中文字符，select的结果为空白，可以将所有字符编码统一设置成gbk</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- select * from emp;  # 若数据比较多，比较凌乱，可以在表后面+ \G</span><br><span class="line">- select * from emp\G</span><br><span class="line">- select * from emp;  # 若数据比较多，比较凌乱，可以在表后面+ \G    </span><br><span class="line">- select * from emp\G</span><br></pre></td></tr></table></figure>

<p><img src="https://user-images.githubusercontent.com/57135669/88484909-d26a7600-cfa4-11ea-8dbe-c3fe48d2f662.png" alt="数据库8"></p>
<h3 id="重点："><a href="#重点：" class="headerlink" title="重点："></a>重点：</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"> 写SQL语句必须遵循两点:</span><br><span class="line"> - 书写顺序:</span><br><span class="line"><span class="comment"># 获取id为 4、5的两条记录</span></span><br><span class="line">select * <span class="keyword">from</span> emp where id &gt; <span class="number">3</span> <span class="keyword">and</span> id &lt; <span class="number">6</span>;</span><br><span class="line"></span><br><span class="line">    - select</span><br><span class="line">    - <span class="keyword">from</span></span><br><span class="line">    - where</span><br><span class="line">    </span><br><span class="line">  - 执行顺序:</span><br><span class="line"></span><br><span class="line">   比如: 图书管理员，得先找到是哪一个图书馆(哪张表),</span><br><span class="line">   再找这本书在图书馆的哪个位置(哪一条记录), 最后查找这个本书中某一页(哪些字段值);</span><br><span class="line"></span><br><span class="line">   select * <span class="keyword">from</span> emp where id &gt; <span class="number">3</span> <span class="keyword">and</span> id &lt; <span class="number">6</span>;</span><br><span class="line">    - from ---&gt; 找到图书馆</span><br><span class="line">    - where ---&gt; 找到书的位置</span><br><span class="line">    - select ---&gt; 找到书本中的某一页</span><br><span class="line">    </span><br><span class="line"> 注意: 必须记住SQL语句的 书写顺序 与 执行顺序(*******);</span><br></pre></td></tr></table></figure>

<h2 id="1-where-约束条件"><a href="#1-where-约束条件" class="headerlink" title="1.where(约束条件)"></a>1.where(约束条件)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># PS: 根据执行顺序来书写 SQL语句，一步一步来写;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.查询id大于等于3小于等于6的数据(and:与)</span></span><br><span class="line"></span><br><span class="line">select * <span class="keyword">from</span> emp where id &gt;= <span class="number">3</span> <span class="keyword">and</span> id &lt;= <span class="number">6</span>;</span><br><span class="line"></span><br><span class="line">mysql&gt; SELECT * FROM EMP WHERE ID &gt; <span class="number">3</span> AND ID &lt;= <span class="number">6</span>;</span><br><span class="line">+----+-------+--------+-----+------------+---------+--------------+---------+--------+-----------+</span><br><span class="line">| id | name  | sex    | age | hire_date  | post    | post_comment | salary  | office | depart_id |</span><br><span class="line">+----+-------+--------+-----+------------+---------+--------------+---------+--------+-----------+</span><br><span class="line">|  <span class="number">4</span> | jason | male   |  <span class="number">73</span> | <span class="number">2014</span><span class="number">-07</span><span class="number">-01</span> | teacher | NULL         | <span class="number">3500.00</span> |    <span class="number">401</span> |         <span class="number">1</span> |</span><br><span class="line">|  <span class="number">5</span> | owen  | male   |  <span class="number">28</span> | <span class="number">2012</span><span class="number">-11</span><span class="number">-01</span> | teacher | NULL         | <span class="number">2100.00</span> |    <span class="number">401</span> |         <span class="number">1</span> |</span><br><span class="line">|  <span class="number">6</span> | jerry | female |  <span class="number">18</span> | <span class="number">2011</span><span class="number">-02</span><span class="number">-11</span> | teacher | NULL         | <span class="number">9000.00</span> |    <span class="number">401</span> |         <span class="number">1</span> |</span><br><span class="line">+----+-------+--------+-----+------------+---------+--------------+---------+--------+-----------+</span><br><span class="line"><span class="number">3</span> rows <span class="keyword">in</span> set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#可以使用between()and()  :两者之间</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> emp where id between <span class="number">3</span> <span class="keyword">and</span> <span class="number">6</span>;</span><br><span class="line">+----+-------+--------+-----+------------+---------+--------------+---------+--------+-----------+</span><br><span class="line">| id | name  | sex    | age | hire_date  | post    | post_comment | salary  | office | depart_id |</span><br><span class="line">+----+-------+--------+-----+------------+---------+--------------+---------+--------+-----------+</span><br><span class="line">|  <span class="number">3</span> | kevin | male   |  <span class="number">81</span> | <span class="number">2013</span><span class="number">-03</span><span class="number">-05</span> | teacher | NULL         | <span class="number">8300.00</span> |    <span class="number">401</span> |         <span class="number">1</span> |</span><br><span class="line">|  <span class="number">4</span> | jason | male   |  <span class="number">73</span> | <span class="number">2014</span><span class="number">-07</span><span class="number">-01</span> | teacher | NULL         | <span class="number">3500.00</span> |    <span class="number">401</span> |         <span class="number">1</span> |</span><br><span class="line">|  <span class="number">5</span> | owen  | male   |  <span class="number">28</span> | <span class="number">2012</span><span class="number">-11</span><span class="number">-01</span> | teacher | NULL         | <span class="number">2100.00</span> |    <span class="number">401</span> |         <span class="number">1</span> |</span><br><span class="line">|  <span class="number">6</span> | jerry | female |  <span class="number">18</span> | <span class="number">2011</span><span class="number">-02</span><span class="number">-11</span> | teacher | NULL         | <span class="number">9000.00</span> |    <span class="number">401</span> |         <span class="number">1</span> |</span><br><span class="line">+----+-------+--------+-----+------------+---------+--------------+---------+--------+-----------+</span><br><span class="line"><span class="number">4</span> rows <span class="keyword">in</span> set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2.查询薪资是20000或者18000或者17000的数据</span></span><br><span class="line"><span class="comment"># or:  或者</span></span><br><span class="line">select * <span class="keyword">from</span> emp where salary=<span class="number">20000</span> <span class="keyword">or</span> salary=<span class="number">18000</span> <span class="keyword">or</span> salary=<span class="number">17000</span>;</span><br><span class="line"><span class="comment"># in: 在什么里</span></span><br><span class="line">select * <span class="keyword">from</span> emp where salary <span class="keyword">in</span> (<span class="number">20000</span>, <span class="number">18000</span>, <span class="number">17000</span>);</span><br><span class="line"></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span>  emp where salary = <span class="number">20000</span> <span class="keyword">or</span> salary  = <span class="number">18000</span> <span class="keyword">or</span> salary = <span class="number">17000</span>;</span><br><span class="line">+----+-----------+--------+-----+------------+-----------+--------------+----------+--------+-----------+</span><br><span class="line">| id | name      | sex    | age | hire_date  | post      | post_comment | salary   | office | depart_id |</span><br><span class="line">+----+-----------+--------+-----+------------+-----------+--------------+----------+--------+-----------+</span><br><span class="line">| <span class="number">15</span> | 程咬金    | male   |  <span class="number">18</span> | <span class="number">1997</span><span class="number">-03</span><span class="number">-12</span> | operation | NULL         | <span class="number">20000.00</span> |    <span class="number">403</span> |         <span class="number">3</span> |</span><br><span class="line">| <span class="number">17</span> | 程咬铜    | male   |  <span class="number">18</span> | <span class="number">2015</span><span class="number">-04</span><span class="number">-11</span> | operation | NULL         | <span class="number">18000.00</span> |    <span class="number">403</span> |         <span class="number">3</span> |</span><br><span class="line">| <span class="number">18</span> | 程咬铁    | female |  <span class="number">18</span> | <span class="number">2014</span><span class="number">-05</span><span class="number">-12</span> | operation | NULL         | <span class="number">17000.00</span> |    <span class="number">403</span> |         <span class="number">3</span> |</span><br><span class="line">+----+-----------+--------+-----+------------+-----------+--------------+----------+--------+-----------+</span><br><span class="line"><span class="number">3</span> rows <span class="keyword">in</span> set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 也可以使用in(3,4,5,6)</span></span><br><span class="line"> select * <span class="keyword">from</span> emp where id <span class="keyword">in</span>(<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>);</span><br><span class="line">+----+-------+--------+-----+------------+---------+--------------+---------+--------+-----------+</span><br><span class="line">| id | name  | sex    | age | hire_date  | post    | post_comment | salary  | office | depart_id |</span><br><span class="line">+----+-------+--------+-----+------------+---------+--------------+---------+--------+-----------+</span><br><span class="line">|  <span class="number">3</span> | kevin | male   |  <span class="number">81</span> | <span class="number">2013</span><span class="number">-03</span><span class="number">-05</span> | teacher | NULL         | <span class="number">8300.00</span> |    <span class="number">401</span> |         <span class="number">1</span> |</span><br><span class="line">|  <span class="number">4</span> | jason | male   |  <span class="number">73</span> | <span class="number">2014</span><span class="number">-07</span><span class="number">-01</span> | teacher | NULL         | <span class="number">3500.00</span> |    <span class="number">401</span> |         <span class="number">1</span> |</span><br><span class="line">|  <span class="number">5</span> | owen  | male   |  <span class="number">28</span> | <span class="number">2012</span><span class="number">-11</span><span class="number">-01</span> | teacher | NULL         | <span class="number">2100.00</span> |    <span class="number">401</span> |         <span class="number">1</span> |</span><br><span class="line">|  <span class="number">6</span> | jerry | female |  <span class="number">18</span> | <span class="number">2011</span><span class="number">-02</span><span class="number">-11</span> | teacher | NULL         | <span class="number">9000.00</span> |    <span class="number">401</span> |         <span class="number">1</span> |</span><br><span class="line">+----+-------+--------+-----+------------+---------+--------------+---------+--------+-----------+</span><br><span class="line"><span class="number">4</span> rows <span class="keyword">in</span> set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.查询员工姓名中包含o字母 的 员工姓名和薪资</span></span><br><span class="line"><span class="comment"># like: 模糊匹配</span></span><br><span class="line"><span class="comment"># %: 匹配0个或多个任意字符(若前后都有%(%o%),查所有带有索引字符的记录,若头有%而尾没有(%o),则查所有尾带有索引字符的记录,若尾有%而头没有(o%),则查所有头带有索引字符的记录,若前后都没有%(o),则只会查询只有索引字符的字符)</span></span><br><span class="line"><span class="comment"># _: 匹配一个任意字符</span></span><br><span class="line">select name, salary <span class="keyword">from</span> emp where name like <span class="string">"%o%"</span>;</span><br><span class="line">+-------+------------+</span><br><span class="line">| name  | salary     |</span><br><span class="line">+-------+------------+</span><br><span class="line">| egon  | <span class="number">1000000.31</span> |</span><br><span class="line">| jason |    <span class="number">3500.00</span> |</span><br><span class="line">| owen  |    <span class="number">2100.00</span> |</span><br><span class="line">+-------+------------+</span><br><span class="line"><span class="number">3</span> rows <span class="keyword">in</span> set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt; select name, salary <span class="keyword">from</span> emp where name like <span class="string">"o"</span>;</span><br><span class="line">+------+--------+</span><br><span class="line">| name | salary |</span><br><span class="line">+------+--------+</span><br><span class="line">| o    |   NULL |</span><br><span class="line">+------+--------+</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4.查找名字个数为3个的员工 名字 与 薪资</span></span><br><span class="line">select name, salary <span class="keyword">from</span> emp where name like <span class="string">"___"</span>;</span><br><span class="line">+-----------+----------+</span><br><span class="line">| name      | salary   |</span><br><span class="line">+-----------+----------+</span><br><span class="line">| 程咬金    | <span class="number">20000.00</span> |</span><br><span class="line">| 程咬银    | <span class="number">19000.00</span> |</span><br><span class="line">| 程咬铜    | <span class="number">18000.00</span> |</span><br><span class="line">| 程咬铁    | <span class="number">17000.00</span> |</span><br><span class="line">+-----------+----------+</span><br><span class="line"><span class="number">4</span> rows <span class="keyword">in</span> set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者 # char_length(name): 计算名字字符的长度</span></span><br><span class="line">select name, salary <span class="keyword">from</span> emp where char_length(name) = <span class="number">4</span>;</span><br><span class="line">    </span><br><span class="line">mysql&gt; select name, salary <span class="keyword">from</span> emp where char_length(name) = <span class="number">3</span>;</span><br><span class="line">+-----------+----------+</span><br><span class="line">| name      | salary   |</span><br><span class="line">+-----------+----------+</span><br><span class="line">| 程咬金    | <span class="number">20000.00</span> |</span><br><span class="line">| 程咬银    | <span class="number">19000.00</span> |</span><br><span class="line">| 程咬铜    | <span class="number">18000.00</span> |</span><br><span class="line">| 程咬铁    | <span class="number">17000.00</span> |</span><br><span class="line">+-----------+----------+</span><br><span class="line"><span class="number">4</span> rows <span class="keyword">in</span> set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 5.查询id小于3或者大于6的数据</span></span><br><span class="line"><span class="comment"># not in: 不再什么什么中</span></span><br><span class="line">select * <span class="keyword">from</span> emp where id <span class="keyword">not</span> <span class="keyword">in</span> (<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>);</span><br><span class="line">select * <span class="keyword">from</span> emp where id <span class="keyword">not</span> between <span class="number">3</span> <span class="keyword">and</span> <span class="number">6</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 6.查询薪资不在20000，18000，17000范围的数据</span></span><br><span class="line">select * <span class="keyword">from</span> emp where salary <span class="keyword">not</span> <span class="keyword">in</span> (<span class="number">20000</span>, <span class="number">18000</span>, <span class="number">17000</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="comment"># 7.查询岗位描述为空的 员工名 与 岗位名 post_comment</span></span><br><span class="line"><span class="comment"># 用等于号无法判定空字段</span></span><br><span class="line">select name, post <span class="keyword">from</span> emp where post_comment = null;</span><br><span class="line"></span><br><span class="line">select * <span class="keyword">from</span> emp where post_comment = null;</span><br><span class="line">Empty set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意: 针对null的值 需要使用 is</span></span><br><span class="line">select name, post <span class="keyword">from</span> emp where post_comment <span class="keyword">is</span> null;</span><br><span class="line"></span><br><span class="line">select name, post_comment <span class="keyword">from</span> emp where post_comment <span class="keyword">is</span> null;</span><br><span class="line">+-----------+--------------+</span><br><span class="line">| name      | post_comment |</span><br><span class="line">+-----------+--------------+</span><br><span class="line">| tank      | NULL         |</span><br><span class="line">| egon      | NULL         |</span><br><span class="line">| kevin     | NULL         |</span><br><span class="line">| jason     | NULL         |</span><br><span class="line">| owen      | NULL         |</span><br><span class="line">| jerry     | NULL         |</span><br><span class="line">| 大饼      | NULL         |</span><br><span class="line">| sean      | NULL         |</span><br><span class="line">| 歪歪      | NULL         |</span><br><span class="line">| 丫丫      | NULL         |</span><br><span class="line">| 丁丁      | NULL         |</span><br><span class="line">| 星星      | NULL         |</span><br><span class="line">| 格格      | NULL         |</span><br><span class="line">| 张野      | NULL         |</span><br><span class="line">| 程咬金    | NULL         |</span><br><span class="line">| 程咬银    | NULL         |</span><br><span class="line">| 程咬铜    | NULL         |</span><br><span class="line">| 程咬铁    | NULL         |</span><br><span class="line">| o         | NULL         |</span><br><span class="line">+-----------+--------------+</span><br><span class="line"><span class="number">19</span> rows <span class="keyword">in</span> set (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<h2 id="2-group-by-分组"><a href="#2-group-by-分组" class="headerlink" title="2.group by(分组)"></a>2.group by(分组)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">  - 书写顺序:</span><br><span class="line">                - select</span><br><span class="line">                - <span class="keyword">from</span></span><br><span class="line">                - where</span><br><span class="line">                - group by</span><br><span class="line"></span><br><span class="line">            - 执行顺序:</span><br><span class="line">                - <span class="keyword">from</span></span><br><span class="line">                - where</span><br><span class="line">                - group by</span><br><span class="line">                - select</span><br><span class="line"><span class="comment"># 什么叫分组               </span></span><br><span class="line"><span class="comment"># 比如: 一张员工表中有性别字段，可以根据性别分组，一组是男性，一组是女性，或者是根据部门分组，有教学部、销售部等...    </span></span><br><span class="line"></span><br><span class="line"> <span class="comment"># 1.根据部门分组</span></span><br><span class="line"> <span class="comment"># 非严格模式下可以获取 分组条件post 以外的字段数据</span></span><br><span class="line">select post, salary <span class="keyword">from</span> emp group by post;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置严格模式:</span></span><br><span class="line">show variables like <span class="string">"%mode%"</span>;</span><br><span class="line"><span class="comment"># 全局设置: 永久有效</span></span><br><span class="line">set <span class="keyword">global</span> sql_mode=<span class="string">"strict_trans_tables,only_full_group_by"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">设置sql_mode为only_full_group_by，意味着以后但凡分组，只能取到分组的依据，</span></span><br><span class="line"><span class="string">不应该在去取组里面的单个元素的值，那样的话分组就没有意义了，并且会报错,因为不分组就是对单个元素信息的随意获取</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">mysql&gt; select post, salary <span class="keyword">from</span> emp group by post;</span><br><span class="line">ERROR <span class="number">1046</span> (<span class="number">3</span>D000): No database selected</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 可以同聚合函数，间接获取其他字段数据</span></span><br><span class="line"> 聚合函数:</span><br><span class="line">   count: 计数</span><br><span class="line">   max: 最大值</span><br><span class="line">   min: 最小值</span><br><span class="line">   avg: 平均值</span><br><span class="line">   sum: 求和</span><br><span class="line">   group_concat(name): 可以将分组后的 所有名字获取并进行拼接</span><br><span class="line">   </span><br><span class="line"><span class="comment"># 指定以:拼接</span></span><br><span class="line">select post, group_concat(name) <span class="keyword">from</span> emp group by post;</span><br><span class="line">select post, group_concat(name, <span class="string">':'</span>) <span class="keyword">from</span> emp group by post;</span><br><span class="line">    </span><br><span class="line">  </span><br><span class="line"> <span class="number">2.</span>获取每个 部门 的最高工资</span><br><span class="line"> select post,max(salary) <span class="keyword">from</span> emp group by post;</span><br><span class="line">mysql&gt;  select post,max(salary) <span class="keyword">from</span> emp group by post;</span><br><span class="line">+-----------------------------------+-------------+</span><br><span class="line">| post                              | max(salary) |</span><br><span class="line">+-----------------------------------+-------------+</span><br><span class="line">| NULL                              |        NULL |</span><br><span class="line">| operation                         |    <span class="number">20000.00</span> |</span><br><span class="line">| sale                              |     <span class="number">4000.33</span> |</span><br><span class="line">| teacher                           |  <span class="number">1000000.31</span> |</span><br><span class="line">| 张江第一帅形象代言部门            |     <span class="number">7300.33</span> |</span><br><span class="line">+-----------------------------------+-------------+</span><br><span class="line"><span class="number">5</span> rows <span class="keyword">in</span> set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">补充: <span class="keyword">as</span> 别名: 可以给字段 加一个 别名</span><br><span class="line">select post <span class="keyword">as</span> <span class="string">'部门'</span>, max(salary) <span class="keyword">as</span> <span class="string">'薪资'</span></span><br><span class="line"><span class="keyword">from</span> emp group by post;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 也可以简写,但是不推荐</span></span><br><span class="line">select post <span class="string">'部门'</span>, max(salary) <span class="string">'薪资'</span></span><br><span class="line"><span class="keyword">from</span> emp group by post;</span><br><span class="line"></span><br><span class="line">mysql&gt; select post <span class="keyword">as</span> <span class="string">'部门'</span>, max(salary) <span class="keyword">as</span><span class="string">'薪资'</span></span><br><span class="line">    -&gt; from emp group by post;</span><br><span class="line">+-----------------------------------+------------+</span><br><span class="line">| 部门                              | 薪资       |</span><br><span class="line">+-----------------------------------+------------+</span><br><span class="line">| NULL                              |       NULL |</span><br><span class="line">| operation                         |   <span class="number">20000.00</span> |</span><br><span class="line">| sale                              |    <span class="number">4000.33</span> |</span><br><span class="line">| teacher                           | <span class="number">1000000.31</span> |</span><br><span class="line">| 张江第一帅形象代言部门            |    <span class="number">7300.33</span> |</span><br><span class="line">+-----------------------------------+------------+</span><br><span class="line"><span class="number">5</span> rows <span class="keyword">in</span> set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>每个部门的最低工资</span><br><span class="line">select post, min(salary) <span class="keyword">from</span> emp group by post;</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span>每个部门的平均工资</span><br><span class="line">select post, avg(salary) <span class="keyword">from</span> emp group by post;</span><br><span class="line"></span><br><span class="line"><span class="number">5.</span>每个部门的工资总和</span><br><span class="line">select post, sum(salary) <span class="keyword">from</span> emp group by post;</span><br><span class="line"></span><br><span class="line"><span class="number">6.</span>每个部门的员工个数</span><br><span class="line"><span class="comment"># count(): 括号中可以填任意非空值</span></span><br><span class="line">select post, count(salary) <span class="keyword">from</span> emp group by post;</span><br><span class="line">select post, count(post_comment) <span class="keyword">from</span> emp group by post;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">查询岗位名以及各岗位内包含的员工个数</span><br><span class="line">select post, count(id) <span class="keyword">from</span> emp group by post;</span><br><span class="line">查询公司内男员工和女员工的个数</span><br><span class="line">select sex, count(*) <span class="keyword">from</span> emp group by sex;</span><br><span class="line"></span><br><span class="line">查询男员工与男员工的平均薪资，女员工与女员工的平均薪资</span><br><span class="line">select sex, avg(salary) <span class="keyword">from</span> emp group by sex;</span><br><span class="line"></span><br><span class="line">.统计各部门年龄在<span class="number">30</span>岁以上的员工平均工资:</span><br><span class="line"><span class="comment"># 步骤: 先找到表，再找年龄30岁以上，再根据部门分组，最后求平均薪资;</span></span><br><span class="line">select post, avg(salary) <span class="keyword">from</span> emp where age &gt; <span class="number">30</span> group by post;</span><br></pre></td></tr></table></figure>

<p><strong>总结:</strong> 聚合函数，必须跟在group by 后面(执行顺序);</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 聚合函数: 若没有group by 分组，默认将查出来的数据当做一个分组, 也能使用;</span></span><br><span class="line">select max(salary) <span class="keyword">from</span> emp;</span><br><span class="line"> <span class="comment"># group_concat(name): 可以将分组后的 所有名字获取并进行拼接</span></span><br><span class="line"> <span class="comment"># 默认以, 拼接</span></span><br><span class="line">select post, group_concat(name) <span class="keyword">from</span> emp group by post;</span><br><span class="line"> <span class="comment"># 指定以:拼接</span></span><br><span class="line">select post, group_concat(name, <span class="string">':'</span>) <span class="keyword">from</span> emp group by post;</span><br><span class="line"><span class="comment"># </span></span><br><span class="line">select post, group_concat(<span class="string">'Name: '</span>, name) <span class="keyword">from</span> emp group by post;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">select post, group_coucat(name) <span class="keyword">from</span> emp group by post;</span><br><span class="line"></span><br><span class="line">mysql&gt; select post, group_concat(name) <span class="keyword">from</span> emp group by post;</span><br><span class="line">+-----------------------------------+------------------------------------------------+</span><br><span class="line">| post                              | group_concat(name)                             |</span><br><span class="line">+-----------------------------------+------------------------------------------------+</span><br><span class="line">| NULL                              | o                                              |</span><br><span class="line">| operation                         | 程咬铁,程咬铜,程咬银,程咬金,张野               |</span><br><span class="line">| sale                              | 格格,星星,丁丁,丫丫,歪歪                       |</span><br><span class="line">| teacher                           | sean,大饼,jerry,owen,jason,kevin,egon          |</span><br><span class="line">| 张江第一帅形象代言部门            | tank                                           |</span><br><span class="line">+-----------------------------------+------------------------------------------------+</span><br><span class="line"><span class="number">5</span> rows <span class="keyword">in</span> set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 给每个部门的员工名字前 + NB_</span></span><br><span class="line">select post, group_concat(<span class="string">'NB_'</span>, name) <span class="keyword">from</span> emp group by post;</span><br><span class="line"><span class="comment"># 拼接部门员工名字+薪资</span></span><br><span class="line">select post, group_concat(name, <span class="string">":"</span>, salary) <span class="keyword">from</span> emp group by post;</span><br></pre></td></tr></table></figure>

<p><strong>补充:concat</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 4.补充concat（不分组时用）拼接字符串达到更好的显示效果 as语法并用</span></span><br><span class="line">select concat(<span class="string">'Name: '</span>, name) <span class="keyword">as</span> <span class="string">'名字'</span>, concat(<span class="string">'Sal: '</span>, salary) <span class="keyword">as</span> <span class="string">'薪资'</span> <span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt; select concat(<span class="string">'name: '</span>, name) <span class="keyword">as</span> <span class="string">'名字'</span>,concat(<span class="string">'sal: '</span>,salary) <span class="keyword">as</span> <span class="string">'薪资'</span> <span class="keyword">from</span> emp;</span><br><span class="line">+-----------------+-----------------+</span><br><span class="line">| 名字            | 薪资            |</span><br><span class="line">+-----------------+-----------------+</span><br><span class="line">| name: tank      | sal: <span class="number">7300.33</span>    |</span><br><span class="line">| name: egon      | sal: <span class="number">1000000.31</span> |</span><br><span class="line">| name: kevin     | sal: <span class="number">8300.00</span>    |</span><br><span class="line">| name: jason     | sal: <span class="number">3500.00</span>    |</span><br><span class="line">| name: owen      | sal: <span class="number">2100.00</span>    |</span><br><span class="line">| name: jerry     | sal: <span class="number">9000.00</span>    |</span><br><span class="line">| name: 大饼      | sal: <span class="number">30000.00</span>   |</span><br><span class="line">| name: sean      | sal: <span class="number">10000.00</span>   |</span><br><span class="line">| name: 歪歪      | sal: <span class="number">3000.13</span>    |</span><br><span class="line">| name: 丫丫      | sal: <span class="number">2000.35</span>    |</span><br><span class="line">| name: 丁丁      | sal: <span class="number">1000.37</span>    |</span><br><span class="line">| name: 星星      | sal: <span class="number">3000.29</span>    |</span><br><span class="line">| name: 格格      | sal: <span class="number">4000.33</span>    |</span><br><span class="line">| name: 张野      | sal: <span class="number">10000.13</span>   |</span><br><span class="line">| name: 程咬金    | sal: <span class="number">20000.00</span>   |</span><br><span class="line">| name: 程咬银    | sal: <span class="number">19000.00</span>   |</span><br><span class="line">| name: 程咬铜    | sal: <span class="number">18000.00</span>   |</span><br><span class="line">| name: 程咬铁    | sal: <span class="number">17000.00</span>   |</span><br><span class="line">| name: o         | NULL            |</span><br><span class="line">+-----------------+-----------------+</span><br><span class="line"><span class="number">19</span> rows <span class="keyword">in</span> set (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<h2 id="3-having-过滤"><a href="#3-having-过滤" class="headerlink" title="3.having(过滤)"></a>3.having(过滤)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>having与where语法一样，只不过having必需要在group by后使用;</span><br><span class="line"><span class="number">2.</span>where 不能使用聚合函数，但having可以;</span><br><span class="line"></span><br><span class="line">            - 书写顺序:</span><br><span class="line">                - select</span><br><span class="line">                - <span class="keyword">from</span></span><br><span class="line">                - where</span><br><span class="line">                - group by</span><br><span class="line">                - having</span><br><span class="line"></span><br><span class="line">            - 执行顺序:</span><br><span class="line">                - <span class="keyword">from</span></span><br><span class="line">                - where</span><br><span class="line">                - group by</span><br><span class="line">                - having</span><br><span class="line">                - select</span><br><span class="line"></span><br><span class="line"> <span class="number">1</span>、统计各 部门 年龄在<span class="number">30</span>岁以上的员工平均工资，并且保留平均工资大于<span class="number">10000</span>的部门;</span><br><span class="line">select post, avg(salary) <span class="keyword">from</span> emp where age &gt; <span class="number">30</span> group by post having avg(salary) &gt; <span class="number">10000</span>;</span><br><span class="line">mysql&gt;  select post, avg(salary) <span class="keyword">from</span> emp where age &gt; <span class="number">30</span> group by post having avg(salary) &gt; <span class="number">10000</span>;</span><br><span class="line">+---------+---------------+</span><br><span class="line">| post    | avg(salary)   |</span><br><span class="line">+---------+---------------+</span><br><span class="line">| teacher | <span class="number">255450.077500</span> |</span><br><span class="line">+---------+---------------+</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> set (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<h2 id="4-distinct-去重"><a href="#4-distinct-去重" class="headerlink" title="4.distinct(去重)"></a>4.distinct(去重)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># distinct: 去重</span></span><br><span class="line"></span><br><span class="line">- 书写顺序:</span><br><span class="line">         - select</span><br><span class="line">         - distinct</span><br><span class="line">         - <span class="keyword">from</span></span><br><span class="line">         - where</span><br><span class="line">         - group by</span><br><span class="line">         - having</span><br><span class="line"></span><br><span class="line">执行顺序:</span><br><span class="line">		- <span class="keyword">from</span></span><br><span class="line">		- where </span><br><span class="line">		- group by </span><br><span class="line">		- having</span><br><span class="line">		- select </span><br><span class="line">		- distinct</span><br><span class="line">        </span><br><span class="line"><span class="comment"># 注意: 查询的字段值必须是重复的才有效，只要有一个字段值是不重复的就没有效果。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 若所查字段内有不重复的字段记录就不会去重</span></span><br><span class="line">select distinct id, post <span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line">mysql&gt; select distinct id, post <span class="keyword">from</span> emp;</span><br><span class="line">+----+-----------------------------------+</span><br><span class="line">| id | post                              |</span><br><span class="line">+----+-----------------------------------+</span><br><span class="line">|  <span class="number">1</span> | 张江第一帅形象代言部门            |</span><br><span class="line">|  <span class="number">2</span> | teacher                           |</span><br><span class="line">|  <span class="number">3</span> | teacher                           |</span><br><span class="line">|  <span class="number">4</span> | teacher                           |</span><br><span class="line">|  <span class="number">5</span> | teacher                           |</span><br><span class="line">|  <span class="number">6</span> | teacher                           |</span><br><span class="line">|  <span class="number">7</span> | teacher                           |</span><br><span class="line">|  <span class="number">8</span> | teacher                           |</span><br><span class="line">|  <span class="number">9</span> | sale                              |</span><br><span class="line">| <span class="number">10</span> | sale                              |</span><br><span class="line">| <span class="number">11</span> | sale                              |</span><br><span class="line">| <span class="number">12</span> | sale                              |</span><br><span class="line">| <span class="number">13</span> | sale                              |</span><br><span class="line">| <span class="number">14</span> | operation                         |</span><br><span class="line">| <span class="number">15</span> | operation                         |</span><br><span class="line">| <span class="number">16</span> | operation                         |</span><br><span class="line">| <span class="number">17</span> | operation                         |</span><br><span class="line">| <span class="number">18</span> | operation                         |</span><br><span class="line">| <span class="number">19</span> | NULL                              |</span><br><span class="line">+----+-----------------------------------+</span><br><span class="line"><span class="number">19</span> rows <span class="keyword">in</span> set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">select distinct post <span class="keyword">from</span> emp;</span><br><span class="line"></span><br><span class="line">mysql&gt; select distinct post <span class="keyword">from</span> emp;</span><br><span class="line">+-----------------------------------+</span><br><span class="line">| post                              |</span><br><span class="line">+-----------------------------------+</span><br><span class="line">| 张江第一帅形象代言部门            |</span><br><span class="line">| teacher                           |</span><br><span class="line">| sale                              |</span><br><span class="line">| operation                         |</span><br><span class="line">| NULL                              |</span><br><span class="line">+-----------------------------------+</span><br><span class="line"><span class="number">5</span> rows <span class="keyword">in</span> set (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<h2 id="5-order-by-排序"><a href="#5-order-by-排序" class="headerlink" title="5.order by(排序)"></a>5.order by(排序)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">- 书写顺序:</span><br><span class="line">        - select</span><br><span class="line">        - <span class="keyword">from</span></span><br><span class="line">        - where</span><br><span class="line">        - group by</span><br><span class="line">        - having</span><br><span class="line">        - order by</span><br><span class="line"></span><br><span class="line">执行顺序:</span><br><span class="line">		- <span class="keyword">from</span></span><br><span class="line">		- where </span><br><span class="line">		- group by </span><br><span class="line">		- having </span><br><span class="line">		- select </span><br><span class="line">    - order by  <span class="comment"># 通过select 查出来的数据再进行排序</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># order by 默认升序</span></span><br><span class="line"><span class="comment"># asc升序</span></span><br><span class="line"><span class="comment"># desc降序</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 1、根据薪资进行升序</span></span><br><span class="line">select name, salary <span class="keyword">from</span> emp order by salary;  <span class="comment"># 默认升序</span></span><br><span class="line"></span><br><span class="line">mysql&gt; select name, salary <span class="keyword">from</span> emp order by salary;</span><br><span class="line">+-----------+------------+</span><br><span class="line">| name      | salary     |</span><br><span class="line">+-----------+------------+</span><br><span class="line">| o         |       NULL |</span><br><span class="line">| 丁丁      |    <span class="number">1000.37</span> |</span><br><span class="line">| 丫丫      |    <span class="number">2000.35</span> |</span><br><span class="line">| owen      |    <span class="number">2100.00</span> |</span><br><span class="line">| 歪歪      |    <span class="number">3000.13</span> |</span><br><span class="line">| 星星      |    <span class="number">3000.29</span> |</span><br><span class="line">| jason     |    <span class="number">3500.00</span> |</span><br><span class="line">| 格格      |    <span class="number">4000.33</span> |</span><br><span class="line">| tank      |    <span class="number">7300.33</span> |</span><br><span class="line">| kevin     |    <span class="number">8300.00</span> |</span><br><span class="line">| jerry     |    <span class="number">9000.00</span> |</span><br><span class="line">| sean      |   <span class="number">10000.00</span> |</span><br><span class="line">| 张野      |   <span class="number">10000.13</span> |</span><br><span class="line">| 程咬铁    |   <span class="number">17000.00</span> |</span><br><span class="line">| 程咬铜    |   <span class="number">18000.00</span> |</span><br><span class="line">| 程咬银    |   <span class="number">19000.00</span> |</span><br><span class="line">| 程咬金    |   <span class="number">20000.00</span> |</span><br><span class="line">| 大饼      |   <span class="number">30000.00</span> |</span><br><span class="line">| egon      | <span class="number">1000000.31</span> |</span><br><span class="line">+-----------+------------+</span><br><span class="line"><span class="number">19</span> rows <span class="keyword">in</span> set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>select * <span class="keyword">from</span> emp order by salary asc;  <span class="comment"># 指定升序</span></span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>select name, salary <span class="keyword">from</span> emp order by salary desc;  <span class="comment"># 指定降序</span></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">mysql&gt; select name, salary <span class="keyword">from</span> emp order by salary desc;</span><br><span class="line">+-----------+------------+</span><br><span class="line">| name      | salary     |</span><br><span class="line">+-----------+------------+</span><br><span class="line">| egon      | <span class="number">1000000.31</span> |</span><br><span class="line">| 大饼      |   <span class="number">30000.00</span> |</span><br><span class="line">| 程咬金    |   <span class="number">20000.00</span> |</span><br><span class="line">| 程咬银    |   <span class="number">19000.00</span> |</span><br><span class="line">| 程咬铜    |   <span class="number">18000.00</span> |</span><br><span class="line">| 程咬铁    |   <span class="number">17000.00</span> |</span><br><span class="line">| 张野      |   <span class="number">10000.13</span> |</span><br><span class="line">| sean      |   <span class="number">10000.00</span> |</span><br><span class="line">| jerry     |    <span class="number">9000.00</span> |</span><br><span class="line">| kevin     |    <span class="number">8300.00</span> |</span><br><span class="line">| tank      |    <span class="number">7300.33</span> |</span><br><span class="line">| 格格      |    <span class="number">4000.33</span> |</span><br><span class="line">| jason     |    <span class="number">3500.00</span> |</span><br><span class="line">| 星星      |    <span class="number">3000.29</span> |</span><br><span class="line">| 歪歪      |    <span class="number">3000.13</span> |</span><br><span class="line">| owen      |    <span class="number">2100.00</span> |</span><br><span class="line">| 丫丫      |    <span class="number">2000.35</span> |</span><br><span class="line">| 丁丁      |    <span class="number">1000.37</span> |</span><br><span class="line">| o         |       NULL |</span><br><span class="line">+-----------+------------+</span><br><span class="line"><span class="number">19</span> rows <span class="keyword">in</span> set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 先按照age升序，再按照salary降序</span></span><br><span class="line">select age, salary <span class="keyword">from</span> emp order by age asc, salary desc;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计 各部门(分组) 年龄在10岁以上的员工平均工资，并且保留平均工资大于1000的部门，然后对平均工资进行升序序</span></span><br><span class="line">select post, avg(salary) <span class="keyword">from</span> emp where age &gt; <span class="number">10</span> group by post having avg(salary) &gt; <span class="number">1000</span> order by avg(salary);</span><br></pre></td></tr></table></figure>

<h2 id="9-limit-限制查询记录的数量"><a href="#9-limit-限制查询记录的数量" class="headerlink" title="9.limit(限制查询记录的数量)"></a>9.limit(限制查询记录的数量)</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"> 书写顺序:</span><br><span class="line">                - select</span><br><span class="line">                - <span class="keyword">from</span></span><br><span class="line">                - order by</span><br><span class="line">                - limit</span><br><span class="line"></span><br><span class="line">            执行顺序:</span><br><span class="line">                - <span class="keyword">from</span></span><br><span class="line">                - select</span><br><span class="line">                - order by</span><br><span class="line">                - limit</span><br><span class="line"></span><br><span class="line">                </span><br><span class="line">                </span><br><span class="line"><span class="comment"># 1、从第一条开始，获取4条记录;</span></span><br><span class="line">select * <span class="keyword">from</span> emp limit <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> emp limit <span class="number">4</span>;</span><br><span class="line">+----+-------+------+-----+------------+-----------------------------------+--------------+------------+--------+-----------+</span><br><span class="line">| id | name  | sex  | age | hire_date  | post                              | post_comment | salary     | office | depart_id |</span><br><span class="line">+----+-------+------+-----+------------+-----------------------------------+--------------+------------+--------+-----------+</span><br><span class="line">|  <span class="number">1</span> | tank  | male |  <span class="number">17</span> | <span class="number">2017</span><span class="number">-03</span><span class="number">-01</span> | 张江第一帅形象代言部门            | NULL         |    <span class="number">7300.33</span> |    <span class="number">401</span> |         <span class="number">1</span> |</span><br><span class="line">|  <span class="number">2</span> | egon  | male |  <span class="number">78</span> | <span class="number">2015</span><span class="number">-03</span><span class="number">-02</span> | teacher                           | NULL         | <span class="number">1000000.31</span> |    <span class="number">401</span> |         <span class="number">1</span> |</span><br><span class="line">|  <span class="number">3</span> | kevin | male |  <span class="number">81</span> | <span class="number">2013</span><span class="number">-03</span><span class="number">-05</span> | teacher                           | NULL         |    <span class="number">8300.00</span> |    <span class="number">401</span> |         <span class="number">1</span> |</span><br><span class="line">|  <span class="number">4</span> | jason | male |  <span class="number">73</span> | <span class="number">2014</span><span class="number">-07</span><span class="number">-01</span> | teacher                           | NULL         |    <span class="number">3500.00</span> |    <span class="number">401</span> |         <span class="number">1</span> |</span><br><span class="line">+----+-------+------+-----+------------+-----------------------------------+--------------+------------+--------+-----------+</span><br><span class="line"><span class="number">4</span> rows <span class="keyword">in</span> set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2、limit可以有两个参数, 参数1:是限制的开始位置, 参数2:是从开始位置展示的条数;</span></span><br><span class="line">select * <span class="keyword">from</span> emp limit <span class="number">0</span>, <span class="number">4</span>;</span><br><span class="line">select * <span class="keyword">from</span> emp limit <span class="number">4</span>, <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> emp limit <span class="number">4</span>, <span class="number">4</span>;</span><br><span class="line">+----+--------+--------+-----+------------+---------+--------------+----------+--------+-----------+</span><br><span class="line">| id | name   | sex    | age | hire_date  | post    | post_comment | salary   | office | depart_id |</span><br><span class="line">+----+--------+--------+-----+------------+---------+--------------+----------+--------+-----------+</span><br><span class="line">|  <span class="number">5</span> | owen   | male   |  <span class="number">28</span> | <span class="number">2012</span><span class="number">-11</span><span class="number">-01</span> | teacher | NULL         |  <span class="number">2100.00</span> |    <span class="number">401</span> |         <span class="number">1</span> |</span><br><span class="line">|  <span class="number">6</span> | jerry  | female |  <span class="number">18</span> | <span class="number">2011</span><span class="number">-02</span><span class="number">-11</span> | teacher | NULL         |  <span class="number">9000.00</span> |    <span class="number">401</span> |         <span class="number">1</span> |</span><br><span class="line">|  <span class="number">7</span> | 大饼   | male   |  <span class="number">18</span> | <span class="number">1900</span><span class="number">-03</span><span class="number">-01</span> | teacher | NULL         | <span class="number">30000.00</span> |    <span class="number">401</span> |         <span class="number">1</span> |</span><br><span class="line">|  <span class="number">8</span> | sean   | male   |  <span class="number">48</span> | <span class="number">2010</span><span class="number">-11</span><span class="number">-11</span> | teacher | NULL         | <span class="number">10000.00</span> |    <span class="number">401</span> |         <span class="number">1</span> |</span><br><span class="line">+----+--------+--------+-----+------------+---------+--------------+----------+--------+-----------+</span><br><span class="line"><span class="number">4</span> rows <span class="keyword">in</span> set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3、查询工资最高的人的详细信息</span></span><br><span class="line">select * <span class="keyword">from</span> emp order by salary limit <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> emp order by salary limit <span class="number">1</span>;</span><br><span class="line">+----+------+------+-----+------------+------+--------------+--------+--------+-----------+</span><br><span class="line">| id | name | sex  | age | hire_date  | post | post_comment | salary | office | depart_id |</span><br><span class="line">+----+------+------+-----+------------+------+--------------+--------+--------+-----------+</span><br><span class="line">| <span class="number">19</span> | o    | male |  <span class="number">28</span> | <span class="number">0000</span><span class="number">-00</span><span class="number">-00</span> | NULL | NULL         |   NULL |   NULL |      NULL |</span><br><span class="line">+----+------+------+-----+------------+------+--------------+--------+--------+-----------+</span><br><span class="line"><span class="number">1</span> row <span class="keyword">in</span> set (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<h2 id="10-正则"><a href="#10-正则" class="headerlink" title="10.正则"></a>10.正则</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在编程中，凡是看到reg开头的，基本上都是跟正则有关</span></span><br><span class="line">  <span class="comment"># *: 代表 0 或 多个</span></span><br><span class="line">select * <span class="keyword">from</span> emp where name regexp <span class="string">'^程.*(金|银|铜|铁)$'</span>;</span><br><span class="line"></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> emp where name regexp <span class="string">'^程.*(金|银|铜|铁)$'</span>;</span><br><span class="line">+----+-----------+--------+-----+------------+-----------+--------------+----------+--------+-----------+</span><br><span class="line">| id | name      | sex    | age | hire_date  | post      | post_comment | salary   | office | depart_id |</span><br><span class="line">+----+-----------+--------+-----+------------+-----------+--------------+----------+--------+-----------+</span><br><span class="line">| <span class="number">15</span> | 程咬金    | male   |  <span class="number">18</span> | <span class="number">1997</span><span class="number">-03</span><span class="number">-12</span> | operation | NULL         | <span class="number">20000.00</span> |    <span class="number">403</span> |         <span class="number">3</span> |</span><br><span class="line">| <span class="number">16</span> | 程咬银    | female |  <span class="number">18</span> | <span class="number">2013</span><span class="number">-03</span><span class="number">-11</span> | operation | NULL         | <span class="number">19000.00</span> |    <span class="number">403</span> |         <span class="number">3</span> |</span><br><span class="line">| <span class="number">17</span> | 程咬铜    | male   |  <span class="number">18</span> | <span class="number">2015</span><span class="number">-04</span><span class="number">-11</span> | operation | NULL         | <span class="number">18000.00</span> |    <span class="number">403</span> |         <span class="number">3</span> |</span><br><span class="line">| <span class="number">18</span> | 程咬铁    | female |  <span class="number">18</span> | <span class="number">2014</span><span class="number">-05</span><span class="number">-12</span> | operation | NULL         | <span class="number">17000.00</span> |    <span class="number">403</span> |         <span class="number">3</span> |</span><br><span class="line">+----+-----------+--------+-----+------------+-----------+--------------+----------+--------+-----------+</span><br><span class="line"><span class="number">4</span> rows <span class="keyword">in</span> set (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<h1 id="三-多表查询"><a href="#三-多表查询" class="headerlink" title="三.多表查询"></a>三.多表查询</h1><p>多表查询</p>
<p>-关联查询</p>
<p>-子查询</p>
<p><strong>创建表与插入数据准备</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#建表</span></span><br><span class="line">create table dep2(</span><br><span class="line">id int,</span><br><span class="line">name varchar(<span class="number">20</span>) </span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">create table emp2(</span><br><span class="line">id int primary key auto_increment,</span><br><span class="line">name varchar(<span class="number">20</span>),</span><br><span class="line">sex enum(<span class="string">'male'</span>,<span class="string">'female'</span>) <span class="keyword">not</span> null default <span class="string">'male'</span>,</span><br><span class="line">age int,</span><br><span class="line">dep_id int</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">#插入数据</span></span><br><span class="line">insert into dep2 values</span><br><span class="line">(<span class="number">200</span>,<span class="string">'技术'</span>),</span><br><span class="line">(<span class="number">201</span>,<span class="string">'人力资源'</span>),</span><br><span class="line">(<span class="number">202</span>,<span class="string">'销售'</span>),</span><br><span class="line">(<span class="number">203</span>,<span class="string">'运营'</span>);</span><br><span class="line"></span><br><span class="line">insert into emp2(name,sex,age,dep_id) values</span><br><span class="line">(<span class="string">'tank'</span>,<span class="string">'male'</span>,<span class="number">17</span>,<span class="number">200</span>),</span><br><span class="line">(<span class="string">'egon'</span>,<span class="string">'female'</span>,<span class="number">48</span>,<span class="number">201</span>),</span><br><span class="line">(<span class="string">'kevin'</span>,<span class="string">'male'</span>,<span class="number">38</span>,<span class="number">201</span>),</span><br><span class="line">(<span class="string">'jason'</span>,<span class="string">'female'</span>,<span class="number">28</span>,<span class="number">202</span>),</span><br><span class="line">(<span class="string">'owen'</span>,<span class="string">'male'</span>,<span class="number">18</span>,<span class="number">200</span>),</span><br><span class="line">(<span class="string">'sean'</span>,<span class="string">'female'</span>,<span class="number">18</span>,<span class="number">204</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> dep2;</span><br><span class="line">+------+--------------+</span><br><span class="line">| id   | name         |</span><br><span class="line">+------+--------------+</span><br><span class="line">|  <span class="number">200</span> | 技术         |</span><br><span class="line">|  <span class="number">201</span> | 人力资源     |</span><br><span class="line">|  <span class="number">202</span> | 销售         |</span><br><span class="line">|  <span class="number">203</span> | 运营         |</span><br><span class="line">+------+--------------+</span><br><span class="line"><span class="number">4</span> rows <span class="keyword">in</span> set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> emp2;</span><br><span class="line">+----+-------+--------+------+--------+</span><br><span class="line">| id | name  | sex    | age  | dep_id |</span><br><span class="line">+----+-------+--------+------+--------+</span><br><span class="line">|  <span class="number">1</span> | tank  | male   |   <span class="number">17</span> |    <span class="number">200</span> |</span><br><span class="line">|  <span class="number">2</span> | egon  | female |   <span class="number">48</span> |    <span class="number">201</span> |</span><br><span class="line">|  <span class="number">3</span> | kevin | male   |   <span class="number">38</span> |    <span class="number">201</span> |</span><br><span class="line">|  <span class="number">4</span> | jason | female |   <span class="number">28</span> |    <span class="number">202</span> |</span><br><span class="line">|  <span class="number">5</span> | owen  | male   |   <span class="number">18</span> |    <span class="number">200</span> |</span><br><span class="line">|  <span class="number">6</span> | sean  | female |   <span class="number">18</span> |    <span class="number">204</span> |</span><br><span class="line">+----+-------+--------+------+--------+</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指到了如何根据表关系对字段进行拆分，目的是为了更好的管理，表数据都存放在硬盘中，存不是目的，目的是为了取，所以我们将数据从硬盘读到内存中，接下来我们因应该将他们拼成一张表来查询更加合理;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意: 将拆分的表，再拼接到一起进行查询, 可以通过一张表查另一张表的数据;</span></span><br></pre></td></tr></table></figure>

<h2 id="1-关联查询"><a href="#1-关联查询" class="headerlink" title="1.关联查询"></a>1.关联查询</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 左表的一条记录与右表的一条记录都对应一遍称之为 --&gt; "笛卡尔积"   PS: 百度科普</span></span><br><span class="line"><span class="comment"># 将所有的数据都对应了一遍，虽然不合理但是其中有合理的数据，现在我们需要做的就是找出合理的数据</span></span><br><span class="line">举例:通过之前准备的数据进行多表操作</span><br><span class="line">    </span><br><span class="line"><span class="number">1</span>、查询 员工 以及所在 部门 的信息;</span><br><span class="line"><span class="comment"># 通过where 约束条件</span></span><br><span class="line">select * <span class="keyword">from</span> emp2, dep2 where emp2.dep_id = dep2.id;</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、查询 部门 为 技术部 的 员工 及 部门信息</span><br><span class="line"></span><br><span class="line">select * <span class="keyword">from</span> emp2, dep2 where emp2.dep_id = dep2.id <span class="keyword">and</span> dep2.name = <span class="string">'技术'</span>;</span><br><span class="line">联表查询:</span><br><span class="line">   -内链接:只去两张表有对应关系的记录</span><br><span class="line">select * <span class="keyword">from</span> emp2 inner join dep2 on emp2.dep_id = dep2.id;</span><br><span class="line"></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> emp2 inner join dep2 on emp2.dep_id = dep2.id;</span><br><span class="line">+----+-------+--------+------+--------+------+--------------+</span><br><span class="line">| id | name  | sex    | age  | dep_id | id   | name         |</span><br><span class="line">+----+-------+--------+------+--------+------+--------------+</span><br><span class="line">|  <span class="number">1</span> | tank  | male   |   <span class="number">17</span> |    <span class="number">200</span> |  <span class="number">200</span> | 技术         |</span><br><span class="line">|  <span class="number">2</span> | egon  | female |   <span class="number">48</span> |    <span class="number">201</span> |  <span class="number">201</span> | 人力资源     |</span><br><span class="line">|  <span class="number">3</span> | kevin | male   |   <span class="number">38</span> |    <span class="number">201</span> |  <span class="number">201</span> | 人力资源     |</span><br><span class="line">|  <span class="number">4</span> | jason | female |   <span class="number">28</span> |    <span class="number">202</span> |  <span class="number">202</span> | 销售         |</span><br><span class="line">|  <span class="number">5</span> | owen  | male   |   <span class="number">18</span> |    <span class="number">200</span> |  <span class="number">200</span> | 技术         |</span><br><span class="line">+----+-------+--------+------+--------+------+--------------+</span><br><span class="line"><span class="number">5</span> rows <span class="keyword">in</span> set (<span class="number">0.05</span> sec)</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、left join</span><br><span class="line"><span class="comment"># 2、左连接: 在内连接的基础上保留左表没有对应关系的记录(以null补全)</span></span><br><span class="line">select * <span class="keyword">from</span> emp2 left join dep2 on emp2.dep_id = dep2.id;</span><br><span class="line"></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> emp2 left join dep2 on emp2.dep_id = dep2.id;</span><br><span class="line">+----+-------+--------+------+--------+------+--------------+</span><br><span class="line">| id | name  | sex    | age  | dep_id | id   | name         |</span><br><span class="line">+----+-------+--------+------+--------+------+--------------+</span><br><span class="line">|  <span class="number">1</span> | tank  | male   |   <span class="number">17</span> |    <span class="number">200</span> |  <span class="number">200</span> | 技术         |</span><br><span class="line">|  <span class="number">5</span> | owen  | male   |   <span class="number">18</span> |    <span class="number">200</span> |  <span class="number">200</span> | 技术         |</span><br><span class="line">|  <span class="number">2</span> | egon  | female |   <span class="number">48</span> |    <span class="number">201</span> |  <span class="number">201</span> | 人力资源     |</span><br><span class="line">|  <span class="number">3</span> | kevin | male   |   <span class="number">38</span> |    <span class="number">201</span> |  <span class="number">201</span> | 人力资源     |</span><br><span class="line">|  <span class="number">4</span> | jason | female |   <span class="number">28</span> |    <span class="number">202</span> |  <span class="number">202</span> | 销售         |</span><br><span class="line">|  <span class="number">6</span> | sean  | female |   <span class="number">18</span> |    <span class="number">204</span> | NULL | NULL         |</span><br><span class="line">+----+-------+--------+------+--------+------+--------------+</span><br><span class="line"></span><br><span class="line">   </span><br><span class="line"><span class="comment"># 3、右连接: 在内连接的基础上保留右表没有对应关系的记录</span></span><br><span class="line">select * <span class="keyword">from</span> emp2 right join dep2 on emp2.dep_id = dep2.id;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt; select * <span class="keyword">from</span> emp2 right join dep2 on emp2.dep_id = dep2.id;</span><br><span class="line">+------+-------+--------+------+--------+------+--------------+</span><br><span class="line">| id   | name  | sex    | age  | dep_id | id   | name         |</span><br><span class="line">+------+-------+--------+------+--------+------+--------------+</span><br><span class="line">|    <span class="number">1</span> | tank  | male   |   <span class="number">17</span> |    <span class="number">200</span> |  <span class="number">200</span> | 技术         |</span><br><span class="line">|    <span class="number">2</span> | egon  | female |   <span class="number">48</span> |    <span class="number">201</span> |  <span class="number">201</span> | 人力资源     |</span><br><span class="line">|    <span class="number">3</span> | kevin | male   |   <span class="number">38</span> |    <span class="number">201</span> |  <span class="number">201</span> | 人力资源     |</span><br><span class="line">|    <span class="number">4</span> | jason | female |   <span class="number">28</span> |    <span class="number">202</span> |  <span class="number">202</span> | 销售         |</span><br><span class="line">|    <span class="number">5</span> | owen  | male   |   <span class="number">18</span> |    <span class="number">200</span> |  <span class="number">200</span> | 技术         |</span><br><span class="line">| NULL | NULL  | NULL   | NULL |   NULL |  <span class="number">203</span> | 运营         |</span><br><span class="line">+------+-------+--------+------+--------+------+--------------+</span><br><span class="line"><span class="number">6</span> rows <span class="keyword">in</span> set (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- 全连接: union</span><br><span class="line"><span class="comment"># 4、全连接: 在内连接的基础上 保留左、右表没有对应关系的记录</span></span><br><span class="line">select * <span class="keyword">from</span> emp2 left join dep2 on emp2.dep_id = dep2.id </span><br><span class="line">union </span><br><span class="line">select * <span class="keyword">from</span> emp2 right join dep2 on emp2.dep_id = dep2.id;</span><br></pre></td></tr></table></figure>

<h2 id="2-子查询"><a href="#2-子查询" class="headerlink" title="2.子查询"></a>2.子查询</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 子查询就是将一个查询语句的结果用括号括起来，当做另一个查询语句的条件去用</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询部门是技术或者人力资源的员工信息</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">先获取技术部和人力资源的id号，再去员工表里根据前面的id筛选出符合要求的员工信息;</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">select * <span class="keyword">from</span> emp2 where dep_id <span class="keyword">in</span> (select id <span class="keyword">from</span> dep2 where name=<span class="string">'技术'</span> <span class="keyword">or</span> name=<span class="string">'人力资源'</span>);</span><br><span class="line"></span><br><span class="line"> <span class="comment"># 2.每个部门最新入职的员工 思路：先查每个部门最新入职的员工，再按部门对应上联表查询</span></span><br><span class="line"> <span class="comment"># 查第一张emp表</span></span><br><span class="line"><span class="comment"># 第四步</span></span><br><span class="line">select t1.id, t1.name, t1.hire_date, t2.*</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line"><span class="comment"># 第二步</span></span><br><span class="line"><span class="comment"># 拼接了 t1（emp） 与 t2（各部门最新入职的员工数据虚拟表）表的数据</span></span><br><span class="line"></span><br><span class="line">emp <span class="keyword">as</span> t1</span><br><span class="line">inner join</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第一步</span></span><br><span class="line"><span class="comment"># 子查询获取emp表中的  部门名称与最新入职的时间字段值 生成一张虚拟表</span></span><br><span class="line">(select post, max(hire_date) <span class="keyword">as</span> max_date <span class="keyword">from</span> emp group by post) <span class="keyword">as</span> t2</span><br><span class="line">on</span><br><span class="line"><span class="comment"># 若 t1.post 的值与 t2.post 条件成立，则拼接对应的记录;</span></span><br><span class="line">t1.post = t2.post</span><br><span class="line"><span class="comment"># 第三步</span></span><br><span class="line">where t1.hire_date = t2.max_date;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/11/16/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/" data-id="ckd3cw4gv0000rcut3lhe69hg" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MySQL/" rel="tag">MySQL</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-MySQL数据库的字段类型和约束条件" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/11/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%AD%97%E6%AE%B5%E7%B1%BB%E5%9E%8B%E5%92%8C%E7%BA%A6%E6%9D%9F%E6%9D%A1%E4%BB%B6/" class="article-date">
  <time datetime="2018-11-11T13:52:12.000Z" itemprop="datePublished">2018-11-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/11/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%AD%97%E6%AE%B5%E7%B1%BB%E5%9E%8B%E5%92%8C%E7%BA%A6%E6%9D%9F%E6%9D%A1%E4%BB%B6/">MySQL数据库的字段类型和约束条件</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="一-存储引擎"><a href="#一-存储引擎" class="headerlink" title="一.存储引擎"></a>一.存储引擎</h2><p> 存储引擎是用于根据不同的机制处理不同的数据。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">查看mysql中所有引擎:    </span><br><span class="line">- show engines;</span><br></pre></td></tr></table></figure>

<p><img src="https://user-images.githubusercontent.com/57135669/88484815-26288f80-cfa4-11ea-912d-dba1760dc6cd.png" alt="数据库4"></p>
<ul>
<li><p>innodb:默认存储引擎,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">支持事物,支持行锁,支持外键</span><br></pre></td></tr></table></figure>
</li>
<li><p>myisam: MySQL老版本在用的存储引擎</p>
</li>
<li><p>blackhole: 黑洞,存任何数据，都会立即消失，相当于经过队列，数据存入就会被取走</p>
<ul>
<li><p>memory: 内存引擎(数据存放在内存中,断电即消失,即关闭服务端)</p>
<p>举例说明四种不同的存储引擎</p>
<ul>
<li>插入四种不同的存储引擎</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- create table t1(id int)engine=innodb;</span><br><span class="line">- create table t2(id int)engine=myisam;</span><br><span class="line">- create table t3(id int)engine=blackhole;</span><br><span class="line">- create table t4(id int)engine=memory;</span><br></pre></td></tr></table></figure>

<ul>
<li>插入数据并查表内容</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- insert into t1 values(<span class="number">1</span>);</span><br><span class="line">	 select * <span class="keyword">from</span> t1;</span><br><span class="line">- insert into t2 values(<span class="number">1</span>);</span><br><span class="line">	 select * <span class="keyword">from</span> t2;</span><br><span class="line">- insert into t3 values(<span class="number">1</span>);</span><br><span class="line">	 select * <span class="keyword">from</span> t3;</span><br><span class="line">- insert into t4 values(<span class="number">1</span>);</span><br><span class="line">	 select * <span class="keyword">from</span> t4;这个需要内存中还有，需要关掉服务端才能销毁清除。</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h2 id="二-创建表完整的语法"><a href="#二-创建表完整的语法" class="headerlink" title="二.创建表完整的语法"></a>二.创建表完整的语法</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">create table 表名(字段名<span class="number">1</span> 字段类型(宽度) 约束条件,字段名<span class="number">2</span> 字段类型(宽度) 约束条件);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 宽度指对存储数据的限制</span></span><br><span class="line">create table userinfo(name char);</span><br><span class="line">insert into userinfo values(<span class="string">'tank'</span>);</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">1)没有安全模式的数据库版本，能够存放数据但只存存进去一个t。</span></span><br><span class="line"><span class="string">2)最新数据的版本直接报错提示无法储存: Data too long for column 'name'</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 约束条件非必须,可有可无</span></span><br><span class="line">例如null和<span class="keyword">not</span> null</span><br><span class="line">create table t1(id int, name char <span class="keyword">not</span> null)</span><br><span class="line"><span class="comment"># 正常存储</span></span><br><span class="line">insert into t1 values(<span class="number">1</span>, <span class="string">'tank'</span>);</span><br><span class="line"><span class="comment"># 错误存储</span></span><br><span class="line">insert into t1 values(<span class="number">2</span>, null);</span><br><span class="line"><span class="comment">#报错信息:ERROR 1048 (23000): Column 'name' cannot be null</span></span><br></pre></td></tr></table></figure>

<p>总结:</p>
<ul>
<li>创建表的时候字段名不能重复</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">create table test(</span><br><span class="line">               id int,</span><br><span class="line">               id int</span><br><span class="line">           );</span><br></pre></td></tr></table></figure>

<ul>
<li>最后一个字段不能在末尾加逗号</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">create table test(</span><br><span class="line">               id int,</span><br><span class="line">               age int,</span><br><span class="line">           );</span><br></pre></td></tr></table></figure>

<ul>
<li>字段名必须有字段类型与宽度</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">create table test(</span><br><span class="line">                id int,</span><br><span class="line">                name char</span><br><span class="line">            );</span><br><span class="line">            insert into test values(<span class="number">1</span>, <span class="string">'tank'</span>);</span><br><span class="line"></span><br><span class="line">            alter table test modify name char(<span class="number">4</span>);</span><br><span class="line">            insert into test values(<span class="number">2</span>, <span class="string">'sean'</span>);</span><br></pre></td></tr></table></figure>

<h2 id="三-字段类型"><a href="#三-字段类型" class="headerlink" title="三.字段类型"></a>三.字段类型</h2><ul>
<li>确定表结构</li>
<li>字段与字段类型</li>
</ul>
<h2 id="补充-设置严格模式"><a href="#补充-设置严格模式" class="headerlink" title="补充:设置严格模式"></a>补充:设置严格模式</h2><p>在一些低版本的mysql里面,即时输入的数据不符合规格,也会存入进字段里面,所以可以通过设置严格模式来解决这个问题</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看数据库配置中变量名包含mode的配置参数:</span></span><br><span class="line">show variables like <span class="string">"%mode%"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改安全模式:</span></span><br><span class="line">set session;  <span class="comment"># 局部有效，只在你当前操作的窗口有效</span></span><br><span class="line">set <span class="keyword">global</span> session;  <span class="comment"># 全局有效，永久有效</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改严格模式,以管理员修改完之后退出当前客户端重新登录即可</span></span><br><span class="line">set <span class="keyword">global</span> sql_mode = <span class="string">'STRICT_TRANS_TABLES'</span>;</span><br></pre></td></tr></table></figure>

<h3 id="1-整型"><a href="#1-整型" class="headerlink" title="1)整型"></a>1)整型</h3><ul>
<li>分类:tinyint、smallint、mediumint、int、bigint</li>
<li>应用场景: 存储年龄,等级,id,号码等</li>
<li>典型存储范围</li>
</ul>
<p><img src="https://user-images.githubusercontent.com/57135669/88484819-2c1e7080-cfa4-11ea-806b-aaf24ea9e89b.png" alt="数据库5"></p>
<ul>
<li>验证整型字段有无符号及范围</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># TINYINT  tinyint范围( -128, 127)</span></span><br><span class="line"><span class="number">1</span>)默认有正负符号限制</span><br><span class="line">create table t2(id TINYINT);</span><br><span class="line">desc t2;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 超出限制, 插不进去,低版本设置严格模式后会报错,不设置严格模式进去会被自动修改数值为-128或127</span></span><br><span class="line">insert into t2 values(<span class="number">-129</span>), (<span class="number">256</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 默认范围是(-128, 127)</span></span><br><span class="line">insert into t2 values(<span class="number">-128</span>), (<span class="number">127</span>);</span><br><span class="line"></span><br><span class="line">select * <span class="keyword">from</span> t2;</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>) 无正负符号限制: unsigne</span><br><span class="line">create table t3(number tinyint unsigned);</span><br><span class="line"><span class="comment"># 输入负号或超出范围都会报错</span></span><br><span class="line">insert into t3 values(<span class="number">-10</span>);  </span><br><span class="line">insert into t3 values(<span class="number">127</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># INT: int默认最大展示的位数是11位</span></span><br><span class="line">create table t4(id int);</span><br><span class="line"><span class="comment"># 默认范围是(-2147483648， 2147483647)</span></span><br><span class="line">insert into t4 values(<span class="number">-2147483648</span>), (<span class="number">2147483647</span>);</span><br><span class="line"><span class="comment"># 超出默认范围,报错</span></span><br><span class="line">insert into t4 values(<span class="number">-2147483648</span>), (<span class="number">122412451251251</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 问题: 整型后的宽度能否改变字段存储的大小？</span></span><br><span class="line"><span class="comment"># create table t5(number int(10));</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># int(8)不是限制长度，而是控制展示数据的位数，8位以内以空格补全，超出则正常显示。</span></span><br><span class="line">create table t5(id int(<span class="number">8</span>));</span><br><span class="line">insert into t5 values(<span class="number">2147483647</span>);</span><br><span class="line">select * <span class="keyword">from</span> t5;</span><br><span class="line">+------------+</span><br><span class="line">| id         |</span><br><span class="line">+------------+</span><br><span class="line">| <span class="number">2147483647</span> |</span><br><span class="line">|      <span class="number">21474</span> |</span><br><span class="line">+------------+</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示不够8位用0补全, 并且只能插入无符号的值</span></span><br><span class="line">create table t6(id int(<span class="number">8</span>) unsigned zerofill);</span><br><span class="line">+----------+</span><br><span class="line">| id       |</span><br><span class="line">+----------+</span><br><span class="line">| <span class="number">42949672</span> |</span><br><span class="line">| <span class="number">00429496</span> |</span><br><span class="line">+----------+</span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">总结:</span></span><br><span class="line"><span class="string">		- 注意1:</span></span><br><span class="line"><span class="string">			- not null: 字段值不能为空</span></span><br><span class="line"><span class="string">			- unsigned: 无正负符号</span></span><br><span class="line"><span class="string">			- zerofill: 不够以0填充空格</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure>

<h3 id="2-浮点型"><a href="#2-浮点型" class="headerlink" title="2)浮点型:"></a>2)浮点型:</h3><ul>
<li>分类: float、double、 decimal</li>
<li>应用场景: 身高、体重、薪资</li>
<li>三者最大的区别是存储精确度不一样</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">注意: 字段限制特点(<span class="number">5</span>,<span class="number">3</span>)前一位表示所有的位数,后一位表示小数个数。</span><br><span class="line">    <span class="comment"># 存储限制:</span></span><br><span class="line">	- float(<span class="number">255</span>, <span class="number">30</span>)</span><br><span class="line">	- double(<span class="number">255</span>, <span class="number">30</span>)</span><br><span class="line">	- decimal(<span class="number">65</span>, <span class="number">30</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 精确度验证:</span></span><br><span class="line">create table t7(x float(<span class="number">255</span>, <span class="number">30</span>));</span><br><span class="line">create table t8(x double(<span class="number">255</span>, <span class="number">30</span>));</span><br><span class="line">create table t9(x decimal(<span class="number">65</span>, <span class="number">30</span>));</span><br><span class="line"></span><br><span class="line">insert into t7 values(<span class="number">1.1111111111111111111111111111</span>);</span><br><span class="line"><span class="string">''' </span></span><br><span class="line"><span class="string">mysql&gt; select *from t7;</span></span><br><span class="line"><span class="string">+----------------------------------+</span></span><br><span class="line"><span class="string">| x                                |</span></span><br><span class="line"><span class="string">+----------------------------------+</span></span><br><span class="line"><span class="string">| 1.111111164093017600000000000000 |</span></span><br><span class="line"><span class="string">+----------------------------------+</span></span><br><span class="line"><span class="string">1 row in set (0.00 sec)</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">insert into t8 values(<span class="number">1.1111111111111111111111111111</span>);</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mysql&gt; select *from t8;</span></span><br><span class="line"><span class="string">+----------------------------------+</span></span><br><span class="line"><span class="string">| x                                |</span></span><br><span class="line"><span class="string">+----------------------------------+</span></span><br><span class="line"><span class="string">| 1.111111111111111200000000000000 |</span></span><br><span class="line"><span class="string">+----------------------------------+</span></span><br><span class="line"><span class="string">1 row in set (0.00 sec)</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">insert into t9 values(<span class="number">1.1111111111111111111111111111</span>);</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">mysql&gt; select *from t9;</span></span><br><span class="line"><span class="string">+----------------------------------+</span></span><br><span class="line"><span class="string">| x                                |</span></span><br><span class="line"><span class="string">+----------------------------------+</span></span><br><span class="line"><span class="string">| 1.111111111111111111111111111100 |</span></span><br><span class="line"><span class="string">+----------------------------------+</span></span><br><span class="line"><span class="string">1 row in set (0.00 sec)</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">总结:三种浮点型的精确度不一样,最好的是decimal,但是float也够用了</span><br></pre></td></tr></table></figure>

<h3 id="3-字符类型"><a href="#3-字符类型" class="headerlink" title="3)字符类型"></a>3)字符类型</h3><ul>
<li><p>分类：varchar 、char</p>
</li>
<li><p>应用场景: 姓名、地址、描述信息</p>
<p><strong>1)char:定长字符</strong></p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 超出四个字符报错，不够四个字符空格补全</span></span><br><span class="line">create table t10(name char(<span class="number">4</span>));</span><br><span class="line"></span><br><span class="line">insert into t10 values(<span class="string">'tank'</span>);</span><br><span class="line">insert into t10 values(<span class="string">'lol'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 报错</span></span><br><span class="line">insert into t10 values(<span class="string">'hello'</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">优点:</span><br><span class="line">	存取速度快</span><br><span class="line">缺点:</span><br><span class="line">	浪费空间。</span><br><span class="line">insert into t11 values(<span class="number">1</span>, <span class="string">'t'</span>); <span class="comment"># t+三个空格</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意: 无法查看字符真实长度</span></span><br><span class="line"><span class="comment"># 针对char类型，mysql在存储时会将数据用空格补全存放到硬盘中。但是会在读出结果的时候自动去掉末尾的空格。</span></span><br></pre></td></tr></table></figure>

<p> <strong>2)varchar: 不定长</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">- 存几个字符，就是几个字符的大小，每个字符前都要+<span class="number">1</span>bytes</span><br><span class="line">create table t11(name varchar(<span class="number">4</span>));</span><br><span class="line"></span><br><span class="line">- insert into t11 values(<span class="string">'tank'</span>);</span><br><span class="line">insert into t11 values(<span class="string">'lol'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 报错</span></span><br><span class="line">insert into t10 values(<span class="string">'hello'</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">优点:</span><br><span class="line">	节省空间</span><br><span class="line">缺点:</span><br><span class="line">	存取速度慢</span><br></pre></td></tr></table></figure>

<h3 id="4）日期类型"><a href="#4）日期类型" class="headerlink" title="4）日期类型"></a>4）日期类型</h3><ul>
<li>分类:<ul>
<li>date: 2019-12-10</li>
<li>time: 11:11:11</li>
<li>datetime: 2019-12-10 11:11:11</li>
<li>year: 2019</li>
<li>timestamp:时间戳</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 建立表格</span></span><br><span class="line">create table teacher1(id int, name varchar(<span class="number">16</span>),born_year year,brith date,work_time time,register_time datetime, local_time timestamp);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 插入记录:</span></span><br><span class="line">insert into teacher1 values(<span class="number">1</span>,<span class="string">'tank'</span>,<span class="string">'2000'</span>,<span class="string">'2000-12-12'</span>,<span class="string">'12:11:10'</span>,<span class="string">'2000-12-12 11:11:11'</span>,null);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 时间戳可以用null代替</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意:插入时间需要以字符串格式</span></span><br></pre></td></tr></table></figure>

<p>表的内容:</p>
<p>mysql&gt; select *from teacher1;<br>+——+——+———–+————+———–+———————+———————+</p>
<table>
<thead>
<tr>
<th align="left">id</th>
<th align="left">name</th>
<th align="left">born_year</th>
<th align="left">brith</th>
<th align="left">work_time</th>
<th align="left">register_time</th>
<th align="left">local_time</th>
</tr>
</thead>
<tbody><tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody></table>
<p>+——+——+———–+————+———–+———————+———————+</p>
<table>
<thead>
<tr>
<th align="left">1</th>
<th align="left">tank</th>
<th align="left">2000</th>
<th align="left">2000-12-12</th>
<th align="left">12:11:10</th>
<th align="left">2000-12-12 11:11:11</th>
<th align="left">2019-12-11 18:37:00</th>
</tr>
</thead>
<tbody><tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody></table>
<p>+——+——+———–+————+———–+———————+———————+</p>
<h3 id="5-枚举和集合类型"><a href="#5-枚举和集合类型" class="headerlink" title="5)枚举和集合类型"></a>5)枚举和集合类型</h3><p>分类:</p>
<ul>
<li>枚举enum 多选一</li>
<li>集合set 多选一 或 多选多</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"> - enum: 可以 多选一</span><br><span class="line">   create table t13(</span><br><span class="line">       id int,</span><br><span class="line">       name varchar(<span class="number">4</span>),</span><br><span class="line">       gender enum(<span class="string">'male'</span>, <span class="string">'female'</span>, <span class="string">'others'</span>)</span><br><span class="line">   );</span><br><span class="line">                <span class="comment"># insert into 表名(字段名) values(字段名对应的值);</span></span><br><span class="line">                insert into t13(id, name, gender) values(<span class="number">1</span>, <span class="string">'tank'</span>, <span class="string">'male'</span>);</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 严格模式下，选择枚举以外的值会报错</span></span><br><span class="line">                insert into t13(id, name, gender) values(<span class="number">2</span>, <span class="string">'gd'</span>, <span class="string">'animal'</span>);</span><br><span class="line">                </span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">- set: 可 多选一 或 多选多</span><br><span class="line">                create table t14(</span><br><span class="line">                    id int,</span><br><span class="line">                    name varchar(<span class="number">4</span>),</span><br><span class="line">                    gender enum(<span class="string">'male'</span>, <span class="string">'female'</span>, <span class="string">'others'</span>),</span><br><span class="line">                    hobbies set(<span class="string">'read'</span>, <span class="string">'sing'</span>, <span class="string">'生蚝'</span>, <span class="string">'HSNM'</span>, <span class="string">'架子鼓'</span>)</span><br><span class="line">                );</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 多选一</span></span><br><span class="line">                insert into t14 values(<span class="number">1</span>, <span class="string">'大鸡J'</span>, <span class="string">'others'</span>, <span class="string">'HSNM'</span>);</span><br><span class="line">                <span class="comment"># 多选多</span></span><br><span class="line">                insert into t14 values(<span class="number">2</span>, <span class="string">'tank'</span>, <span class="string">'male'</span>, <span class="string">'read,架子鼓,sing,生蚝'</span>);</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 多选多的顺序可不一</span></span><br><span class="line">                insert into t14 values(<span class="number">2</span>, <span class="string">'tank'</span>, <span class="string">'male'</span>, <span class="string">'read,架子鼓,sing,生蚝'</span>);</span><br></pre></td></tr></table></figure>

<h2 id="四-约束条件"><a href="#四-约束条件" class="headerlink" title="四.约束条件"></a>四.约束条件</h2><p>约束条件就是，对于数据库表插入数据时加以约束限制。</p>
<h3 id="1-约束条件介绍"><a href="#1-约束条件介绍" class="headerlink" title="1)约束条件介绍"></a>1)约束条件介绍</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">- primary key (pk)</span><br><span class="line">    标识该字段为该表的主键，主键可以是唯一的表示记录</span><br><span class="line">    </span><br><span class="line">- foreign key (fk)</span><br><span class="line">    标识该字段为该表的外键</span><br><span class="line"></span><br><span class="line">- <span class="keyword">not</span> null</span><br><span class="line">    标识该字段不能为空</span><br><span class="line"></span><br><span class="line">- unique key (uk)</span><br><span class="line">    标识该字段的值是唯一的</span><br><span class="line"></span><br><span class="line">- auto_increment</span><br><span class="line">    标识该字段的值自动增长 （整数类型，并且为主键）</span><br><span class="line"></span><br><span class="line">- default</span><br><span class="line">    为该字段设置默认值</span><br><span class="line"></span><br><span class="line">- unsigned</span><br><span class="line">    无正负符号</span><br><span class="line"></span><br><span class="line">- zerofill</span><br><span class="line">    使用<span class="number">0</span>填充空格</span><br></pre></td></tr></table></figure>

<h3 id="2-not-null-unique-非空唯一"><a href="#2-not-null-unique-非空唯一" class="headerlink" title="2)not null + unique (非空唯一)"></a>2)not null + unique (非空唯一)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">create table user1(id int <span class="keyword">not</span> null,name varchar(<span class="number">4</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">#报错,不能输入空</span></span><br><span class="line">insert into user1 values(null,<span class="string">'tank'</span>);</span><br><span class="line"><span class="comment"># 正确</span></span><br><span class="line">insert into user1 values(<span class="number">1</span>,<span class="string">'tank'</span>);</span><br></pre></td></tr></table></figure>

<h3 id="3-unique-将某个字段设置为唯一的值"><a href="#3-unique-将某个字段设置为唯一的值" class="headerlink" title="3)unique 将某个字段设置为唯一的值"></a>3)unique 将某个字段设置为唯一的值</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">create table user3(id int <span class="keyword">not</span> null unique,name varchar(<span class="number">4</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment"># 报错</span></span><br><span class="line"> insert into user3 values(<span class="number">1</span>,<span class="string">'tank'</span>),(<span class="number">1</span>,<span class="string">'sean'</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 正确</span></span><br><span class="line">insert into user3 values(<span class="number">1</span>,<span class="string">'tank'</span>),(<span class="number">2</span>,<span class="string">'sean'</span>);</span><br></pre></td></tr></table></figure>

<h3 id="4-primary-key-主键"><a href="#4-primary-key-主键" class="headerlink" title="4)primary key (主键)"></a>4)primary key (主键)</h3><p>相等于 :not null + unique</p>
<p>pk就是表中的索引: 可以通过索引快速查找某些数据。 - 提高查询效率</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">  create table user4(</span><br><span class="line">                    id int primary key,</span><br><span class="line">                    name varchar(<span class="number">4</span>)</span><br><span class="line">                );</span><br><span class="line"><span class="comment"># 唯一</span></span><br><span class="line">insert into user4 values(<span class="number">1</span>);</span><br><span class="line">insert into user4 values(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 不能为空</span></span><br><span class="line">insert into user4 values(null);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 强调:</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">		1.一张表必须只有一个主键，如果没有设置主键，会从上到下搜索，直到遇到 "第一个"非空且唯一的字段自动设置为主键。</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">create table user8(</span><br><span class="line">	id int,</span><br><span class="line">  name varchar(<span class="number">16</span>),</span><br><span class="line">  age int <span class="keyword">not</span> null unique</span><br><span class="line">)engine=innodb;</span><br><span class="line"></span><br><span class="line">desc user8;</span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">		2.如果包里没有指定任何可以设置主键的字段，那innodb会采用自己默认的一个隐藏关键字作为主键，隐藏意味着查询你的时候通过这个加速查询。</span></span><br><span class="line"><span class="string">		索引: 类似于书的目录, 没有主键就相当于一页一页翻着查询。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">		3.一张表中通常都应该有一个id字段，并且通常将id字段作为主键。</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 联合主键: 多个字段联合起来作为一个主键，本质上还是一个主键</span></span><br><span class="line">create table user9(</span><br><span class="line">	id int,</span><br><span class="line">	name varchar(<span class="number">16</span>),</span><br><span class="line">	primary key(id, name)</span><br><span class="line">);</span><br><span class="line">desc user9;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 主键id作为数据的编号，应该设置为自动递增</span></span><br><span class="line">create table user10(</span><br><span class="line">	id int primary key auto_increment,</span><br><span class="line">  name varchar(<span class="number">16</span>)</span><br><span class="line">);</span><br><span class="line">desc user10;</span><br><span class="line"></span><br><span class="line">insert into user10(name) values(<span class="string">'tank'</span>);</span><br><span class="line">insert into user10(name) values(<span class="string">'sean'</span>),(<span class="string">'jason'</span>),(<span class="string">'大饼'</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="comment"># 若想自增从指定值开始，可插入第一条数据时先指定id的值;</span></span><br><span class="line">                insert into user4(id, name) values(<span class="number">10</span>, <span class="string">'tank'</span>);</span><br><span class="line">                insert into user4(name) values(<span class="string">'sean'</span>);  <span class="comment"># 11</span></span><br><span class="line">                insert into user4(name) values(<span class="string">'egon'</span>);  <span class="comment"># 12</span></span><br><span class="line">                insert into user4(name) values(<span class="string">'大鸡哥'</span>);  <span class="comment"># 13</span></span><br><span class="line">                </span><br><span class="line">                </span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意: auto_increment通常加在主键上，并且只能设置给primary key字段。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 补充:</span></span><br><span class="line">delete <span class="keyword">from</span> user10;</span><br><span class="line"><span class="comment"># delete删除表的记录或者指定记录，但id不会重置为0</span></span><br><span class="line"><span class="comment"># 删除某一条记录</span></span><br><span class="line">delete <span class="keyword">from</span> user10 where id=<span class="string">'4'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 若想要清空id重置为0，可使用truncate user10;</span></span><br></pre></td></tr></table></figure>

<h3 id="5-unsigned"><a href="#5-unsigned" class="headerlink" title="5)unsigned"></a>5)unsigned</h3><p>无符号</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">create table user5(</span><br><span class="line">    id int unsigned</span><br><span class="line">);</span><br><span class="line"><span class="comment"># 报错</span></span><br><span class="line">insert into user5 values(<span class="number">-100</span>);</span><br><span class="line">insert into user5 values(<span class="number">0</span>);</span><br><span class="line">insert into user5 values(<span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">有符号</span><br><span class="line">create table user6(</span><br><span class="line"> id int</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">insert into user6 values(<span class="number">-100</span>);</span><br></pre></td></tr></table></figure>

<h3 id="6-zerofill"><a href="#6-zerofill" class="headerlink" title="6)zerofill"></a>6)zerofill</h3><p>使用0填充空格</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create table user7(</span><br><span class="line">	id int zerofill</span><br><span class="line">	);</span><br><span class="line"></span><br><span class="line">insert into user7 values(<span class="number">100</span>);</span><br></pre></td></tr></table></figure>

<h3 id="7-删除记录"><a href="#7-删除记录" class="headerlink" title="7)删除记录"></a>7)删除记录</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">create table user8(</span><br><span class="line">               id int primary key auto_increment,</span><br><span class="line">               name varchar(<span class="number">4</span>)</span><br><span class="line">           );</span><br><span class="line"></span><br><span class="line">           insert into user8(name) values(<span class="string">'tank'</span>);</span><br><span class="line">           insert into user8(name) values(<span class="string">'大大大'</span>), (<span class="string">'egon'</span>);</span><br><span class="line"></span><br><span class="line">           - delete:</span><br><span class="line">               <span class="comment"># 清空user8表中的所有记录</span></span><br><span class="line">               delete <span class="keyword">from</span> user8;</span><br><span class="line"></span><br><span class="line">           - truncate:</span><br><span class="line">               <span class="comment"># 清空user8表中的所以记录，并且id重置为0</span></span><br><span class="line">               truncate table user8;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/11/11/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%AD%97%E6%AE%B5%E7%B1%BB%E5%9E%8B%E5%92%8C%E7%BA%A6%E6%9D%9F%E6%9D%A1%E4%BB%B6/" data-id="ckd3cw4hf0003rcut243rfap5" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MySQL/" rel="tag">MySQL</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-MySQL数据库的基础了解" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/08/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%9F%BA%E7%A1%80%E4%BA%86%E8%A7%A3/" class="article-date">
  <time datetime="2018-11-08T05:45:46.000Z" itemprop="datePublished">2018-11-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/08/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%9F%BA%E7%A1%80%E4%BA%86%E8%A7%A3/">MySQL数据库的基础了解</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="数据库介绍"><a href="#数据库介绍" class="headerlink" title="数据库介绍:"></a>数据库介绍:</h1><h2 id="1-什么是数据-Data"><a href="#1-什么是数据-Data" class="headerlink" title="1.什么是数据(Data)"></a>1.什么是数据(Data)</h2><p>描述事物的符号记录称为数据，描述事物的符号既可以是数字，也可以是文字、图片，图像、声音、语言等，数据由多种表现形式，它们都可以经过数字化后存入计算机</p>
<p>在计算机中描述一个事物，就需要抽取这一事物的典型特征，组成一条记录，就相当于文件里的一行内容，如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">egon,male,<span class="number">18</span>,<span class="number">1999</span>,山东,计算机系,<span class="number">2017</span>,oldboy</span><br></pre></td></tr></table></figure>

<p>单纯的一条记录并没有任何意义，如果我们按逗号作为分隔，依次定义各个字段的意思，相当于定义表的标题</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">name,sex,age,birth,born_addr,major,entrance_time,school <span class="comment">#字段</span></span><br><span class="line">egon,male,<span class="number">18</span>,<span class="number">1999</span>,山东,计算机系,<span class="number">2017</span>,oldboy <span class="comment">#记录</span></span><br></pre></td></tr></table></figure>

<h2 id="2-什么是数据库-DataBase-简称DB"><a href="#2-什么是数据库-DataBase-简称DB" class="headerlink" title="2.什么是数据库(DataBase,简称DB)"></a>2.什么是数据库(DataBase,简称DB)</h2><p>数据库即存放数据的仓库，只不过这个仓库是在计算机存储设备上，而且数据是按一定的格式存放的</p>
<p>过去人们将数据存放在文件柜里，现在数据量庞大，已经不再适用</p>
<p>数据库是长期存放在计算机内、有组织、可共享的数据即可。</p>
<p>数据库中的数据按一定的数据模型组织、描述和储存，具有较小的冗余度、较高的数据独立性和易扩展性，并可为各种 用户共享</p>
<h2 id="3-什么是数据库管理系统（DataBase-Management-System-简称DBMS）"><a href="#3-什么是数据库管理系统（DataBase-Management-System-简称DBMS）" class="headerlink" title="3 什么是数据库管理系统（DataBase Management System 简称DBMS）"></a>3 什么是数据库管理系统（DataBase Management System 简称DBMS）</h2><p>在了解了Data与DB的概念后，如何科学地组织和存储数据，如何高效获取和维护数据成了关键</p>
<p>这就用到了一个系统软件—数据库管理系统</p>
<p>例如:<br>关系型数据库：MySQL、PostgreSQL Oracle、SQLite、DB2、Access、SQL Server</p>
<p>非关系型数据库：</p>
<p>Redis、 Voldemort、 Oracle BDB （键值存储数据库）</p>
<p>CouchDB 、mongodb（文档型数据库）</p>
<p>Neo4J、 InfoGrid、 Infinite Graph （图形(Graph)数据库）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">可以简单的理解为：</span><br><span class="line">    关系型数据库需要有表结构</span><br><span class="line">    非关系型数据库是key-value存储的，没有表结构</span><br></pre></td></tr></table></figure>

<p>mysql主要用于大型门户，例如搜狗、新浪等，它主要的优势就是开放源代码，因为开放源代码这个数据库是免费的，他现在是甲骨文公司的产品。<br>oracle主要用于银行、铁路、飞机场等。该数据库功能强大，软件费用高。也是甲骨文公司的产品。<br>sql server是微软公司的产品，主要应用于大中型企业，如联想、方正等。</p>
<p><strong>数据库系统的特点：</strong></p>
<p><strong>1 数据结构化</strong></p>
<p><strong>2 数据共享，冗余度低，易扩充</strong></p>
<p><strong>3 数据独立性高</strong></p>
<p><strong>4 数据由DBMS统一管理和控制</strong></p>
<p>　　<strong>a：数据的安全性保护</strong></p>
<p>　　<strong>b：数据的完整性检查</strong></p>
<p>　　<strong>c：并发控制</strong></p>
<p>　　<strong>d：数据库恢</strong>复</p>
<h2 id="4-数据库服务器、数据管理系统、数据库、表与记录的关系（重点理解！！！）"><a href="#4-数据库服务器、数据管理系统、数据库、表与记录的关系（重点理解！！！）" class="headerlink" title="4.数据库服务器、数据管理系统、数据库、表与记录的关系（重点理解！！！）"></a>4.数据库服务器、数据管理系统、数据库、表与记录的关系（重点理解！！！）</h2><p><strong>记录：1 坦克 324245234 22（多个字段的信息组成一条记录，即文件中的一行内容）</strong></p>
<p><strong>表：student,scholl,class_list（即文件）</strong></p>
<p><strong>数据库：oldboy_stu（即文件夹）</strong></p>
<p><strong>数据库管理系统：如mysql（是一个软件）</strong></p>
<p><strong>数据库服务器：一台计算机（对内存要求比较高）</strong></p>
<p><strong>总结：</strong></p>
<p><strong>数据库服务器-：运行数据库管理软件</strong></p>
<p><strong>数据库管理软件：管理-数据库</strong></p>
<p><strong>数据库：即文件夹，用来组织文件/表</strong></p>
<p><strong>表：即文件，用来存放多行内容/多条记录</strong></p>
<p><img src="https://user-images.githubusercontent.com/57135669/88484691-ff1d8e00-cfa2-11ea-81d8-a73c36037fa9.png" alt="数据库1"></p>
<h2 id="5-MySQL介绍-重点"><a href="#5-MySQL介绍-重点" class="headerlink" title="5.MySQL介绍(重点)"></a>5.MySQL介绍(重点)</h2><p>MySQL是一个关系型数据库管理系统，由瑞典MySQL AB 公司开发，目前属于 Oracle 旗下公司。MySQL 最流行的关系型数据库管理系统，在 WEB 应用方面MySQL是最好的 RDBMS (Relational Database Management System，关系数据库管理系统) 应用软件之一。</p>
<ul>
<li><strong>mysql是什么?</strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#mysql就是一个基于socket编写的C/S架构的基于网络通信的软件</span></span><br><span class="line"></span><br><span class="line"> - 服务端:</span><br><span class="line">          - 基于网络通信</span><br><span class="line">          - 收发消息</span><br><span class="line"></span><br><span class="line"> - 客户端:</span><br><span class="line">          - 基于网络通信</span><br><span class="line">          - 收发消息</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">- 所有语言若想操作数据库，拿到服务端ip和port，都必须遵循一套标准的解析指令 ---》 SQL语句</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-所有基于网络通信的软件，底层都是socket。</span><br></pre></td></tr></table></figure>

<h2 id="6安装数据库-重点"><a href="#6安装数据库-重点" class="headerlink" title="6安装数据库(重点)"></a>6安装数据库(重点)</h2><ul>
<li>安装数据库<ul>
<li>1.下载mysql安装包</li>
<li>2.解压安装包放在D:中</li>
<li>3.添加系统环境变量</li>
</ul>
</li>
</ul>
<p><img src="https://user-images.githubusercontent.com/57135669/88484693-02187e80-cfa3-11ea-9f84-f32f58f2ff25.png" alt="数据库2"></p>
<p><img src="C:%5CUsers%5C%E6%B1%9F%E5%85%88%E7%94%9F%5CDesktop%5C%E5%9B%BE%E5%BA%8A%5C%E6%95%B0%E6%8D%AE%E5%BA%932.png" alt="img"></p>
<p>4.以管理员身份打开cmd，输入mysqld启动服务端，此时会卡主</p>
<ul>
<li>打开的即bin目录下的: mysqld.exe</li>
</ul>
<p><strong>注意</strong>:</p>
<ul>
<li>做服务端操作时，必须先以<strong>管理员</strong>身份打开cmd</li>
</ul>
<p>5.新建一个cmd，mysql客户端连接服务端，输入mysql -h 127.0.0.1 -P 3306 -p 密码</p>
<ul>
<li>mysql初始化时无密码，可以进入游客模式，功能会很少<br>入 —》 可不需要“-p 密码”</li>
<li>全写: mysql -h 127.0.0.1 -P 3306 -p 密码<br>简写: mysql -uroot -p 密码</li>
<li>打开的即bin目录下的: mysql.exe</li>
</ul>
<p><img src="https://user-images.githubusercontent.com/57135669/88484695-06449c00-cfa3-11ea-9340-220d7e1aad23.png" alt="数据库3"></p>
<p>6.退出数据库客户端</p>
<p>exit; 或者 quit;(记得加分号)</p>
<p>注意: SQL语句末尾必须加 “;” 号。</p>
<p>7.查看操作系统服务端进程和停止进程</p>
<ul>
<li><p>查看操作系统中是否已经启动mysqld 服务端</p>
<p>tasklist | findstr “mysqld”</p>
<p>会得到一个pid号</p>
</li>
<li><p>停止服务端mysqld进程</p>
<p>taskkill /F /PID pid号</p>
</li>
</ul>
<p>8.查看所有数据库</p>
<ul>
<li>show databases;</li>
</ul>
<p>9.制作系统服务</p>
<ul>
<li><p>1.必须将已启动的服务端mysqld关掉</p>
</li>
<li><p>2.删掉已经启动过的mysqld的进程</p>
</li>
<li><p>3.输入 mysqld –install —-&gt; 安装mysqld系统服务</p>
</li>
<li><p>4.输入 net start mysqld</p>
<p>以管理员身份运行后,直接输入net start mysql 可以打开服务,<br>​ 输入net stop mysql 可以关闭服务</p>
</li>
</ul>
<p>10.登陆</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- mysql -u 登录mysql用户名（root） -p 密码</span><br><span class="line">    - 默认自带 root 超级用户， 没有密码(初始化时)</span><br><span class="line">    - 管理员登录</span><br><span class="line">        - mysql -uroot 回车进入</span><br><span class="line"></span><br><span class="line">    - 游客登录</span><br><span class="line">        - mysql 回车</span><br></pre></td></tr></table></figure>

<p>11.修改密码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- 修改密码:</span><br><span class="line">    - 默认没有密码的情况下，设置密码</span><br><span class="line">        - cmd&gt;&gt;&gt;: mysqladmin -uroot <span class="keyword">pass</span></span><br><span class="line">        word <span class="number">123</span></span><br><span class="line"></span><br><span class="line">    - 有密码的情况下，修改密码</span><br><span class="line">        - cmd&gt;&gt;&gt;: mysqladmin -uroot -p原密码 password修改的密码</span><br><span class="line">        - cmd&gt;&gt;&gt;: mysqladmin -uroot -p123456 password <span class="number">123</span></span><br></pre></td></tr></table></figure>

<p>12.破解密码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">- 破解密码: 当密码忘记时采用</span><br><span class="line">       - <span class="number">1.</span>关闭服务端</span><br><span class="line">       - <span class="number">2.</span>以管理员跳过权限启动服务端</span><br><span class="line">           - cmd&gt;&gt;&gt;:  mysqld --skip-grant-tables</span><br><span class="line"></span><br><span class="line">       - <span class="number">3.</span>客户端进入游客模式:</span><br><span class="line">           - cmd&gt;&gt;&gt;:  mysql</span><br><span class="line"></span><br><span class="line">           - update mysql库.user表名 set 字段password=字段password(<span class="string">'字段值'</span>) where 条件（若条件成立，则修改）user=<span class="string">"root"</span>;</span><br><span class="line">           - cmd&gt;&gt;&gt;:  update mysql.user set password=password(<span class="string">'123456'</span>) where user=<span class="string">"root"</span>;</span><br><span class="line"></span><br><span class="line">       - <span class="number">4.</span>重新启动服务端，不要跳过权限认证</span><br><span class="line">           - 先kill掉跳过权限认证启动的服务端进程</span><br><span class="line">           - 再手动去开服服务中的mysql服务即可</span><br></pre></td></tr></table></figure>

<p>12.设置配置文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">- 设置配置文件:</span><br><span class="line">   - <span class="number">1.</span>先在mysql目录下  --》 D:\mysql<span class="number">-5.6</span><span class="number">.40</span>-winx64</span><br><span class="line"></span><br><span class="line">   - <span class="number">2.</span>创建一个名为 “my.ini” 的文件，这个是mysql的配置文件,将下面内容复制进my.ini文件中</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">            [mysqld]</span></span><br><span class="line"><span class="string">            character-set-server=utf8</span></span><br><span class="line"><span class="string">            collation-server=utf8_general_ci</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            # 这个是用python软件连接的客户端</span></span><br><span class="line"><span class="string">            [client]</span></span><br><span class="line"><span class="string">            default-character-set=utf8</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            # mysql软件的客户端</span></span><br><span class="line"><span class="string">            [mysql]</span></span><br><span class="line"><span class="string">            # 可写，可不写这样可以不需要用户名与密码直接登录mysql</span></span><br><span class="line"><span class="string">            # user='root'</span></span><br><span class="line"><span class="string">            # password=123</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            # 设置默认的字符编码</span></span><br><span class="line"><span class="string">            default-character-set=utf8</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">   - <span class="number">3.</span>重启mysql服务,即修改成功!</span><br><span class="line"></span><br><span class="line">	\s; 可以查看当前配置文件</span><br></pre></td></tr></table></figure>

<h2 id="7-数据库基本操作"><a href="#7-数据库基本操作" class="headerlink" title="7.数据库基本操作"></a>7.数据库基本操作</h2><ul>
<li>数据库的基本操作</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">- 数据库基本操作:</span><br><span class="line">        - 库的操作 ---&gt; 类似于文件夹</span><br><span class="line">            - 增:</span><br><span class="line">                语法: create database 库名;</span><br><span class="line">                    - create database db1;</span><br><span class="line">            - 选择:</span><br><span class="line">                 语法:use 库名;</span><br><span class="line">                      use db1;</span><br><span class="line"></span><br><span class="line">            - 查</span><br><span class="line">                语法: show databases;  <span class="comment"># 查看所有库</span></span><br><span class="line">                      show create database db1;  <span class="comment"># 查看db1库中的信息</span></span><br><span class="line"></span><br><span class="line">            - 改</span><br><span class="line">                语法: alter database 库名 charset=<span class="string">"字符编码类型"</span>;</span><br><span class="line">                    - alter database db1 charset=<span class="string">"utf8"</span>;</span><br><span class="line"></span><br><span class="line">            - 删</span><br><span class="line">                语法: drop database db1;</span><br></pre></td></tr></table></figure>

<ul>
<li>表的基本操作</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">- 表的操作 ---&gt; 类似于文件</span><br><span class="line">    - 操作表前，需要先切换到指定库</span><br><span class="line">        语法: use 库名;</span><br><span class="line">            - use db1;</span><br><span class="line"></span><br><span class="line">        查看当前所在的库: select database()</span><br><span class="line"></span><br><span class="line">    - 增</span><br><span class="line">        varchar与char 都是字符串类型;</span><br><span class="line">        varchar(<span class="number">20</span>)</span><br><span class="line">        语法: create table 表名(字段名 字段类型);</span><br><span class="line">            create table user_info(name varchar(<span class="number">20</span>), age int);</span><br><span class="line"></span><br><span class="line">            在db1库内为db2库添加表  </span><br><span class="line">            create 库名.表名(字段名,字段类型)</span><br><span class="line">            create table db2.user_info(name varchar(<span class="number">20</span>), age int);</span><br><span class="line"></span><br><span class="line">    - 查</span><br><span class="line">        show tables;  <span class="comment"># 查看当前库中所有的表</span></span><br><span class="line">        desc user_info;  <span class="comment"># 查看表结构</span></span><br><span class="line"></span><br><span class="line">    - 改</span><br><span class="line">        语法: alter table 表名 modify name varchar(<span class="number">28</span>);</span><br><span class="line">            - alter table user_info modify name varchar(<span class="number">28</span>);</span><br><span class="line"></span><br><span class="line">    - 删</span><br><span class="line">        语法: drop table 表名;</span><br><span class="line">            - create table test(id int);</span><br><span class="line">            - drop table test;</span><br></pre></td></tr></table></figure>

<ul>
<li>记录的操作</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">- 记录 的操作 ---&gt; 类似于文件中的一行行数据</span><br><span class="line">    - 增:</span><br><span class="line">        语法: insert into 表名 values(<span class="string">'字段类型的数据1'</span>, 字段类型的数据<span class="number">1</span>);</span><br><span class="line">            <span class="comment"># 插入一条</span></span><br><span class="line">            - insert into user_info values(<span class="string">'tank'</span>, <span class="number">17</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 插入多条</span></span><br><span class="line">            - insert into user_info values(<span class="string">'jason'</span>, <span class="number">71</span>), (<span class="string">'sean'</span>, <span class="number">78</span>);</span><br><span class="line"></span><br><span class="line">    - 查：</span><br><span class="line">        *: 指的是所有</span><br><span class="line">        语法: select * <span class="keyword">from</span> 表名;  <span class="comment"># 查看表中所有的数据</span></span><br><span class="line">                - select * <span class="keyword">from</span> user_info;</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 查看name 字段为 tank 的记录</span></span><br><span class="line">                - select * <span class="keyword">from</span> 表名 where 条件;  <span class="comment"># 条件成立则查看成功!</span></span><br><span class="line">                - select * <span class="keyword">from</span> user_info where name=<span class="string">"tank"</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 查看name 字段为 tank 的age字段</span></span><br><span class="line">                - select age <span class="keyword">from</span> user_info where name=<span class="string">"tank"</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 查看所有的名字:</span></span><br><span class="line">                - select name <span class="keyword">from</span> user_info;</span><br><span class="line"></span><br><span class="line">    - 改</span><br><span class="line">        语法: update 表名 set 字段名=字段值 where 条件判断;  <span class="comment"># 若条件成立，则修改成功!</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 修改age为17的记录中name属性为 handsome</span></span><br><span class="line">            - update user_info set name=<span class="string">'handsome'</span> where age=<span class="number">17</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 修改age&gt;16的记录 中name属性为 d_sb</span></span><br><span class="line">            - update user_info set name=<span class="string">'d_sb'</span> where age&gt;<span class="number">16</span>;</span><br><span class="line"></span><br><span class="line">    - 删</span><br><span class="line"></span><br><span class="line">        语法: delete <span class="keyword">from</span> 表名;</span><br><span class="line">            <span class="comment"># 清空表记录，不提交，可恢复。</span></span><br><span class="line">            - delete <span class="keyword">from</span> user_info;</span><br><span class="line"></span><br><span class="line">        语法: truncate table 表名;</span><br><span class="line">            <span class="comment"># 删除，不可恢复</span></span><br><span class="line">            - truncate table user_info;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/11/08/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%9F%BA%E7%A1%80%E4%BA%86%E8%A7%A3/" data-id="ckd3cw4h70001rcut1t8oh37p" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MySQL/" rel="tag">MySQL</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-python单例模式" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/02/python%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/" class="article-date">
  <time datetime="2018-11-02T12:20:05.000Z" itemprop="datePublished">2018-11-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/02/python%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/">python单例模式</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="单例模式"><a href="#单例模式" class="headerlink" title="单例模式"></a>单例模式</h1><p>单例模式：指的是在确定 “类中的属性与方法” 不变时，需要反复调用该类，产生不同的对象，而产生的对象会有不同的内存地址，会造成资源浪费，所有让所有的类实例化时都指向同一个内存空间，称为单例模式</p>
<p>优点：节省内存空间</p>
<p>单例模式有五种方法实现：</p>
<ol>
<li>通过classmethod</li>
<li>通过装饰器实现</li>
<li>通过__ new__实现</li>
<li>通过导入模块实现</li>
<li>通过元类实现</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过classmethod</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MySQL</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 一个默认值，用于判断对象是否存在， 对象不存在证明值是None</span></span><br><span class="line">    <span class="comment"># __instance是类的属性，可以由类来调用</span></span><br><span class="line">    __instance = <span class="literal">None</span>  <span class="comment">#  ---》 执行到代码obj = cls(host, port) ---》 obj</span></span><br><span class="line">    <span class="comment"># __instance = obj</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, host, port)</span>:</span></span><br><span class="line">        self.host = host</span><br><span class="line">        self.port = port</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">singleton</span><span class="params">(cls, host, port)</span>:</span>  <span class="comment"># 单例方法 ---》 类方法</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 判断__instance中若没有值，证明没有对象</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> cls.__instance:</span><br><span class="line">            <span class="comment"># 产生一个对象并返回</span></span><br><span class="line">            obj = cls(host, port)</span><br><span class="line">            <span class="comment"># None ---&gt; obj</span></span><br><span class="line">            cls.__instance = obj</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 若__instance中有值，证明对象已经存在，则直接返回该对象</span></span><br><span class="line">        <span class="keyword">return</span> cls.__instance</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start_mysql</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'启动mysql'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">close</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'关闭mysql'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">obj1 = MySQL.singleton(<span class="string">'180.101.49.12'</span>, <span class="number">443</span>)</span><br><span class="line">print(obj1)  <span class="comment"># &lt;__main__.MySQL object at 0x00000207EFC09188&gt;</span></span><br><span class="line">obj2 = MySQL.singleton(<span class="string">'180.101.49.12'</span>, <span class="number">443</span>)</span><br><span class="line">print(obj2)  <span class="comment"># &lt;__main__.MySQL object at 0x00000207EFC09188&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Mysql</span>:</span></span><br><span class="line"></span><br><span class="line">    __date = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(cls, name)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> cls.__date:</span><br><span class="line">            obj = cls(name)</span><br><span class="line">            cls.__date = obj</span><br><span class="line">        <span class="keyword">return</span> cls.__date</span><br><span class="line"></span><br><span class="line">obj1= Mysql.func(<span class="string">'sean'</span>)</span><br><span class="line">obj2= Mysql.func(<span class="string">'sean'</span>)</span><br><span class="line"></span><br><span class="line">print(obj1)</span><br><span class="line">print(obj2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Mysql</span>:</span></span><br><span class="line"></span><br><span class="line">    __date = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> cls.__date:</span><br><span class="line">            obj = object.__new__(cls)</span><br><span class="line">            cls.__date = obj</span><br><span class="line">        <span class="keyword">return</span> cls.__date</span><br><span class="line"></span><br><span class="line">obj1= Mysql(<span class="string">'sean'</span>)</span><br><span class="line">obj2= Mysql(<span class="string">'sean'</span>)</span><br><span class="line"></span><br><span class="line">print(obj1)</span><br><span class="line">print(obj2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">输出结果</span></span><br><span class="line"><span class="string">&lt;__main__.Mysql object at 0x0000013E2DEBC208&gt;</span></span><br><span class="line"><span class="string">&lt;__main__.Mysql object at 0x0000013E2DEBC208&gt;</span></span><br><span class="line"><span class="string">&lt;__main__.Mysql object at 0x0000013E2E2B9C08&gt;</span></span><br><span class="line"><span class="string">&lt;__main__.Mysql object at 0x0000013E2E2B9C08&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">方式二: __new__</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton2</span>:</span></span><br><span class="line">    __instance = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__new__</span><span class="params">(cls, *args, **kwargs)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> cls.__instance:</span><br><span class="line">            cls.__instance = object.__new__(cls)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> cls.__instance</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">obj1 = Singleton2()</span><br><span class="line">obj2 = Singleton2()</span><br><span class="line">print(obj1)</span><br><span class="line">print(obj2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">方式三: 装饰器</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">singleton</span><span class="params">(cls)</span>:</span>  <span class="comment"># cls---&gt; Father</span></span><br><span class="line">    _instance = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span><span class="params">(*args, **kwargs)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> cls <span class="keyword">not</span> <span class="keyword">in</span> _instance:</span><br><span class="line">            obj = cls(*args, **kwargs)</span><br><span class="line">            _instance[cls] = obj</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> _instance[cls]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line"><span class="meta">@singleton</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Father</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">print(Father())</span><br><span class="line">print(Father())</span><br><span class="line">类可以当做字典的key</span><br><span class="line">print(&#123;Father: <span class="number">111</span>&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">方式四: 模块导入</span><br><span class="line"></span><br><span class="line"><span class="comment"># 先写一个singleton模块</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SingletonCls</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">obj = SingletonCls()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 在另一个文件写</span></span><br><span class="line"><span class="keyword">from</span> Singleton <span class="keyword">import</span> obj</span><br><span class="line">print(obj)</span><br><span class="line"><span class="keyword">from</span> Singleton <span class="keyword">import</span> obj</span><br><span class="line">print(obj)</span><br><span class="line"><span class="keyword">from</span> Singleton <span class="keyword">import</span> obj</span><br><span class="line">print(obj)</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/11/02/python%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/" data-id="ckd3cw4ig000vrcut1jcye3sr" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/" rel="tag">Python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-python面向对象之继承封装多态" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/10/28/python%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E4%B9%8B%E7%BB%A7%E6%89%BF%E5%B0%81%E8%A3%85%E5%A4%9A%E6%80%81/" class="article-date">
  <time datetime="2018-10-28T15:19:45.000Z" itemprop="datePublished">2018-10-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/28/python%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E4%B9%8B%E7%BB%A7%E6%89%BF%E5%B0%81%E8%A3%85%E5%A4%9A%E6%80%81/">python面向对象之继承封装多态</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="面向对象之继承"><a href="#面向对象之继承" class="headerlink" title="面向对象之继承"></a>面向对象之继承</h1><h2 id="1-什么是继承？"><a href="#1-什么是继承？" class="headerlink" title="1.什么是继承？"></a>1.什么是继承？</h2><p>继承是一种新建类的方式，新建的类称之为子类或派生类，继承的父类称之为基类或超类。</p>
<p>在Python中，一个子类可以继承多个父类。（面试可能会问）</p>
<p>在其它语言中，一个子类只能继承一个父类。</p>
<h2 id="2-继承的作用？"><a href="#2-继承的作用？" class="headerlink" title="2.继承的作用？"></a>2.继承的作用？</h2><p>减少代码的冗余。</p>
<h3 id="3-如何实现继承？"><a href="#3-如何实现继承？" class="headerlink" title="3.如何实现继承？"></a>3.如何实现继承？</h3><ol>
<li>先确认谁是子类，谁是父类。</li>
<li>在定义类子类时， 通过class 子类名(父类名):这种方式就可以继承父类的属性和方法。可以通过 :子类名.__ base __查看到父类是谁</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 父类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Father1</span>:</span></span><br><span class="line">    x = <span class="number">1</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Father2</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Father3</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 子类, </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sub</span><span class="params">(Father1, Father2, Father3)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 子类.__bases__ 查看父类</span></span><br><span class="line">print(Sub.__bases__)</span><br><span class="line">print(Sub.x)</span><br></pre></td></tr></table></figure>

<h2 id="4-如何寻找继承关系-即如何确定父类子类"><a href="#4-如何寻找继承关系-即如何确定父类子类" class="headerlink" title="4.如何寻找继承关系,即如何确定父类子类"></a>4.如何寻找继承关系,即如何确定父类子类</h2><p>得先抽象，再继承</p>
<ul>
<li>抽取对象之间相似的部分，总结出类</li>
<li>抽取类之间相似的部分，总结出父类。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 父类  # 总结出所有子类的相似部分</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OldboyPeople</span>:</span></span><br><span class="line">    school = <span class="string">'oldboy'</span></span><br><span class="line">    country = <span class="string">'China'</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age, sex)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line">        self.sex = sex</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 老师类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OldboyTeacher</span><span class="params">(OldboyPeople)</span>:</span></span><br><span class="line">    <span class="comment"># school = 'oldboy'                       # 相似的属性和方法可以抽取出来定义成父类</span></span><br><span class="line">    <span class="comment"># country = 'China'</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># def __init__(self, name, age, sex):</span></span><br><span class="line">    <span class="comment">#     self.name = name</span></span><br><span class="line">    <span class="comment">#     self.age = age</span></span><br><span class="line">    <span class="comment">#     self.sex = sex</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 老师修改分数</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">change_score</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">f'老师 <span class="subst">&#123;self.name&#125;</span> 正在修改分数...'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 学生类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OldboyStudent</span><span class="params">(OldboyPeople)</span>:</span></span><br><span class="line">    <span class="comment"># school = 'oldboy'</span></span><br><span class="line">    <span class="comment"># country = 'China'</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># def __init__(self, name, age, sex):</span></span><br><span class="line">    <span class="comment">#     self.name = name</span></span><br><span class="line">    <span class="comment">#     self.age = age</span></span><br><span class="line">    <span class="comment">#     self.sex = sex</span></span><br><span class="line">    <span class="comment"># 学生选择课程</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">choose_course</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">f'学生 <span class="subst">&#123;self.name&#125;</span> 正在选择课程...'</span>)</span><br></pre></td></tr></table></figure>

<h2 id="5-继承背景下对象属性的查找顺序"><a href="#5-继承背景下对象属性的查找顺序" class="headerlink" title="5.继承背景下对象属性的查找顺序"></a>5.继承背景下对象属性的查找顺序</h2><ul>
<li>1.先从对象自己的名称空间中查找</li>
<li>2.对象中没有，从子类的名称空间中查找。</li>
<li>3.子类中没有, 从父类的名称空间中查找，若父类没有，则会报错!</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 父类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Goo</span>:</span></span><br><span class="line">    x = <span class="number">10</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 子类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span><span class="params">(Goo)</span>:</span></span><br><span class="line">    x = <span class="number">100</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">foo_obj = Foo()</span><br><span class="line">foo_obj.x = <span class="number">1000</span>  <span class="comment"># 注意,这不是修改子类的属性,而是在子类对象里面添加了新属性</span></span><br><span class="line">print(foo_obj.x)</span><br><span class="line">print(<span class="string">'对象的名称空间: '</span>, foo_obj.__dict__)</span><br><span class="line">print(<span class="string">'子类的名称空间: '</span>, Foo.__dict__)</span><br><span class="line">print(<span class="string">'父类的名称空间: '</span>, Goo.__dict__)</span><br></pre></td></tr></table></figure>

<h2 id="6-什么叫派生"><a href="#6-什么叫派生" class="headerlink" title="6.什么叫派生"></a>6.什么叫派生</h2><p>派生: 指的是子类继承父类的属性与方法，并且派生出自己独有的属性与方法。 若子类中的方法名与父类的相同，优先用子类的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 父类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">f1</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'from Foo.f1...'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">f2</span><span class="params">(self)</span>:</span>  <span class="comment"># self ---&gt; bar_obj</span></span><br><span class="line">        print(<span class="string">'from Foo.f2...'</span>)</span><br><span class="line">       </span><br><span class="line"><span class="comment"># 子类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bar</span><span class="params">(Foo)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 重写</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">f1</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'from Bar.f1..'</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'from Bar.func...'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">bar_obj = Bar()</span><br><span class="line">bar_obj.f1()    <span class="comment"># 输出结果:from Bar.f1..</span></span><br><span class="line">bar_obj.func()  <span class="comment"># 输出结果:from Bar.func...</span></span><br><span class="line">bar_obj.f2()    <span class="comment"># 输出结果:from Foo.f2...</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查找方法的顺序也是先在对象中找,如果对象中没有,则会在子类中找如果子类中没有,则去父类中找,如果父类中没有,则报错</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">问题: 子类重写父类的__init__导致代码更加冗余</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OldboyPeople</span>:</span></span><br><span class="line">    school = <span class="string">'oldboy'</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age, sex)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line">        self.sex = sex</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OldboyTeacher</span><span class="params">(OldboyPeople)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age, sex, sal)</span>:</span><span class="comment">#想派生出自己的属性,还需要重新写父类的属性,这样非常麻烦</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line">        self.sex = sex</span><br><span class="line">        self.sal = sal</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">change_score</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">f'老师 <span class="subst">&#123;self.name&#125;</span> 修改分数...'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OldboyStudent</span><span class="params">(OldboyPeople)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age, sex, girl)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line">        self.sex = sex</span><br><span class="line">        self.girl = girl</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">choose_course</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">f'学生 <span class="subst">&#123;self.name&#125;</span> 选择课程...'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">tea1 = OldboyTeacher(<span class="string">'tank'</span>, <span class="number">17</span>, <span class="string">'male'</span>, <span class="number">15000000</span>)</span><br><span class="line">stu1 = OldboyStudent(<span class="string">'sean'</span>, <span class="number">28</span>, <span class="string">'male'</span>, <span class="string">'凤姐'</span>)</span><br><span class="line">print(tea1.name, tea1.age, tea1.sex, tea1.sal)</span><br><span class="line">print(stu1.name, stu1.age, stu1.sex, stu1.girl)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">解决问题: 子类重用父类的属性，并派生出新的属性。</span></span><br><span class="line"><span class="string">    两种方式：</span></span><br><span class="line"><span class="string">        1.直接引用父类的__init__为其传参，并添加子类的属性。</span></span><br><span class="line"><span class="string">        2.通过super来指向父类的属性。</span></span><br><span class="line"><span class="string">            - super()是一个特殊的类，调用super得到一个对象，该对象指向父类的名称空间。</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">        注意: 使用哪一种都可以，但不能两种方式混合使用。</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">方式一:</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OldboyPeople</span>:</span></span><br><span class="line">    school = <span class="string">'oldboy'</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age, sex)</span>:</span>  <span class="comment"># self == tea1, name == 'tank', age == 17, sex == 'male'</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line">        self.sex = sex</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OldboyTeacher</span><span class="params">(OldboyPeople)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># tea1, 'tank', 17, 'male', 15000000</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age, sex, sal)</span>:</span></span><br><span class="line">        <span class="comment"># self.name = name</span></span><br><span class="line">        <span class="comment"># self.age = age</span></span><br><span class="line">        <span class="comment"># self.sex = sex</span></span><br><span class="line">        <span class="comment"># 类调用类内部的__init__，只是一个普通函数</span></span><br><span class="line">        <span class="comment"># OldboyPeople.__init__(tea1, 'tank', 17, 'male')</span></span><br><span class="line">        OldboyPeople.__init__(self, name, age, sex) <span class="comment"># 在子类的.__init__中调用</span></span><br><span class="line">        self.sal = sal <span class="comment"># 这样只需要写添加的属性就可以了</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">change_score</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">f'老师 <span class="subst">&#123;self.name&#125;</span> 修改分数...'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OldboyStudent</span><span class="params">(OldboyPeople)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age, sex, girl)</span>:</span></span><br><span class="line">        OldboyPeople.__init__(self, name, age, sex)</span><br><span class="line">        self.girl = girl</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">choose_course</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">f'学生 <span class="subst">&#123;self.name&#125;</span> 选择课程...'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">tea1 = OldboyTeacher(<span class="string">'tank'</span>, <span class="number">17</span>, <span class="string">'male'</span>, <span class="number">15000000</span>) <span class="comment"># 传参的时候别忘了</span></span><br><span class="line">print(tea1.name, tea1.age, tea1.sex, tea1.sal)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">stu1 = OldboyStudent(<span class="string">'sean'</span>, <span class="number">28</span>, <span class="string">'male'</span>, <span class="string">'凤姐'</span>)</span><br><span class="line">print(stu1.name, stu1.age, stu1.sex, stu1.girl)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 方式二:</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OldboyPeople</span>:</span></span><br><span class="line">    school = <span class="string">'oldboy'</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># self == tea1</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age, sex)</span>:</span>  <span class="comment"># self == tea1, name == 'tank', age == 17, sex == 'male'</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line">        self.sex = sex</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OldboyTeacher</span><span class="params">(OldboyPeople)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># tea1, 'tank', 17, 'male', 15000000</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age, sex, sal)</span>:</span></span><br><span class="line">        <span class="comment"># super() ---&gt; 特殊的对象 ---&gt; 对象.属性 ---&gt; 父类的名称空间</span></span><br><span class="line">        <span class="comment"># 会将调用类传入的对象当做第一个参数传给__init__()</span></span><br><span class="line">        super().__init__(name, age, sex)</span><br><span class="line">        self.sal = sal</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">change_score</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">f'老师 <span class="subst">&#123;self.name&#125;</span> 修改分数...'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OldboyStudent</span><span class="params">(OldboyPeople)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age, sex, girl)</span>:</span></span><br><span class="line">        super().__init__(name, age, sex)</span><br><span class="line">        self.girl = girl</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">choose_course</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">f'学生 <span class="subst">&#123;self.name&#125;</span> 选择课程...'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">tea1 = OldboyTeacher(<span class="string">'tank'</span>, <span class="number">17</span>, <span class="string">'male'</span>, <span class="number">15000000</span>)</span><br><span class="line">print(tea1.name, tea1.age, tea1.sex, tea1.sal)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">stu1 = OldboyStudent(<span class="string">'sean'</span>, <span class="number">28</span>, <span class="string">'male'</span>, <span class="string">'凤姐'</span>)</span><br><span class="line">print(stu1.name, stu1.age, stu1.sex, stu1.girl)</span><br></pre></td></tr></table></figure>

<h2 id="7-经典类和新式类-了解"><a href="#7-经典类和新式类-了解" class="headerlink" title="7.经典类和新式类(了解)"></a>7.经典类和新式类(了解)</h2><ul>
<li><p>新式类:</p>
<p>1.凡是继承object的类或子孙类都是新式类。</p>
<p>2.在python3中所有的类都默认继承object。</p>
</li>
<li><p>经典类:</p>
<p>1.在python2中才会有经典类与新式类之分。</p>
<p>2.在python2中，凡是没有继承object的类，都是经典类。</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span><span class="params">(object)</span>:</span> <span class="comment"># 新式类</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sub</span><span class="params">(User)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(User.__dict__)</span><br><span class="line"></span><br><span class="line"><span class="comment">#输出结果：</span></span><br><span class="line">&#123;<span class="string">'__module__'</span>: <span class="string">'__main__'</span>, <span class="string">'x'</span>: <span class="number">10</span>, <span class="string">'__dict__'</span>: &lt;attribute <span class="string">'__dict__'</span> of <span class="string">'User'</span> objects&gt;, <span class="string">'__weakref__'</span>: &lt;attribute <span class="string">'__weakref__'</span> of <span class="string">'User'</span> objects&gt;, <span class="string">'__doc__'</span>: <span class="literal">None</span>&#125;</span><br><span class="line"></span><br><span class="line">print(object)</span><br><span class="line"></span><br><span class="line">输出结果:</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">object</span>'&gt;</span></span><br><span class="line"><span class="class">'''</span></span><br><span class="line"><span class="class">在<span class="title">python3</span>中提供了一个查找新式类查找顺序的内置方法.</span></span><br><span class="line"><span class="class">    <span class="title">mro</span><span class="params">()</span>:</span>类的内置方法,会把当前类的继承关系列出来。</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 注意: super()会严格按照mro列表的顺序往后查找,mro列表的构造是通过c3线性算法来实现的</span></span><br><span class="line"><span class="string">class A:</span></span><br><span class="line"><span class="string">    def test(self):</span></span><br><span class="line"><span class="string">        print('from A.test')</span></span><br><span class="line"><span class="string">        super().est()</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">class B:</span></span><br><span class="line"><span class="string">    def est(self):</span></span><br><span class="line"><span class="string">        print('from B.test')</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">class C(A, B):</span></span><br><span class="line"><span class="string">    pass</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">c = C()</span></span><br><span class="line"><span class="string"># 检查super的继承顺序</span></span><br><span class="line"><span class="string">print(C.mro())</span></span><br><span class="line"><span class="string"># 输出结果:是一个继承顺序的列表</span></span><br><span class="line"><span class="string">[&lt;class '__main__.C'&gt;, &lt;class '__main__.A'&gt;, &lt;class '__main__.B'&gt;, &lt;class 'object'&gt;]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 去A找，有的话打印，然后super又执行了test，根据mro中查找打印B类中test。</span></span><br><span class="line"><span class="string">c.test()</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">from</span> A.test</span><br><span class="line"><span class="keyword">from</span> B.test</span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure>

<p>多继承情况下造成 “钻石继承” 或“菱形继承”</p>
<p>mro的查找顺序:</p>
<ul>
<li><p>新式类:</p>
<p>广度优先</p>
<p><img src="https://user-images.githubusercontent.com/57135669/88484268-e19af500-cf9f-11ea-9cc3-728c32874da1.png" alt="1843708-20191126203504762-1369309667"></p>
</li>
<li><p>经典类:</p>
<p>深度优先</p>
</li>
</ul>
<p><img src="https://user-images.githubusercontent.com/57135669/88484269-e495e580-cf9f-11ea-89ca-cff8b0e92f40.png" alt="1843708-20191126203524599-1600861642"></p>
<h1 id="面向对象三大特性之封装"><a href="#面向对象三大特性之封装" class="headerlink" title="面向对象三大特性之封装"></a>面向对象三大特性之封装</h1><p>在讲封装前我们可以先了解什么是组合</p>
<h2 id="一-组合"><a href="#一-组合" class="headerlink" title="一.组合"></a>一.组合</h2><h3 id="1-什么是组合"><a href="#1-什么是组合" class="headerlink" title="1.什么是组合?"></a>1.什么是组合?</h3><p>组合指的就是一个对象中包含这另外一个或多个对象</p>
<ul>
<li>在继承中:</li>
</ul>
<p>继承是类与类的关系,子类继承父类的属性和方法,子类与父类属于从属关系</p>
<ul>
<li>在组合中:</li>
</ul>
<p>组合是对象与对象的关系,一个对象拥有另外一个对象的属性和方法,是一种包含关系</p>
<h3 id="2-为什么要用组合"><a href="#2-为什么要用组合" class="headerlink" title="2.为什么要用组合?"></a>2.为什么要用组合?</h3><p>为了减少代码冗余<br>与继承相比<br>耦合度低,程序可扩展性高</p>
<h3 id="3-组合怎么用"><a href="#3-组合怎么用" class="headerlink" title="3.组合怎么用?"></a>3.组合怎么用?</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 组合实现</span></span><br><span class="line"><span class="comment"># 父类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OldPeople</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age, sex)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line">        self.sex = sex</span><br><span class="line"></span><br><span class="line"><span class="comment"># 学生类(子类)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OldStudent</span><span class="params">(OldPeople)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age, sex)</span>:</span></span><br><span class="line">        super().__init__(name, age, sex)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 老师类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OldPeople</span><span class="params">(OldPeople)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age, sex)</span>:</span></span><br><span class="line">        super().__init__(name, age, sex)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#日期类:</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Brith</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, year, month, day)</span>:</span></span><br><span class="line">        self.year = year</span><br><span class="line">        self.month = month</span><br><span class="line">        self.day = day</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tell_brith</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">f'''</span></span><br><span class="line"><span class="string">               ===== 出生年月日 =====</span></span><br><span class="line"><span class="string">                   年: <span class="subst">&#123;self.year&#125;</span></span></span><br><span class="line"><span class="string">                   月: <span class="subst">&#123;self.month&#125;</span></span></span><br><span class="line"><span class="string">                   日: <span class="subst">&#123;self.day&#125;</span></span></span><br><span class="line"><span class="string">               '''</span>)</span><br><span class="line"></span><br><span class="line">stu1 = OldStudent(<span class="string">'sean'</span>, <span class="number">19</span>, <span class="string">'female'</span>)</span><br><span class="line">Brith_obj = Brith(<span class="number">2000</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">stu1.Brith_obj = Brith_obj  <span class="comment"># 等于在学生类下面添加了一个self.Brith_obj = Brith_obj</span></span><br><span class="line">print(stu1.Brith_obj.year, stu1.Brith_obj.month,  stu1.Brith_obj.day)</span><br><span class="line">stu1.Brith_obj.tell_brith()<span class="comment"># 会从学生类的对象引用日期类对象的方法</span></span><br></pre></td></tr></table></figure>

<p>练习需求:</p>
<p>选课系统:</p>
<p>1.有学生、老师类，学生与老师有属性 “名字、年龄、性别、课程”，</p>
<p>2.有方法 老师与学生可以添加课程， 打印学习/教授课程。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">People</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age, sex)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line">        self.sex = sex</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 打印出生日期方法</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tell_birth</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">f'''</span></span><br><span class="line"><span class="string">        年: <span class="subst">&#123;self.date_obj.year&#125;</span></span></span><br><span class="line"><span class="string">        月: <span class="subst">&#123;self.date_obj.month&#125;</span></span></span><br><span class="line"><span class="string">        日: <span class="subst">&#123;self.date_obj.day&#125;</span></span></span><br><span class="line"><span class="string">        '''</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 添加课程</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_course</span><span class="params">(self, course_obj)</span>:</span></span><br><span class="line">        <span class="comment"># self.course_name = course_name</span></span><br><span class="line">        <span class="comment"># self.course_price = course_price</span></span><br><span class="line">        <span class="comment"># self.course_time = course_time</span></span><br><span class="line">        self.course_list.append(course_obj)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 打印当前对象中课程列表的所有课程信息</span></span><br><span class="line">    <span class="comment"># ---》 打印所有课程</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tell_all_course_info</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># 从当前对象中课程列表中取出所有的课程对象</span></span><br><span class="line">        <span class="keyword">for</span> course_obj <span class="keyword">in</span> self.course_list:</span><br><span class="line">            <span class="comment"># 通过课程对象.打印课程信息方法</span></span><br><span class="line">            course_obj.tell_course_info()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(People)</span>:</span></span><br><span class="line">    <span class="comment"># 假设从程序开始到灭亡  在实例化时都不修改该对象的属性</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age, sex)</span>:</span></span><br><span class="line">        super().__init__(name, age, sex)</span><br><span class="line">        self.course_list = []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Teacher</span><span class="params">(People)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age, sex)</span>:</span></span><br><span class="line">        super().__init__(name, age, sex)</span><br><span class="line">        self.course_list = []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Date</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, year, month, day)</span>:</span></span><br><span class="line">        self.year = year</span><br><span class="line">        self.month = month</span><br><span class="line">        self.day = day</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个课程类: 课程有: 课程名称, 课程价格, 课程周期</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Course</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, course_name, course_price, course_time)</span>:</span></span><br><span class="line">        self.course_name = course_name</span><br><span class="line">        self.course_price = course_price</span><br><span class="line">        self.course_time = course_time</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 定义打印课程方法   ： 只打印一个课程信息</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tell_course_info</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">f'''</span></span><br><span class="line"><span class="string">        ====== 课程信息如下 ======</span></span><br><span class="line"><span class="string">        课程名称: <span class="subst">&#123;self.course_name&#125;</span></span></span><br><span class="line"><span class="string">        课程价格: <span class="subst">&#123;self.course_price&#125;</span></span></span><br><span class="line"><span class="string">        课程周期: <span class="subst">&#123;self.course_time&#125;</span></span></span><br><span class="line"><span class="string">        '''</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建学生对象</span></span><br><span class="line">stu1 = Student(<span class="string">'HCY'</span>, <span class="number">2000</span>, <span class="string">'female &amp; male'</span>)</span><br><span class="line">date_obj = Date(<span class="string">'公元19'</span>, <span class="string">'11'</span>, <span class="string">'11'</span>)</span><br><span class="line">stu1.date_obj = date_obj</span><br><span class="line"><span class="comment"># stu1.tell_birth()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建课程对象</span></span><br><span class="line">python_obj = Course(<span class="string">'python'</span>, <span class="number">77777</span>, <span class="number">6</span>)</span><br><span class="line">go_obj = Course(<span class="string">'go'</span>, <span class="number">88888</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 当前学生添加了课程对象</span></span><br><span class="line"><span class="comment"># 添加python课程</span></span><br><span class="line">stu1.add_course(python_obj)</span><br><span class="line"><span class="comment"># 添加go课程</span></span><br><span class="line">stu1.add_course(go_obj)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 当前学生打印所有课程信息</span></span><br><span class="line">stu1.tell_all_course_info()</span><br></pre></td></tr></table></figure>

<h2 id="二-封装"><a href="#二-封装" class="headerlink" title="二.封装"></a>二.封装</h2><h3 id="1什么是封装"><a href="#1什么是封装" class="headerlink" title="1什么是封装?"></a>1什么是封装?</h3><p>封装就是将一堆属性和方法整合到一起封装到对象中</p>
<h3 id="2-为什么要用封装"><a href="#2-为什么要用封装" class="headerlink" title="2.为什么要用封装?"></a>2.为什么要用封装?</h3><p>封装就是为了方便存取属性和方法,通过<strong>“对象.”</strong>的方式就能存放/获取属性和方法</p>
<h3 id="3-封装怎么用"><a href="#3-封装怎么用" class="headerlink" title="3.封装怎么用"></a>3.封装怎么用</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span>:</span></span><br><span class="line">	x = <span class="number">10</span></span><br><span class="line">   <span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">()</span>:</span></span><br><span class="line">   	<span class="keyword">pass</span></span><br><span class="line">obj = User()</span><br><span class="line">obj.y = <span class="number">20</span>           <span class="comment"># 添加一个新的属性y = 20,这就是封装</span></span><br><span class="line">obj ---&gt; x, func, y  # obj对象可以取用这些属性和方法</span><br></pre></td></tr></table></figure>

<p>同时,在封装到对象或类中的属性和方法,我们可以控制对他们的访问,分两步实现,隐藏和开放接口,我们<strong>自己(非官方)</strong>命名这种隐藏和开放的方式为<strong>限制访问机制</strong></p>
<h3 id="4-什么是限制访问机制"><a href="#4-什么是限制访问机制" class="headerlink" title="4.什么是限制访问机制"></a>4.什么是限制访问机制</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line">凡是在类内部定义的属性或方法，以__（双下划线）开头的属性或方法名，都会被限制，外部不能 “直接访问” 该属性原型。</span><br><span class="line">PS： 看着像将该属性或方法隐藏起来了。</span><br><span class="line"><span class="comment"># python特有的:注意: 凡是在类内部定义 __开头的属性或方法，都会变形为 _类名 __属性/方法。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">为什么要使用这种机制:</span><br><span class="line">    就是为了不让外部轻易获得被隐藏的属性和方法</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">举个例子:</span><br><span class="line">    <span class="comment"># 隐藏属性</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span>:</span></span><br><span class="line"> <span class="comment"># 以__开头的属性</span></span><br><span class="line">	__name = <span class="string">'sean'</span>  <span class="comment"># __name变成了_User__name</span></span><br><span class="line"></span><br><span class="line"> <span class="comment"># 以__开头的方法</span></span><br><span class="line"> 	<span class="function"><span class="keyword">def</span> <span class="title">__eat</span><span class="params">(self)</span>:</span>  <span class="comment"># __eat变成了_User__eat</span></span><br><span class="line">  		print(<span class="string">'from user'</span>)</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(self)</span>:</span>  <span class="comment"># 在类的内部可以直接访问变形的方法或属性</span></span><br><span class="line">        self.__eat()</span><br><span class="line"></span><br><span class="line">obj = User()</span><br><span class="line"><span class="comment"># print(obj.__name) # 报错,提示没有此属性</span></span><br><span class="line">print(obj._User__name)  <span class="comment"># __name变成了_User__name</span></span><br><span class="line"><span class="comment"># obj.__eat()   # 报错,提示没有此方法</span></span><br><span class="line">obj._User__eat() <span class="comment"># __eat变成了_User__eat</span></span><br><span class="line">obj.func()  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意:</span></span><br><span class="line"><span class="number">1.</span>在类外部无法直接访问双下划线开头的属性,但是知道了类名和属性名就可以拼出名字:_类名__属性,然后就可以访问了,所以说这种限制没有严格意义上的限制外部访问,仅仅只是语法意义上的变形</span><br><span class="line">    </span><br><span class="line"><span class="number">2.</span>在类内部是可以直接访问双下划线开头的属性的(注意不能跨类访问)</span><br><span class="line">因为在类定义阶段内部双下滑线开头的属性统一发生了形变</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fa</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'from A'</span>)  <span class="comment"># 在定义阶段已经变形了,不能访问到其他类里面</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.fa()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span><span class="params">(A)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__fa</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'from B'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">b = B()</span><br><span class="line">b.test()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果:from A</span></span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>变形操作只在类定义阶段发生一次,在类定义之后的赋值操作,不会变形</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义属性就是为了使用,所以隐藏不是目的,将数据隐藏只是为了限制类外部直接对数据进行操作,然后类内部应该提供相应的接口允许类外部间接的操作接口,接口之上可以附加额外的逻辑来对数据的操作进行严格的控制</span></span><br><span class="line"></span><br><span class="line">举例:隐藏函数的属性</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">ATM</span>:</span></span><br><span class="line">    <span class="comment"># 取钱功能:</span></span><br><span class="line">    <span class="comment"># 1.插入磁卡</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__insert_card</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'开始插卡...'</span>)</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2.输入密码</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__input_pwd</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'输入密码...'</span>)</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3.输入取款金额</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__input_bal</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'输入取款金额...'</span>)</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 4.吐钱</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__output_money</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'开始吐钱...'</span>)</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 5.打印流水账单</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__print_flow</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'打印流水账单...'</span>)</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 取款顺序规范接口:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">withdraw</span><span class="params">(self)</span>:</span> <span class="comment"># 只需要一个对外取款接口,其他的都可以隐藏起来</span></span><br><span class="line">        <span class="comment"># 1.插入磁卡</span></span><br><span class="line">        self.__insert_card()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 2.输入密码</span></span><br><span class="line">        self.__input_pwd()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 3.输入取款金额</span></span><br><span class="line">        self.__input_bal()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 4.吐钱</span></span><br><span class="line">        self.__output_money()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 5.打印流水账单</span></span><br><span class="line">        self.__print_flow()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">amt_obj = ATM()</span><br><span class="line">amt_obj.withdraw()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 隐藏据属性:</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="class"><span class="keyword">class</span> <span class="title">Teacher</span>:</span></span><br><span class="line"><span class="meta">... </span>    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,name,age)</span>:</span> <span class="comment">#将名字和年纪都隐藏起来</span></span><br><span class="line"><span class="meta">... </span>        self.__name=name</span><br><span class="line"><span class="meta">... </span>        self.__age=age</span><br><span class="line"><span class="meta">... </span>    <span class="function"><span class="keyword">def</span> <span class="title">tell_info</span><span class="params">(self)</span>:</span> <span class="comment">#对外提供访问老师信息的接口</span></span><br><span class="line"><span class="meta">... </span>        print(<span class="string">'姓名:%s,年龄:%s'</span> %(self.__name,self.__age))</span><br><span class="line"><span class="meta">... </span>    <span class="function"><span class="keyword">def</span> <span class="title">set_info</span><span class="params">(self,name,age)</span>:</span> <span class="comment">#对外提供设置老师信息的接口，并附加类型检查的逻辑</span></span><br><span class="line"><span class="meta">... </span>        <span class="keyword">if</span> <span class="keyword">not</span> isinstance(name,str):</span><br><span class="line"><span class="meta">... </span>            <span class="keyword">raise</span> TypeError(<span class="string">'姓名必须是字符串类型'</span>)</span><br><span class="line"><span class="meta">... </span>        <span class="keyword">if</span> <span class="keyword">not</span> isinstance(age,int):</span><br><span class="line"><span class="meta">... </span>            <span class="keyword">raise</span> TypeError(<span class="string">'年龄必须是整型'</span>)</span><br><span class="line"><span class="meta">... </span>        self.__name=name</span><br><span class="line"><span class="meta">... </span>        self.__age=age</span><br><span class="line"><span class="meta">... </span></span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t=Teacher(<span class="string">'lili'</span>,<span class="number">18</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t.set_info(‘LiLi<span class="string">','</span><span class="number">19</span><span class="string">') # 年龄不为整型，抛出异常</span></span><br><span class="line"><span class="string">Traceback (most recent call last):</span></span><br><span class="line"><span class="string">  File "&lt;stdin&gt;", line 1, in &lt;module&gt;</span></span><br><span class="line"><span class="string">  File "&lt;stdin&gt;", line 11, in set_info</span></span><br><span class="line"><span class="string">TypeError: 年龄必须是整型</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; t.set_info('</span>LiLi<span class="string">',19) # 名字为字符串类型，年龄为整形，可以正常设置</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; t.tell_info() # 查看老师的信息</span></span><br><span class="line"><span class="string">姓名:LiLi,年龄:19</span></span><br></pre></td></tr></table></figure>

<p>总结隐藏属性与开放接口，本质就是为了明确地区分内外，类内部可以修改封装内的东西而不影响外部调用者的代码；而类外部只需拿到一个接口，只要接口名、参数不变，则无论设计者如何改变内部实现代码，使用者均无需改变代码。这就提供一个良好的合作基础，只要接口这个基础约定不变，则代码的修改不足为虑。</p>
<h3 id="5-property"><a href="#5-property" class="headerlink" title="5.property"></a>5.property</h3><ul>
<li><h4 id="什么是poperty"><a href="#什么是poperty" class="headerlink" title="什么是poperty"></a>什么是poperty</h4><p>是一个python内置的装饰器，可以装饰在”类内部的方法”上。可以将该方法调用方式由 —-&gt; 对象.方法() —&gt; 对象.方法,就是将调用函数方法伪装成调用数据属性,当调用此方法时会将该函数方法的结果返回出来</p>
</li>
<li><p>为什么要使用property</p>
<p>PS: 在某些场景下，调用的方法只是用来获取计算后的某个值。</p>
<p>PS: 必须通过 对象.方法() 方式调用，让该方法看起来像动词。</p>
</li>
<li><p>怎么使用property</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">People</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, weight, height)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.weight = weight</span><br><span class="line">        self.height = height</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">    @property  </span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bmi</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.weight / (self.height ** <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">obj = People(<span class="string">'lili'</span>, <span class="number">75</span>, <span class="number">1.85</span>)</span><br><span class="line">print(obj.bmi)  <span class="comment"># 不需要通过方法()就可以得到结果,伪装成通过属性得到结果 </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">使用property有效地保证了属性访问的一致性。另外property还提供设置和删除属性的功能</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, val)</span>:</span></span><br><span class="line">        self.__NAME = val  <span class="comment"># 将属性隐藏起来</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">name</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.__NAME</span><br><span class="line"></span><br><span class="line"><span class="meta">    @name.setter  # 如果需要修改值,必须再写一次方法,并且需要修改的方法名字要与被property装饰器后的方法一样,括号里面要添加一个value</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">name</span><span class="params">(self, value)</span>:</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> isinstance(value, str):  <span class="comment"># 在设定值之前进行类型检查</span></span><br><span class="line">            <span class="keyword">raise</span> TypeError(<span class="string">'%s must be str'</span> %value)</span><br><span class="line"></span><br><span class="line">        self.__NAME = value  <span class="comment"># 通过类型检查后,将值value存放到真实的位置self.__NAME</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @name.deleter  # 删除是在内部删除,在外部也要写上 del f.name</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">name</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">raise</span> PermissionError(<span class="string">'Can not delete'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f = Foo(<span class="string">'lili'</span>)</span><br><span class="line">f.name</span><br><span class="line"><span class="comment"># lili</span></span><br><span class="line">f = Foo(<span class="string">'lili'</span>)</span><br><span class="line">print(f.name)</span><br><span class="line"><span class="comment"># # lili</span></span><br><span class="line"><span class="comment"># # f.name = '123'  # 触发name.setter对应的的函数name(f,123),抛出异常TypeError</span></span><br><span class="line">f.name = <span class="string">'egon'</span>  <span class="comment"># 触发name.setter装饰器对应的函数name(f,’Egon')</span></span><br><span class="line">print(f.name)</span><br><span class="line"><span class="comment"># # del f.name  # 触发name.deleter对应的函数name(f),抛出异常PermissionError</span></span><br><span class="line"><span class="comment"># f.name = 'LiLi'  # 触发name.setter装饰器对应的函数name(f,’Egon')</span></span><br><span class="line"><span class="comment"># f.name = '123'  # 触发name.setter对应的的函数name(f,123),抛出异常TypeError</span></span><br><span class="line"><span class="comment"># del f.name  # 触发name.deleter对应的函数name(f),抛出异常PermissionError</span></span><br></pre></td></tr></table></figure>

<h1 id="面向对象三大特性之多态"><a href="#面向对象三大特性之多态" class="headerlink" title="面向对象三大特性之多态"></a>面向对象三大特性之多态</h1><h2 id="1-什么叫多态"><a href="#1-什么叫多态" class="headerlink" title="1.什么叫多态"></a>1.什么叫多态</h2><p>多态指的是同一种类型的事物，不同的形态。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span>:</span>    <span class="comment"># 将方法统一成父类的call</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">call</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pig</span><span class="params">(Animal)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">call</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'哼哧哼哧'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span><span class="params">(Animal)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">call</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'汪汪汪'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span><span class="params">(Animal)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">call</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'喵喵喵'</span>)</span><br><span class="line"></span><br><span class="line">实例化得到三个对象</span><br><span class="line">pig_obj = Pig()</span><br><span class="line">dog_obj = Dog()</span><br><span class="line">cat_obj = Cat()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">多态性指的是可以在不用考虑对象具体类型的情况下而直接使用对象，这就需要在设计时，把对象的使用方法统一成一种：例如cat、dog、pig都是动物,但凡是动物肯定有call方法，于是我们可以不用考虑它们三者的具体是什么类型的动物,而直接使用</span><br><span class="line"></span><br><span class="line">cat_obj.call()</span><br><span class="line">pig_obj.call()</span><br><span class="line">dog_obj.call()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">输出结果：</span><br><span class="line">喵喵喵</span><br><span class="line">哼哧哼哧</span><br><span class="line">汪汪汪</span><br></pre></td></tr></table></figure>

<h2 id="2-多态的目的"><a href="#2-多态的目的" class="headerlink" title="2.多态的目的"></a>2.多态的目的</h2><p>“多态” 也称之为 “多态性”，目的是为了 在不知道对象具体类型的情况下，统一对象调用方法的规范</p>
<p>多态的表现 “形式之一” 就是继承:</p>
<ul>
<li>先抽象，再继承</li>
</ul>
<p>父类: 定制一套统一的规范。（比如: 方法名统一）</p>
<p>子类: 遵循父类的统一的规范。（比如: 子类遵循父类方法名的统一）</p>
<p>综上我们得知，多态性的本质在于不同的类中定义有相同的方法名，这样我们就可以不考虑类而统一用一种方式去使用对象，可以通过在父类引入抽象类的概念来硬性限制子类必须有某些方法名</p>
<p><strong>注意: 在python中不会强制限制 子类 必须要遵循 父类 的规范，所以出现了抽象类</strong></p>
<h2 id="3-什么是抽象类"><a href="#3-什么是抽象类" class="headerlink" title="3.什么是抽象类"></a>3.什么是抽象类</h2><p>在python内置的<strong>abc模块</strong>中，有一个抽象类(ABCMeta).</p>
<h2 id="4-抽象类的作用"><a href="#4-抽象类的作用" class="headerlink" title="4.抽象类的作用:"></a>4.抽象类的作用:</h2><p>让子类必须遵循父类的编写规范。</p>
<h2 id="5-如何实现抽象类"><a href="#5-如何实现抽象类" class="headerlink" title="5.如何实现抽象类"></a>5.如何实现抽象类</h2><ul>
<li><p>先导入abc模块，父类需要继承abc模块，在父类名添加括号，括号内写上（metaclass=abc.ABCMeta）</p>
</li>
<li><p>在父类的方法中，需要装饰上 abc.abstractmethod</p>
</li>
</ul>
<p>注意: 如果使用抽象类，子类必须按照父类的方法编写规范，缺一不可。（只要父类中有几个抽象方法，子类就必须要定义几个）’’’</p>
<p>注意: 在python中<strong>不推荐使用抽象类。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> abc </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span><span class="params">(metaclass=abc.ABCMeta)</span>:</span>    <span class="comment"># 注意 </span></span><br><span class="line">    <span class="comment"># @abc.abstractclassmethod   # 会有一条线在上面，表示虽然可以用，但是正在被弃用</span></span><br><span class="line"><span class="meta">    @abc.abstractmethod    # 父类中规范的方法装饰上abstractmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">call</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pig</span><span class="params">(Animal)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">call</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'哼哧哼哧'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span><span class="params">(Animal)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tell</span><span class="params">(self)</span>:</span>   <span class="comment"># 改成其他与父类规定的方法不同就会被报错</span></span><br><span class="line">        print(<span class="string">'汪汪汪'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span><span class="params">(Animal)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">call</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'喵喵喵'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pig_obj = Pig()</span><br><span class="line">dog_obj = Dog()</span><br><span class="line">cat_obj = Cat()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cat_obj.call()</span><br><span class="line">pig_obj.call()</span><br><span class="line">dog_obj.tell()</span><br><span class="line"><span class="comment"># TypeError: Can't instantiate abstract class Dog with abstract methods call</span></span><br></pre></td></tr></table></figure>

<h2 id="6-什么是鸭子类型"><a href="#6-什么是鸭子类型" class="headerlink" title="6.什么是鸭子类型"></a>6.什么是鸭子类型</h2><p>我们完全可以不依赖于继承，只需要制造出外观和行为相同对象，同样可以实现不考虑对象类型而使用对象，这正是Python崇尚的“鸭子类型”（duck typing） 不同的对象，只要长得像鸭子，动作行为像鸭子，那它就是鸭子!</p>
<p>鸭子类型是多态的一种表现形式</p>
<h2 id="7-为什么要有鸭子类型？"><a href="#7-为什么要有鸭子类型？" class="headerlink" title="7.为什么要有鸭子类型？"></a>7.为什么要有鸭子类型？</h2><p>不同对象，先抽象出相同类型的方法，给他们定制一套统一的规范。</p>
<p>所有的类，在定义时都按照统一的规范进行编写。</p>
<p>多态的三种表现形式:</p>
<ul>
<li><p>继承父类</p>
<p>耦合度高，程序的可扩展性低</p>
</li>
<li><p>继承抽象类</p>
<p>耦合度极高，程序的可扩展性极低</p>
</li>
<li><p>鸭子类型:</p>
</li>
</ul>
<p>耦合度低，程序的可扩展性高</p>
<p>注意: 在python中，强烈推荐使用鸭子类型。’’’</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pig</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">call</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'哼哧哼哧'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">call</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'汪汪汪'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">call</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'喵喵喵'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pig_obj = Pig()</span><br><span class="line">dog_obj = Dog()</span><br><span class="line">cat_obj = Cat()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cat_obj.call()</span><br><span class="line">pig_obj.call()</span><br><span class="line">dog_obj.call()</span><br></pre></td></tr></table></figure>

<h2 id="8-classmethod与staticmethod"><a href="#8-classmethod与staticmethod" class="headerlink" title="8.classmethod与staticmethod"></a>8.classmethod与staticmethod</h2><p>classmethod与staticmethod都是python解释器内置的装饰器。</p>
<p>classmethod: 是一个装饰器，给在类内部定义方法中装饰，将类内部的方法变为 “类的绑定方法”。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DB</span>:</span></span><br><span class="line">    __date = <span class="string">'tnank is very handsome!!!'</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, user, pwd, role)</span>:</span></span><br><span class="line">        self.user = user</span><br><span class="line">        self.pwd = pwd</span><br><span class="line">        self.role = role</span><br><span class="line"></span><br><span class="line"><span class="comment"># 类绑定方式</span></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">check_db</span><span class="params">(cls, user, pwd, role)</span>:</span></span><br><span class="line">        <span class="comment"># 在类方法内部调用类产生一个实例 ---》 对象</span></span><br><span class="line">        obj = cls(user, pwd, role)</span><br><span class="line">        <span class="keyword">if</span> obj.user == <span class="string">'tank'</span> <span class="keyword">and</span> obj.pwd == <span class="string">'123'</span> <span class="keyword">and</span> obj.role == <span class="string">'admin'</span>:</span><br><span class="line">            print(<span class="string">'检验通过'</span>)</span><br><span class="line">            print(cls.__date)</span><br><span class="line">            <span class="keyword">return</span> cls.__date</span><br><span class="line"><span class="comment"># 对象绑定方式</span></span><br><span class="line"><span class="comment">#     def check_db(self, user, pwd, role):</span></span><br><span class="line"><span class="comment">#         # obj = self(user, pwd, role)</span></span><br><span class="line"><span class="comment">#         if self.user == 'tank' and self.pwd == '123' and self.role == 'admin':</span></span><br><span class="line"><span class="comment">#             print('检验通过')</span></span><br><span class="line"><span class="comment">#             print(self.__date)</span></span><br><span class="line"><span class="comment">#             return self.__date</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 类的绑定方式</span></span><br><span class="line">DB.check_db(<span class="string">'tank'</span>, <span class="string">'123'</span>, <span class="string">'admin'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对象绑定方式</span></span><br><span class="line"><span class="comment"># db_obj = DB('tank', '123', 'admin')</span></span><br><span class="line"><span class="comment"># db_obj.check_db('tank', '123', 'admin')</span></span><br><span class="line"><span class="comment"># # __class__"查看当前对象的类</span></span><br><span class="line"><span class="comment"># print(db_obj.__class__)</span></span><br></pre></td></tr></table></figure>

<p>staticmethod： 翻译: 静态方法 是一个装饰器，给在类内部定义方法中装饰，将类内部的方法变为 “非绑定方法”。</p>
<ul>
<li><p>对象的绑定方法:</p>
<p>由对象来调用，由谁来调用，会将谁(对象)当做第一个参数传入。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>:</span></span><br><span class="line"></span><br><span class="line">    对象绑定方法</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(self)</span><br><span class="line">        </span><br><span class="line"><span class="comment"># 对象绑定方法</span></span><br><span class="line">obj = Foo()</span><br><span class="line">obj.func()  <span class="comment"># 会将对象当成第一个参数传给self</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>类的绑定方法:</p>
</li>
</ul>
<p>由类来调用，由谁来调用，会将谁(类)当做第一个参数传入。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>:</span></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(self)</span><br><span class="line">        </span><br><span class="line"><span class="comment">#类绑定方法</span></span><br><span class="line">Foo.func()</span><br><span class="line"> <span class="comment"># 会将类当成第一个参数传给self</span></span><br></pre></td></tr></table></figure>

<ul>
<li>非绑定方法:</li>
</ul>
<p>可以由对象或类来调用，谁来调用都是一个普通方法(普通函数)，方法需要传入几个参数，就得传入几个。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>:</span></span><br><span class="line"><span class="comment"># 非绑定方法</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(self)</span><br><span class="line">  <span class="comment"># 非绑定方法</span></span><br><span class="line">Foo.func(<span class="number">12</span>)<span class="comment"># 可以通过类调用，但是必须得传参，需要几个传几个</span></span><br><span class="line"></span><br><span class="line">obj = Foo()<span class="comment"># 也可以通过对象调用，也是必须得传参，需要几个传几个</span></span><br><span class="line">obj.func(<span class="number">12</span>)</span><br></pre></td></tr></table></figure>

<h2 id="9-isinstance与issubclass"><a href="#9-isinstance与issubclass" class="headerlink" title="9.isinstance与issubclass"></a>9.isinstance与issubclass</h2><p>isinstance和issubclass是python的内置模块</p>
<ul>
<li><p>isinstance: 判断一个对象是否是另一个类的实例。</p>
<p>如果是: True</p>
<p>如果不是: False</p>
</li>
<li><p>issubclass: 判断一个类是否是另一个类的子类。</p>
<p>如果是: True</p>
<p>如果不是: False</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#isinstance:</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Boo</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">foo_obj = Foo()</span><br><span class="line">boo_obj = Boo()</span><br><span class="line"><span class="comment"># 前一个参数是对象名，后一个参数是类名</span></span><br><span class="line">print(isinstance(foo_obj, Foo))  <span class="comment"># True</span></span><br><span class="line">print(isinstance(boo_obj, Foo))  <span class="comment"># False</span></span><br><span class="line"><span class="comment"># issubclass</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Father</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sub</span><span class="params">(Father)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 前一个参数是字类名，后一个参数是父类名</span></span><br><span class="line">print(issubclass(Sub, Father))  <span class="comment"># True</span></span><br><span class="line">print(issubclass(Foo, Father))  <span class="comment"># False</span></span><br></pre></td></tr></table></figure>

<h2 id="10-反射"><a href="#10-反射" class="headerlink" title="10.反射"></a>10.反射</h2><p>反射: 反射指的是通过 “字符串” 对 对象的属性进行操作。</p>
<ul>
<li>hasattr: 通过 “字符串” 判断对象的属性或方法是否存在。</li>
<li>getattr: 通过 “字符串” 获取对象的属性或方法。</li>
<li>setattr: 通过 “字符串” 设置对象的属性或方法。</li>
<li>delattr: 通过 “字符串” 删除对象的属性或方法。</li>
</ul>
<p>注意: 反射的四个方法是python内置的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, x, y)</span>:</span></span><br><span class="line">        self.x = x</span><br><span class="line">        self.y = y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">foo_obj = Foo(<span class="number">10</span>, <span class="number">20</span>)</span><br><span class="line"><span class="comment">#hasattr</span></span><br><span class="line"><span class="comment">#通过字符串x 判断对象中是否有 x属性</span></span><br><span class="line">print(hasattr(foo_obj, <span class="string">'x'</span>))  <span class="comment"># True</span></span><br><span class="line">print(hasattr(foo_obj, <span class="string">'y'</span>))  <span class="comment"># True</span></span><br><span class="line">print(hasattr(foo_obj, <span class="string">'z'</span>))  <span class="comment"># False</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#getattr</span></span><br><span class="line">res = getattr(foo_obj, <span class="string">'x'</span>)</span><br><span class="line">print(res)  <span class="comment"># 10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#若属性不存在，则返回默认值</span></span><br><span class="line">res = getattr(foo_obj, <span class="string">'z'</span>, <span class="string">'默认值'</span>) <span class="comment"># 默认值可以设置</span></span><br><span class="line">print(res)  <span class="comment"># 默认值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#setattr</span></span><br><span class="line"><span class="comment">#为foo_obj设置一个属性z，值为30</span></span><br><span class="line">setattr(foo_obj, <span class="string">'z'</span>, <span class="number">30</span>)</span><br><span class="line">print(hasattr(foo_obj, <span class="string">'z'</span>))  <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#delattr</span></span><br><span class="line">delattr(foo_obj, <span class="string">'x'</span>)</span><br><span class="line">print(hasattr(foo_obj, <span class="string">'x'</span>))  <span class="comment"># False</span></span><br><span class="line"><span class="comment"># 反射应用:</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileControl</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="comment"># 让用户输入上传或下载功能的命令:</span></span><br><span class="line">            user_input = input(<span class="string">'请输入 上传(upload) 或 下载(download) 功能:'</span>).strip()</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 通过用户输入的字符串判断方法是否存在，然后调用相应的方法</span></span><br><span class="line">            <span class="keyword">if</span> hasattr(self, user_input):</span><br><span class="line">                func = getattr(self, user_input)</span><br><span class="line">                func()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(<span class="string">'输入有误!'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">upload</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'文件正在上传...'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">download</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'文件正在下载...'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">file_control_obj = FileControl()</span><br><span class="line">file_control_obj.run()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> uuid  <span class="comment"># 用于产生随机字符串的模块</span></span><br><span class="line"></span><br><span class="line">由时间戳以及某种算法组合而成，会产生一串世界上独一无二字符串。</span><br><span class="line">print(uuid.uuid4()) <span class="comment"># 一般选择uuid4这个方法</span></span><br><span class="line"></span><br><span class="line">输出结果：<span class="number">5</span>cb5a5e6<span class="number">-9</span>b6f<span class="number">-4</span>f86<span class="number">-9</span>f70<span class="number">-3443001</span>b9525</span><br><span class="line"></span><br><span class="line">原文链接：http://www.cnblogs.com/dkblog/archive/<span class="number">2011</span>/<span class="number">10</span>/<span class="number">10</span>/<span class="number">2205200.</span>html</span><br><span class="line"> Python官方Doc：《<span class="number">20.15</span>. uuid — UUID objects according to RFC <span class="number">4122</span>》</span><br><span class="line">    UUID的算法介绍：《A Universally Unique IDentifier (UUID) URN Namespace》</span><br><span class="line"></span><br><span class="line">概述：</span><br><span class="line"></span><br><span class="line">    UUID是<span class="number">128</span>位的全局唯一标识符，通常由<span class="number">32</span>字节的字符串表示。</span><br><span class="line">    它可以保证时间和空间的唯一性，也称为GUID，全称为：</span><br><span class="line">            UUID —— Universally Unique IDentifier      Python 中叫 UUID</span><br><span class="line">            GUID —— Globally Unique IDentifier          C<span class="comment">#  中叫 GUID</span></span><br><span class="line"></span><br><span class="line">    它通过MAC地址、时间戳、命名空间、随机数、伪随机数来保证生成ID的唯一性。</span><br><span class="line">    UUID主要有五个算法，也就是五种方法来实现：</span><br><span class="line"></span><br><span class="line">       <span class="number">1</span>、uuid1()——基于时间戳</span><br><span class="line"></span><br><span class="line">               由MAC地址、当前时间戳、随机数生成。可以保证全球范围内的唯一性，</span><br><span class="line">               但MAC的使用同时带来安全性问题，局域网中可以使用IP来代替MAC。</span><br><span class="line"></span><br><span class="line">       <span class="number">2</span>、uuid2()——基于分布式计算环境DCE（Python中没有这个函数）</span><br><span class="line"></span><br><span class="line">                算法与uuid1相同，不同的是把时间戳的前<span class="number">4</span>位置换为POSIX的UID。</span><br><span class="line">                实际中很少用到该方法。</span><br><span class="line"></span><br><span class="line">      <span class="number">3</span>、uuid3()——基于名字的MD5散列值</span><br><span class="line"></span><br><span class="line">                通过计算名字和命名空间的MD5散列值得到，保证了同一命名空间中不同名字的唯一性，</span><br><span class="line">                和不同命名空间的唯一性，但同一命名空间的同一名字生成相同的uuid。    </span><br><span class="line"></span><br><span class="line">       <span class="number">4</span>、uuid4()——基于随机数</span><br><span class="line"></span><br><span class="line">                由伪随机数得到，有一定的重复概率，该概率可以计算出来。</span><br><span class="line"></span><br><span class="line">       <span class="number">5</span>、uuid5()——基于名字的SHA<span class="number">-1</span>散列值</span><br><span class="line"></span><br><span class="line">                算法与uuid3相同，不同的是使用 Secure Hash Algorithm <span class="number">1</span> 算法</span><br><span class="line"></span><br><span class="line">使用方面：</span><br><span class="line"></span><br><span class="line">    首先，Python中没有基于DCE的，所以uuid2可以忽略；</span><br><span class="line">    其次，uuid4存在概率性重复，由无映射性，最好不用；</span><br><span class="line">    再次，若在Global的分布式计算环境下，最好用uuid1；</span><br><span class="line">    最后，若有名字的唯一性要求，最好用uuid3或uuid5。</span><br><span class="line"></span><br><span class="line">编码方法：</span><br><span class="line"></span><br><span class="line">    <span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">import</span> uuid</span><br><span class="line"></span><br><span class="line">    name = <span class="string">"test_name"</span></span><br><span class="line">    namespace = <span class="string">"test_namespace"</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> uuid.uuid1()  <span class="comment"># 带参的方法参见Python Doc</span></span><br><span class="line">    <span class="keyword">print</span> uuid.uuid3(namespace, name)</span><br><span class="line">    <span class="keyword">print</span> uuid.uuid4()</span><br><span class="line">    <span class="keyword">print</span> uuid.uuid5(namespace, name)</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/10/28/python%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E4%B9%8B%E7%BB%A7%E6%89%BF%E5%B0%81%E8%A3%85%E5%A4%9A%E6%80%81/" data-id="ckd3cw4ic000srcut7jcg1vcm" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/" rel="tag">Python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-python面向对象" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/10/25/python%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" class="article-date">
  <time datetime="2018-10-25T12:19:20.000Z" itemprop="datePublished">2018-10-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/25/python%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/">python面向对象</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="面向对象"><a href="#面向对象" class="headerlink" title="面向对象"></a>面向对象</h1><p>在说面向对象前,先回忆一下什么是<strong>面向过程</strong></p>
<h2 id="一-面向过程"><a href="#一-面向过程" class="headerlink" title="一.面向过程"></a>一.面向过程</h2><p>面向过程即为一种编程思想,重点在’<strong>过程</strong>‘二字,过程指的就是解决问题的步骤,即先做什么,再做什么,基于该思想编写的程序就像在编写一条流水线,即是一种<strong>机械式</strong>思维</p>
<p>优点:将复杂问题流程化,简单化</p>
<p>缺点:程序扩展性差</p>
<h2 id="二-面向对象"><a href="#二-面向对象" class="headerlink" title="二.面向对象"></a>二.面向对象</h2><h3 id="1-什么是面向对象"><a href="#1-什么是面向对象" class="headerlink" title="1.什么是面向对象"></a>1.什么是面向对象</h3><p>面向对象也是一种编程思想,重点在<strong>对象</strong>二字上,<strong>对象指的就是特征与技能的结合体</strong>,基于该思想编写程序就像是创造世界,这是一种上帝式思维</p>
<p>优点:可扩展性强</p>
<p>缺点:编写复杂程度高</p>
<h2 id="2-什么是类"><a href="#2-什么是类" class="headerlink" title="2.什么是类"></a>2.什么是类</h2><p>通俗的说,类就是指的是类型,类别</p>
<p>在两种角度去看待:</p>
<ul>
<li><p>现实世界中:</p>
<p>先有一个个的对象，经过社会的文明发展，随之总结出类。对象是实际存在的，而类抽象产生的。</p>
</li>
<li><p>在程序中:</p>
<p>必须先有类，再通过“调用类，产生对象”。</p>
</li>
</ul>
<p>类:就是一系列对象相同特征与技能的结合体,对象是真实存在的,而类是人总结归纳出来的</p>
<h2 id="3-如何定义类"><a href="#3-如何定义类" class="headerlink" title="3.如何定义类"></a>3.如何定义类</h2><ul>
<li><p>如何写类并产生对象:</p>
<p>先从现实世界中通过一个个对象总结出类。</p>
<p>然后再定义类，后调用类产生对象。</p>
<p>(注意:在程序中务必保证先定义类,再调用类产生对象)</p>
</li>
<li><p>定义类的语法:</p>
<p>class 就是定义类的关键字,产生类的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">- 学生对象1:</span></span><br><span class="line"><span class="string">特征:</span></span><br><span class="line"><span class="string">    - 姓名: 马冬梅</span></span><br><span class="line"><span class="string">    - 性别: female</span></span><br><span class="line"><span class="string">    - 年龄: 95</span></span><br><span class="line"><span class="string">    - 学校: oldboy</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">- 技能:</span></span><br><span class="line"><span class="string">    - 技术: python</span></span><br><span class="line"><span class="string">    - 学习: learn</span></span><br><span class="line"><span class="string">    - 选课: course</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">- 学生对象2:</span></span><br><span class="line"><span class="string">特征:</span></span><br><span class="line"><span class="string">    - 姓名: 夏洛</span></span><br><span class="line"><span class="string">    - 性别: male</span></span><br><span class="line"><span class="string">    - 年龄: 98</span></span><br><span class="line"><span class="string">    - 学校: oldboy</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">- 技能:</span></span><br><span class="line"><span class="string">    - 技术: python</span></span><br><span class="line"><span class="string">    - 学习: learn</span></span><br><span class="line"><span class="string">    - 选课: course</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="comment"># 定义一个类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OldboyStudent</span>:</span>  <span class="comment"># 注意类名的命名规范,使用驼峰体</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 用变量表示特征(对象之间相同的特征),在类中的特征也称之为属性</span></span><br><span class="line">    school = <span class="string">'oldboy'</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 用函数表示技能(对象之间相同的技能),在类的内部定义函数,会默认有一个参数self</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">learn</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">cours</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">python</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义一个类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OldboyStudent</span>:</span>  <span class="comment"># 类名指向的是类的内存地址</span></span><br><span class="line">       </span><br><span class="line">    school = <span class="string">'oldboy'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">learn</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">cours</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">python</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">print(OldboyStudent)   </span><br><span class="line"><span class="comment"># &lt;class '__main__.OldboyStudent'&gt;</span></span><br><span class="line"></span><br><span class="line">print(OldboyStudent.__dict__) </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过.__dict__可以查看类和对象的名称空间,返回的是一个字典</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#  输出结果:&#123;'__module__': '__main__', 'school': 'oldboy', 'learn': &lt;function OldboyStudent.learn at 0x000001F0D3C10048&gt;, 'cours': &lt;function OldboyStudent.cours at 0x000001F0D3C10678&gt;, 'python': &lt;function OldboyStudent.python at 0x000001F0D3C10E58&gt;, '__dict__': &lt;attribute '__dict__' of 'OldboyStudent' objects&gt;, '__weakref__': &lt;attribute '__weakref__' of 'OldboyStudent' objects&gt;, '__doc__': None&#125;</span></span><br><span class="line"></span><br><span class="line">查</span><br><span class="line">print(OldboyStudent.__dict__[<span class="string">'school'</span>])</span><br><span class="line"><span class="comment"># 类名.名字的方式也可以获取属性</span></span><br><span class="line">print(OldboyStudent.school)   <span class="comment"># 这两种方式都可以获取名字</span></span><br><span class="line"></span><br><span class="line">print(OldboyStudent.__dict__[<span class="string">'learn'</span>])   <span class="comment"># 得到一个类里面的函数的内存地址</span></span><br><span class="line">OldboyStudent.__dict__[<span class="string">'learn'</span>](<span class="number">123</span>)  <span class="comment"># 需要传一个参数给self,函数才能执行</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">输出结果</span><br><span class="line"><span class="comment"># oldboy</span></span><br><span class="line"><span class="comment"># oldboy</span></span><br><span class="line"><span class="comment"># 类和对象都可以进行增删改查的操作</span></span><br><span class="line"></span><br><span class="line">改:</span><br><span class="line">OldboyStudent.school = <span class="string">'YongBoy'</span></span><br><span class="line">print(OldboyStudent.school)</span><br><span class="line"></span><br><span class="line">输出结果:</span><br><span class="line"><span class="comment">#  YongBoy</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">删:</span><br><span class="line"><span class="keyword">del</span> OldboyStudent.school</span><br><span class="line">print(OldboyStudent.school)</span><br><span class="line"></span><br><span class="line">输出结果:</span><br><span class="line"><span class="comment"># 报错,该特征已经被删除</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">增</span><br><span class="line"></span><br><span class="line">OldboyStudent.school = <span class="string">'goodboy'</span>  <span class="comment"># 可以新建一个属性</span></span><br><span class="line">print(OldboyStudent.school)  </span><br><span class="line"></span><br><span class="line">输出结果:</span><br><span class="line">goodboy</span><br><span class="line">    </span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="comment"># 函数的名称空间：</span></span><br><span class="line">    在调用函数时产生，函数调用结束后销毁。</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 类的名称空间:</span></span><br><span class="line">    在定义阶段时产生，会将类中所有的名字，扔进类的名称空间中。</span><br></pre></td></tr></table></figure>

<h2 id="4-对象的产生"><a href="#4-对象的产生" class="headerlink" title="4.对象的产生"></a>4.对象的产生</h2><p>调用类产生对象</p>
<p>类名 + () 调用类产生对象</p>
<p>类的名称空间在定义时产生,对象的名称空间在调用类时产生。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">调用类产生对象发生的事情:    </span><br><span class="line"><span class="number">1.</span>会产生一个空对象的名称空间    </span><br><span class="line"><span class="number">2.</span>会自动触发__init__，并且会将对象当做第一个参数传入。    </span><br><span class="line"><span class="number">3.</span>会将调用类括号内的参数一并传给__init__().</span><br><span class="line"></span><br><span class="line">school = <span class="string">'oldboy'</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, sex, age)</span>:</span>  <span class="comment"># stu1, 'tank', 'male', 17</span></span><br><span class="line">       print(self.__dict__)</span><br><span class="line"></span><br><span class="line">       <span class="comment"># 给对象添加新的属性,这些值是由stu_1 = Student('tank', 'male', 17)传入的</span></span><br><span class="line">      self.name = name  <span class="comment"># stu1.x = 'tank'</span></span><br><span class="line">      self.sex = sex  <span class="comment"># stu1.y = 'male'</span></span><br><span class="line">      self.age = age  <span class="comment"># stu1.z = 17</span></span><br><span class="line"></span><br><span class="line">       <span class="comment"># 查看当前对象的名称空间</span></span><br><span class="line">       print(self.__dict__)</span><br><span class="line"></span><br><span class="line">想要在调用类时，为对象传入对象独有 特征</span><br><span class="line">__init__(self, name, sex, age): </span><br><span class="line">stu_1 = Student(<span class="string">'tank'</span>, <span class="string">'male'</span>, <span class="number">17</span>)</span><br><span class="line"><span class="comment"># name---&gt; tank ,  sex---&gt; male,  age----&gt; 17</span></span><br><span class="line">调用类时: 会将对象当做第一个参数，与括号内所有的参数一并传给__init__() stu1 = </span><br><span class="line">                    <span class="comment"># 发生的过程</span></span><br><span class="line"><span class="comment"># stu1 = Student()  # Student(stu1)  ---&gt; __init__(self)  ----&gt; self == stu1</span></span><br><span class="line"><span class="comment"># stu2 = Student()  # Student(stu2)  ---&gt; __init__(self)  ----&gt; self == stu2</span></span><br><span class="line"><span class="comment"># stu3 = Student()  # Student(stu3)  ---&gt; __init__(self)  ----&gt; self == stu3</span></span><br><span class="line"><span class="comment"># 单独给每个对象添加独有的属性</span></span><br><span class="line"><span class="comment"># stu1.name = 'tank'</span></span><br><span class="line"><span class="comment"># stu1.sex = 'female'</span></span><br><span class="line"><span class="comment"># stu1.age = 84   </span></span><br><span class="line"><span class="comment"># print(stu1.name, stu1.sex, stu1.age)</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># print(stu1)</span></span><br><span class="line"><span class="comment"># print(stu2)</span></span><br><span class="line"><span class="comment"># print(stu3)</span></span><br></pre></td></tr></table></figure>

<h2 id="5-调用类产生对象的过程称之为类的实例化，"><a href="#5-调用类产生对象的过程称之为类的实例化，" class="headerlink" title="5.调用类产生对象的过程称之为类的实例化，"></a>5.调用类产生对象的过程称之为类的实例化，</h2><p>对象称之为类的一个实例。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OldboyStudent</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 用变量表示特征(对象之间相同的特种)</span></span><br><span class="line">    school = <span class="string">'oldboy'</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 用函数表示技能(对象之间相同的技能)----&gt;技能就是指方法(method)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">learn</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">obj_1 = OldboyStudent()  <span class="comment"># 类名 + () 调用类产生对象</span></span><br><span class="line">obj_2 = OldboyStudent()  <span class="comment"># 产生的对象地址都是不同的 </span></span><br><span class="line">obj_3 = OldboyStudent()</span><br><span class="line">print(OldboyStudent)  <span class="comment"># &lt;class '__main__.OldboyStudent'&gt;</span></span><br><span class="line">print(obj_1) <span class="comment">#&lt;__main__.OldboyStudent object at 0x0000025D6E71E348&gt;</span></span><br><span class="line">print(obj_2) <span class="comment"># &lt;__main__.OldboyStudent object at 0x0000025D6E71E908&gt;</span></span><br><span class="line">print(obj_3) <span class="comment"># &lt;__main__.OldboyStudent object at 0x0000025D759FA5C8&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(obj_1.school)  <span class="comment"># 也可以通过对象调用特征属性和函数技能</span></span><br><span class="line">print(obj_1.learn())  <span class="comment"># 对象调用方法时会将对象本身作为第一个参数传入</span></span><br><span class="line">print(OldboyStudent.learn(<span class="string">'123'</span>)) <span class="comment"># 通过类调用函数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 两种方式调用的函数是同一个内存地址的函数,但是不同的对象调用同一个函数会产生一个独立的内存地址</span></span><br></pre></td></tr></table></figure>

<p>由对象来调用类内部的函数，称之为对象的绑定方法。<br>对象的绑定方法特殊之处: 会将对象当做第一个参数传给该方法。</p>
<h2 id="6-对象名字的查找顺序"><a href="#6-对象名字的查找顺序" class="headerlink" title="6.对象名字的查找顺序"></a>6.对象名字的查找顺序</h2><p>对象名字的查找顺序：</p>
<p>1.对象.属性，会先找对象自己的。</p>
<p>2.若对象没有，会去找类的。</p>
<p>3.若类没有，则会报错。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">People</span>:</span></span><br><span class="line">    country = <span class="string">'China'</span></span><br><span class="line">    name = <span class="string">'jason'</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age, sex)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line">        self.sex = sex</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(<span class="string">'running...'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">obj1 = People(<span class="string">'tank'</span>, <span class="number">17</span>, <span class="string">'male'</span>)</span><br><span class="line">print(obj1.name)  <span class="comment"># tank  找对象自己的name属性</span></span><br><span class="line">print(obj1.country)  <span class="comment"># China  对象没有，找类中的属性</span></span><br><span class="line"><span class="comment"># AttributeError: 'People' object has no attribute 'jason'</span></span><br><span class="line"><span class="comment"># print(obj1.jason)  # 对象没有，类也没有，就会报错!</span></span><br><span class="line">print(obj1.__dict__)</span><br><span class="line"><span class="comment"># 给对象的名称空间添加 country='中国' 属性</span></span><br><span class="line">obj1.country = <span class="string">'中国'</span></span><br><span class="line">print(obj1.__dict__)</span><br><span class="line">print(People.__dict__)</span><br><span class="line">print(obj1.country)</span><br></pre></td></tr></table></figure>

<h2 id="7-一切皆对象"><a href="#7-一切皆对象" class="headerlink" title="7.一切皆对象"></a>7.一切皆对象</h2><p>在python中一切皆对象</p>
</li>
</ul>
<h3 id="补充：什么叫方法？什么叫函数？"><a href="#补充：什么叫方法？什么叫函数？" class="headerlink" title="补充：什么叫方法？什么叫函数？"></a>补充：什么叫方法？什么叫函数？</h3><p>答：方法可以是类的绑定方法也可以是对象的绑定方法，但是有些情况类来调用就是普通函数，当有几个参数就要传几个值时，比如类的静态绑定方法就是将方法改成函数调用。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/10/25/python%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" data-id="ckd3cw4ib000qrcut451kgvt5" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/" rel="tag">Python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-python常用模块" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/10/21/python%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97/" class="article-date">
  <time datetime="2018-10-21T15:23:27.000Z" itemprop="datePublished">2018-10-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/21/python%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97/">python常用模块</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="介绍Python中的几种常用模块"><a href="#介绍Python中的几种常用模块" class="headerlink" title="介绍Python中的几种常用模块"></a>介绍Python中的几种常用模块</h1><h2 id="1-time模块"><a href="#1-time模块" class="headerlink" title="1.time模块"></a>1.time模块</h2><p>与时间处理有关的python内置模块</p>
<ul>
<li>时间戳：自1970-01-01 00.00:00到当前时间，按秒计算，到现在为止一共多少秒</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time    <span class="comment"># 导入时间模块包</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">print(time.time())     <span class="comment"># 获取当前时间的时间戳</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">1573887905.6273756</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">print(time.localtime())    <span class="comment"># 获取当地时间格式化对象,即struct.time(为九个元素的元组)</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">time.struct_time(tm_year=2018, tm_mon=10, tm_mday=16, tm_hour=15,tm_min=5, tm_sec=5, tm_wday=5, tm_yday=320, tm_isdst=0)</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">res = time.localtime()</span><br><span class="line">print(res.tm_hour)</span><br><span class="line">print(res.tm_mday)</span><br><span class="line"><span class="comment"># 可以将时间元素返回出来</span></span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="number">16</span></span><br><span class="line"></span><br><span class="line">print(time.gmtime()) </span><br><span class="line"><span class="comment"># ,将一个时间转化为UTC时区(0时区)的struct.time,# 即获取格林威治时间格式化对象</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">time.struct_time(tm_year=2018, tm_mon=10, tm_mday=16, tm_hour=7, \</span></span><br><span class="line"><span class="string">tm_min=5, tm_sec=5, tm_wday=5, tm_yday=320, tm_isdst=0)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="comment"># print(time.strftime())</span></span><br><span class="line"><span class="comment"># strftime()可以把一个代表的时间的元组或struct_time转化为格式化的时间字符串,若t未指定,则以当前时间为参数</span></span><br><span class="line"><span class="comment">#格式参考下方官方指定</span></span><br><span class="line">print(time.strftime(<span class="string">'%Y-%m-%d  %H:%M:%S'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2018-10-16  15:34:30</span></span><br><span class="line"></span><br><span class="line">print(time.strftime(<span class="string">'%Y-%m-%d  %X'</span>))   </span><br><span class="line"><span class="comment">#  %H:%M:%S = %X</span></span><br><span class="line"><span class="comment"># 2018-10-16  15:34:30</span></span><br><span class="line"></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">    %Y  Year with century as a decimal number.</span></span><br><span class="line"><span class="string">    %m  Month as a decimal number [01,12].</span></span><br><span class="line"><span class="string">    %d  Day of the month as a decimal number [01,31].</span></span><br><span class="line"><span class="string">    %H  Hour (24-hour clock) as a decimal number [00,23].</span></span><br><span class="line"><span class="string">    %M  Minute as a decimal number [00,59].</span></span><br><span class="line"><span class="string">    %S  Second as a decimal number [00,61].</span></span><br><span class="line"><span class="string">    %z  Time zone offset from UTC.</span></span><br><span class="line"><span class="string">    %a  Locale's abbreviated weekday name.</span></span><br><span class="line"><span class="string">    %A  Locale's full weekday name.</span></span><br><span class="line"><span class="string">    %b  Locale's abbreviated month name.</span></span><br><span class="line"><span class="string">    %B  Locale's full month name.</span></span><br><span class="line"><span class="string">    %c  Locale's appropriate date and time representation.</span></span><br><span class="line"><span class="string">    %I  Hour (12-hour clock) as a decimal number [01,12].</span></span><br><span class="line"><span class="string">    %p  Locale's equivalent of either AM or PM.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"></span><br><span class="line">print(time.strptime(<span class="string">'2018-10-05 11:10:10'</span>,<span class="string">'%Y-%m-%d  %H:%M:%S'</span>))</span><br><span class="line"><span class="comment"># 把一个格式化的时间转化成格式化时间对象(struct_time)</span></span><br><span class="line"><span class="comment"># strptime和strftime是互逆操作</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># time.struct_time(tm_year=2018, tm_mon=10, tm_mday=5, \</span></span><br><span class="line"><span class="comment"># tm_hour=11, tm_min=10, tm_sec=10, tm_wday=4, tm_yday=278, tm_isdst=-1)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># time.sleep('参数')</span></span><br><span class="line"><span class="comment"># 里面的参数指的是秒,可以将程序延长到参数所指定的时间后再执行</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(time.asctime())</span><br><span class="line"><span class="comment"># 将一个时间的元组或者或者struct_time表示为下面这种形式,不传参数则默认为当前时间</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">Sat Nov 16 15:14:11 2019</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(time.ctime())</span><br><span class="line">print(time.ctime(<span class="number">1573887905.6273756</span>))</span><br><span class="line"><span class="comment"># 将时间戳改为下面这种形式,不传参则默认为当前时间戳</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">Sat Nov 16 15:18:05 2019</span></span><br><span class="line"><span class="string">Sat Nov 16 15:05:05 2019</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure>

<h2 id="2-datetime模块"><a href="#2-datetime模块" class="headerlink" title="2.datetime模块"></a>2.datetime模块</h2><p>和时间有关的python内置模块</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(datetime.date.today())   <span class="comment"># 获取当前日期</span></span><br><span class="line"><span class="comment"># 2018-10-16</span></span><br><span class="line"></span><br><span class="line">print(datetime.datetime.today())  <span class="comment"># 获取当前日期时间 (北京时间)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2018-10-16 16:16:35.420231</span></span><br><span class="line"></span><br><span class="line">print(datetime.datetime.now())    <span class="comment"># 获取当前日期时间,和上面的方法没有多少区别</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2018-10-16 16:16:35.420231</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(datetime.datetime.utcnow())  <span class="comment"># 格林威治时间</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2018-10-16 08:16:35.420231</span></span><br><span class="line"></span><br><span class="line">res = datetime.datetime.today()</span><br><span class="line">print(res.hour)   <span class="comment"># 可以提取时</span></span><br><span class="line"><span class="comment"># 16</span></span><br><span class="line">print(res.year)   <span class="comment"># 可以提取年</span></span><br><span class="line"><span class="comment"># 2018</span></span><br><span class="line">print(res.month)   <span class="comment"># 可以提取月</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">日期/时间的计算 (*******)</span></span><br><span class="line"><span class="string">    日期时间 = 日期时间 “+” or “-” 时间对象</span></span><br><span class="line"><span class="string">    时间对象 = 日期时间 “+” or “-” 日期时间</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 当前时间</span></span><br><span class="line">current_time = datetime.datetime.now()</span><br><span class="line">print(current_time)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2018-10-16 16:48:58.950441</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 时间对象</span></span><br><span class="line"><span class="comment"># 一段时间间隔后的时间</span></span><br><span class="line">datetime_obj = datetime.timedelta(days = <span class="number">3</span>)</span><br><span class="line">print(datetime_obj)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3 days, 0:00:00</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#　获取当前时间３天后的时间</span></span><br><span class="line"><span class="comment"># 日期时间 = 当前时间 “+” or “-” 时间对象</span></span><br><span class="line">late_time = current_time + datetime_obj</span><br><span class="line"></span><br><span class="line">print(late_time)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2018-10-19 16:48:58.950441</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 时间对象 = 日期时间 - 当前时间</span></span><br><span class="line"></span><br><span class="line">datetime_obj = late_time - current_time</span><br><span class="line">print(datetime_obj)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3 days, 0:00:00</span></span><br></pre></td></tr></table></figure>

<h2 id="3-random模块"><a href="#3-random模块" class="headerlink" title="3.random模块"></a>3.random模块</h2><p>随机数模块</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">print(random.randrange(<span class="number">1</span>,<span class="number">10</span>))   <span class="comment"># 返回一个1到10内的随机数,但是取不到10</span></span><br><span class="line"></span><br><span class="line">print(random.randint(<span class="number">1</span>,<span class="number">10</span>))   <span class="comment">#  返回一个1到10内的随机数,可以取到10</span></span><br><span class="line"></span><br><span class="line">print(random.randrange(<span class="number">0</span>,<span class="number">10</span>,<span class="number">2</span>))   <span class="comment"># 返回一个0到10内的随机偶数,后面的2表示步长</span></span><br><span class="line"></span><br><span class="line">print(random.random())   <span class="comment"># 随机返回一个1以内的浮点数</span></span><br><span class="line"></span><br><span class="line">l1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">random.shuffle(l1)    <span class="comment"># 将原序列(只有列表可以)打乱顺序重新随机排列,又叫洗牌</span></span><br><span class="line"></span><br><span class="line">print(l1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">l2 = [<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>,]     <span class="comment"># 在给定序列(有索引的可迭代对象,list,tuple)中随机抽一个字符,集合和字典不能随机选取</span></span><br><span class="line"><span class="comment"># l3 = &#123;1,2,3,4,5&#125;</span></span><br><span class="line"><span class="comment"># l4 = &#123;'a':1,'b':2,'c':3&#125;</span></span><br><span class="line">l5 = (<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>)</span><br><span class="line">print(random.choice(l2))</span><br><span class="line"><span class="comment"># print(random.choice(l3))</span></span><br><span class="line"><span class="comment"># print(random.choice(l4))</span></span><br><span class="line">print(random.choice(l5))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">l =  random.sample(<span class="string">'jsdiand'</span>,<span class="number">3</span>)  <span class="comment"># 从给定的字符串组中随机抽取特定数量的字符,并返回列表</span></span><br><span class="line"></span><br><span class="line">print(l)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#  可以做一个简单的验证码</span></span><br><span class="line">n = <span class="number">0</span></span><br><span class="line">l1 = <span class="string">''</span></span><br><span class="line"><span class="keyword">while</span> n &lt; <span class="number">5</span> :</span><br><span class="line">    a = <span class="string">'123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'</span></span><br><span class="line">    s = random.sample(a,<span class="number">1</span>)  <span class="comment"># 从a中随机选出一个值,返回的是列表</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:   <span class="comment"># 将字符串取出来</span></span><br><span class="line">        l1 += i   <span class="comment"># 拼接字符串</span></span><br><span class="line">    n += <span class="number">1</span></span><br><span class="line">random.shuffle(list(l1))   <span class="comment"># 再洗一次牌</span></span><br><span class="line">print(l1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">b = <span class="string">'123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'</span></span><br><span class="line">c = random.sample(b, <span class="number">10</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    print(i)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">需求: </span></span><br><span class="line"><span class="string">    大小写字母、数字组合而成</span></span><br><span class="line"><span class="string">    组合5位数的随机验证码</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">前置技术:</span></span><br><span class="line"><span class="string">     random.randint(1,10)　　# 在1到10中随机选出一个数</span></span><br><span class="line"><span class="string">    - chr(97)  # 可以将ASCII表中值转换成对应的字符</span></span><br><span class="line"><span class="string">    # print(chr(101))</span></span><br><span class="line"><span class="string">    - random.choice</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># chr(97)  可以将ASCII码中的值转换成对应的字符</span></span><br><span class="line"><span class="comment"># 获取任意长度的随机验证码</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_code</span><span class="params">(n)</span>:</span></span><br><span class="line">    code = <span class="string">''</span></span><br><span class="line">    <span class="comment"># 每次循环只从大小写字母、数字中取出一个字符</span></span><br><span class="line">    <span class="comment"># for line in range(5):</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> range(n):</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 随机获取一个小写字母</span></span><br><span class="line">        res1 = random.randint(<span class="number">97</span>, <span class="number">122</span>)</span><br><span class="line">        lower_str = chr(res1)   </span><br><span class="line">        <span class="comment"># lower = chr(random.randint(97,122))</span></span><br><span class="line">        <span class="comment"># 两句可以合并一句</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 随机获取一个大写字母</span></span><br><span class="line">        res2 = random.randint(<span class="number">65</span>, <span class="number">90</span>)</span><br><span class="line">        upper_str = chr(res2)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 随机获取一个数字</span></span><br><span class="line">        number = str(random.randint(<span class="number">0</span>, <span class="number">9</span>))</span><br><span class="line"></span><br><span class="line">        code_list = [lower_str, upper_str, number]</span><br><span class="line"></span><br><span class="line">        random_code = random.choice(code_list)</span><br><span class="line"></span><br><span class="line">        code += random_code</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> code</span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">code = get_code(<span class="number">5</span>)</span><br><span class="line">print(code)</span><br><span class="line">print(len(code))</span><br></pre></td></tr></table></figure>

<h2 id="4-os模块"><a href="#4-os模块" class="headerlink" title="4.os模块"></a>4.os模块</h2><p>os是与操作系统交互的模块</p>
<p>import os</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> DAY15_PATH = os.path.dirname(__file__)</span><br><span class="line"><span class="comment"># # 默认获取此文件的上一层目录的绝对路径</span></span><br><span class="line"> print(DAY15_PATH)</span><br><span class="line"></span><br><span class="line"> <span class="string">'''</span></span><br><span class="line"><span class="string"> 输出结果:G:/python/day15</span></span><br><span class="line"><span class="string"> '''</span></span><br><span class="line"></span><br><span class="line"> <span class="comment"># 项目的根目录，路径相关的值都用 “常量”</span></span><br><span class="line"> BASE_PATH = os.path.dirname(<span class="string">'G:\python\day15\时间模块.py'</span>)</span><br><span class="line"> BASE_PATH1 = os.path.dirname(<span class="string">'G:\python\day15'</span>)</span><br><span class="line"> print(BASE_PATH)    <span class="comment">#  返回上一级根目录</span></span><br><span class="line"> print(BASE_PATH1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="string">'''输出结果</span></span><br><span class="line"><span class="string">G:/python/day15</span></span><br><span class="line"><span class="string"> G:\python\day15   # 正反斜杠没有影响</span></span><br><span class="line"><span class="string"> G:\python</span></span><br><span class="line"><span class="string"> '''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 路径的拼接</span></span><br><span class="line">DAY15_PATH = os.path.dirname(__file__)</span><br><span class="line">print(os.path.join(<span class="string">'G:\python\day15'</span>,<span class="string">'python之从入门到放弃.txt'</span>))</span><br><span class="line">print(os.path.join(DAY15_PATH,<span class="string">'python之从入门到放弃.txt'</span>))</span><br><span class="line"></span><br><span class="line"> <span class="string">'''</span></span><br><span class="line"><span class="string"># 输出结果:</span></span><br><span class="line"><span class="string"># G:\python\day15\python之从入门到放弃.txt</span></span><br><span class="line"><span class="string"># G:/python/day15\python之从入门到放弃.txt</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过路径判断文件/文件夹是否存在,存在返回True,不存在返回False</span></span><br><span class="line"></span><br><span class="line"> print(os.path.exists(<span class="string">'G:\python\day15\python之从入门到放弃.txt'</span>))</span><br><span class="line"> </span><br><span class="line"> print(os.path.exists(<span class="string">'G:\python\day15\python之从入门.txt'</span>))</span><br><span class="line"></span><br><span class="line"> <span class="string">'''</span></span><br><span class="line"><span class="string"># True</span></span><br><span class="line"><span class="string"># False</span></span><br><span class="line"><span class="string"> '''</span></span><br><span class="line"><span class="comment"># 判断“文件夹”是否存在,存在返回True,不存在返回False</span></span><br><span class="line">print(os.path.isdir(<span class="string">'G:\python\day15'</span>))  <span class="comment"># True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 判断文件是否存在</span></span><br><span class="line"> print(os.path.isfile(<span class="string">'G:\python\day15\python之从入门到放弃.txt'</span>))</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="comment">#创建文件夹</span></span><br><span class="line">DAY_15 = os.path.dirname(__file__)</span><br><span class="line">DIR_PATH = os.path.join(DAY_15, <span class="string">'python练习册'</span>)</span><br><span class="line">os.mkdir(DIR_PATH)        <span class="comment"># 创建文件夹</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除文件夹: 只能删除 “空的文件夹”</span></span><br><span class="line"> os.rmdir(<span class="string">"G:\python\day15\python练习册"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取某个文件夹中所有文件的名字</span></span><br><span class="line">teacher_list = os.listdir(<span class="string">r'G:\python\day15'</span>)</span><br><span class="line">print(teacher_list)    <span class="comment"># 返回的是列表格式</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># enumerate(可迭代对象) ---&gt; 得到一个对象，对象中有一个个的元组(索引, 元素),若是字典取出所有的key</span></span><br><span class="line">res = enumerate(teacher_list)</span><br><span class="line">print(res)   <span class="comment"># 得到的是一个对象 &lt;enumerate object at 0x0000023DA0ED0C78&gt;</span></span><br><span class="line"></span><br><span class="line">print(list(res))  <span class="comment"># 将对象改成元组并标有序号</span></span><br><span class="line"><span class="comment"># [(0, 'datetime时间模块.py'), (1, 'os模块.py'), (2, 'python之从入门到放弃.txt'), \</span></span><br><span class="line"><span class="comment"># (3, 'python练习册'), (4, 'random模块.py'), (5, 'sys模块.py'), \</span></span><br><span class="line"><span class="comment"># (6, '__init__.py'), (7, '时间模块.py'), (8, '验证15.py')]</span></span><br><span class="line"></span><br><span class="line">举例:<span class="number">1</span>让用护从文件夹中选择文件并打开</span><br><span class="line"><span class="comment"># 让用户选择文件</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取某个文件夹中所有文件的名字</span></span><br><span class="line">    teacher_list = os.listdir(<span class="string">r'G:\python\day15'</span>)</span><br><span class="line">   </span><br><span class="line"><span class="comment"># 1.打印所有老师的作品</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> index, name <span class="keyword">in</span> enumerate(teacher_list):  <span class="comment"># 解压赋值</span></span><br><span class="line">        print(<span class="string">f'编号: <span class="subst">&#123;index&#125;</span> 文件名: <span class="subst">&#123;name&#125;</span>'</span>)</span><br><span class="line"></span><br><span class="line">    choice = input(<span class="string">'请选择想看的老师作品--&gt;(头条影片: Jason写真) 编号：'</span>).strip()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2.限制用户必须输入数字，数字的范围必须在编号内</span></span><br><span class="line">    <span class="comment"># 若不是数字，则重新选择</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> choice.isdigit():</span><br><span class="line">        print(<span class="string">'必须输入数字'</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 若是数字，往下走判断是否在编号范围内</span></span><br><span class="line">    choice = int(choice)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 判断如果不在列表范围内，则重新选择</span></span><br><span class="line">    <span class="keyword">if</span> choice <span class="keyword">not</span> <span class="keyword">in</span> range(len(teacher_list)):</span><br><span class="line">        print(<span class="string">'编号范围错误!'</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    file_name = teacher_list[choice]</span><br><span class="line"></span><br><span class="line">    teacher_path = os.path.join(</span><br><span class="line">        <span class="string">r'G:\python\day15\老男孩老师们的写真集'</span>, file_name)</span><br><span class="line"></span><br><span class="line">    print(teacher_path)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> open(teacher_path, <span class="string">'r'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        print(f.read())</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">举例<span class="number">2</span></span><br><span class="line"><span class="keyword">import</span> os  <span class="comment"># 导入os模块</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment"># 找到这个文件夹(电影大全)</span></span><br><span class="line">    DATE_PATH = os.path.dirname(os.path.dirname(__file__))  <span class="comment"># 需要往上找两次才能在同一根目录下</span></span><br><span class="line">    DATE_AIM_PATH = os.path.join(DATE_PATH, <span class="string">'电影大全'</span>)</span><br><span class="line">    <span class="comment"># 获取电影大全文件夹中的所有名字</span></span><br><span class="line">    movie_list = os.listdir(DATE_AIM_PATH)     <span class="comment"># 获得文件下的电影列表</span></span><br><span class="line">    <span class="keyword">for</span> index,name <span class="keyword">in</span> enumerate(movie_list):   <span class="comment"># 解压赋值</span></span><br><span class="line">        print(<span class="string">f"编号:<span class="subst">&#123;index&#125;</span>,电影名:<span class="subst">&#123;name&#125;</span>"</span>)     <span class="comment"># 打印出来编号和文件名</span></span><br><span class="line">    choice = input(<span class="string">'请选择想要观看的电影编号:'</span>).strip()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> choice.isdigit():</span><br><span class="line">        print(<span class="string">"必须写入数字"</span>)      <span class="comment"># 判断输入的是否是数字</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    choice = int(choice)      <span class="comment"># 将输入的字符串数字改为整型</span></span><br><span class="line">    <span class="keyword">if</span> choice <span class="keyword">not</span> <span class="keyword">in</span> range(len(movie_list)):  <span class="comment"># 判断数字是否在编号范围内</span></span><br><span class="line">        print(<span class="string">"没有此电影"</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    file_name = movie_list[choice]  <span class="comment"># 索引到此文件名</span></span><br><span class="line">    movie_path = os.path.join(DATE_AIM_PATH,file_name)  <span class="comment"># 拼接文件路径</span></span><br><span class="line">    print(movie_path)    <span class="comment"># 打印文件路径</span></span><br><span class="line">    <span class="keyword">with</span> open(movie_path,<span class="string">'r'</span>,encoding=<span class="string">'utf-8'</span>)<span class="keyword">as</span> f:   <span class="comment"># 读取文件内容</span></span><br><span class="line">        print(f.read())</span><br><span class="line"></span><br><span class="line">     </span><br><span class="line">    <span class="comment"># os模块的getpid()可以获得该进程的进程号,os.ppid()可以获得该进程的父进程的进程号</span></span><br></pre></td></tr></table></figure>

<h2 id="5-sys模块"><a href="#5-sys模块" class="headerlink" title="5.sys模块"></a>5.sys模块</h2><p>sys模块是和python解释器交互的模块</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取当前的Python解释器的环境变量路径,返回的是列表</span></span><br><span class="line"><span class="comment"># print(sys.path)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将当前项目添加到环境变量中</span></span><br><span class="line">BASE_PATH = os.path.dirname(os.path.dirname(__file__))</span><br><span class="line">sys.path.append(BASE_PATH)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取操作系统cmd终端的命令行  </span></span><br><span class="line"><span class="comment"># 执行==vpython3 py文件 用户名 密码</span></span><br><span class="line">print(sys.argv)  <span class="comment"># 返回的是列表['']</span></span><br><span class="line">res = sys.argv</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> res[<span class="number">1</span>] == <span class="string">'jiang'</span> <span class="keyword">and</span> res[<span class="number">2</span>] == <span class="string">'123'</span>: <span class="comment"># 判断cmd输入的用户名和密码是否正确,进行权限认证</span></span><br><span class="line">    print(<span class="string">'您已通过验证'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'权限不足'</span>)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">(执行py文件的权限认证)</span><br></pre></td></tr></table></figure>

<h2 id="6-hashlib模块"><a href="#6-hashlib模块" class="headerlink" title="6.hashlib模块"></a>6.hashlib模块</h2><p>hashlib模块内置有很多算法,可以用来加密字符</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">hashlib模块是一种加密模块,模块里面包含了很多算法</span></span><br><span class="line"><span class="string">比如MD5,sha256等</span></span><br><span class="line"><span class="string">其中我们常用的是MD5算法,因为其不可解的特性被广泛用于密码验证等</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">摘要算法:</span></span><br><span class="line"><span class="string">    - 摘要是从某个内容中获取的加密字符串</span></span><br><span class="line"><span class="string">    - 摘要一样，内容就一定一样: 保证唯一性</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    - 密文密码就是一个摘要</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="comment"># md5_obj = hashlib.md5()</span></span><br><span class="line"><span class="comment"># print(type(md5_obj))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果:&lt;class '_hashlib.HASH'&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># md5_obj = hashlib.md5</span></span><br><span class="line"><span class="comment"># print(type(md5_obj))</span></span><br><span class="line"><span class="comment"># 输出结果 &lt;class 'builtin_function_or_method'&gt;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">md5_obj = hashlib.md5()</span><br><span class="line">str_1 = <span class="string">'1234'</span></span><br><span class="line"><span class="comment"># update中一定要传入bytes类型</span></span><br><span class="line">md5_obj.update(str_1.encode(<span class="string">'utf-8'</span>))    <span class="comment"># 产生了一个内存地址 </span></span><br><span class="line"><span class="comment"># 得到一个加密的字符串</span></span><br><span class="line">res = md5_obj.hexdigest()  <span class="comment"># 此时加密的是str_1字符串</span></span><br><span class="line">print(res)</span><br><span class="line"><span class="comment"># # 输出结果:81dc9bdb52d04dc20036dbd8313ed055</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># str_1 = '1234'</span></span><br><span class="line"><span class="comment"># hashlib.md5().update(str_1.encode('utf-8'))  # 产生了一个内存地址</span></span><br><span class="line"><span class="comment"># print(hashlib.md5().hexdigest())   # 再次调用再次产了一个内存地址,所以没有引用到str_1,加密的是个空字符串</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#  输出结果:d41d8cd98f00b204e9800998ecf8427e</span></span><br><span class="line"></span><br><span class="line">print(hashlib.md5().hexdigest())    <span class="comment">#  加密的一个空字符串</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果:d41d8cd98f00b204e9800998ecf8427e</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">虽然md5几乎不会不破解,但是可以通过撞库的方式破解真实密码</span></span><br><span class="line"><span class="string">为了防止撞库,我们可以通过'加盐'的方式来解决</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pwd_md5</span><span class="params">(pwd)</span>:</span>  <span class="comment">#</span></span><br><span class="line">    md5_obj = hashlib.md5()</span><br><span class="line">    <span class="comment"># print(type(md5_obj))</span></span><br><span class="line">    str1 = pwd  <span class="comment"># '1234'</span></span><br><span class="line">    <span class="comment"># update中一定要传入bytes类型数据</span></span><br><span class="line">    md5_obj.update(str1.encode(<span class="string">'utf-8'</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 创造盐</span></span><br><span class="line">    sal = <span class="string">'密码不可破解'</span></span><br><span class="line">    <span class="comment"># 加盐</span></span><br><span class="line">    md5_obj.update(sal.encode(<span class="string">'utf-8'</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 得到一个加密后的字符串</span></span><br><span class="line">    res = md5_obj.hexdigest()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 模拟用户登陆操作</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取文件中的用户名与密码</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'user.txt'</span>, <span class="string">'r'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    user_str = f.read()</span><br><span class="line"></span><br><span class="line">file_user, file_pwd = user_str.split(<span class="string">':'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用户输入用户名与密码</span></span><br><span class="line">username = input(<span class="string">'请输入用户名:'</span>).strip()</span><br><span class="line">password = input(<span class="string">'请输入密码:'</span>).strip()  <span class="comment"># 1234</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 校验用户名与密码是否一致</span></span><br><span class="line"><span class="keyword">if</span> username == file_user <span class="keyword">and</span> file_pwd == pwd_md5(password):  <span class="comment"># pwd_md5('1234')</span></span><br><span class="line">    print(<span class="string">'登陆成功'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="string">'登陆失败'</span>)</span><br></pre></td></tr></table></figure>

<h2 id="7-json模块"><a href="#7-json模块" class="headerlink" title="7.json模块"></a>7.json模块</h2><ul>
<li>什么是json：</li>
</ul>
<p>json模块是一个序列化模块,是一种”第三方”的特殊数据格式</p>
<ul>
<li>为什么要使用json</li>
</ul>
<p>为了让不同的语言之间数据可以共享。</p>
<p>PS: 由于各种语言的数据类型不一，但长相可以一样， 比如python不能直接使用其他语言的数据类型，必须将其他语言的数据类型转换成json数据格式，python获取到json数据后可以将json转换成pyton的数据类型。</p>
<ul>
<li>如何使用json</li>
</ul>
<p>在python中：</p>
<p>可以将python数据类型—-》json数据格式—-》字符串—-》存到文件中</p>
<p>若其他语言想要使用python的技能：</p>
<p>将文件中的数据—》字符串—》json数据格式—》其他语言的数据类型</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">注意: </span><br><span class="line">在json中，所有的字符串都是双引号</span><br><span class="line">元组比较特殊:</span><br><span class="line">python中的元组，若将其转换成json数据，内部会将元组转换成 列表</span><br><span class="line">set是不能转换成json数据</span><br><span class="line">如何使用:  关于dumps，loads功能 </span><br><span class="line"><span class="keyword">import</span> json    </span><br><span class="line">- json.dumps：    </span><br><span class="line">json.dumps(), f = open() --&gt; f.write()        </span><br><span class="line"><span class="comment"># 序列化: python数据类型 ---》 json ---》 字符串 ---》 json文件中    </span></span><br><span class="line">- json.loads:    f = open(), str = f.read(),  json.loads(str)        </span><br><span class="line"><span class="comment"># 反序列化: json文件中 --》  字符串 ---》 json ---》 python或其他语言数据类型    </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">list1 = [<span class="string">'sean'</span>,<span class="string">'坦克'</span>,<span class="string">'123'</span>]</span><br><span class="line">tuple1 = (<span class="string">'sean'</span>,<span class="string">'坦克'</span>,<span class="string">'123'</span>)</span><br><span class="line">set1 = &#123;<span class="string">'sean'</span>,<span class="string">'坦克'</span>,<span class="string">'123'</span>&#125;  <span class="comment"># 注意集合不能被json序列化</span></span><br><span class="line">dict1 = &#123;<span class="string">'name'</span>:<span class="string">'sean'</span>,<span class="string">'name2'</span>:<span class="string">'坦克'</span>,<span class="string">'编号'</span>:<span class="string">'123'</span>&#125;</span><br><span class="line"><span class="comment"># 将python数据 ---》 json数据格式 ---》 字符串</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ensure_ascii将默认的ascii取消设置为False，可以在控制台看到中文，否则看到的是bytes类型数据</span></span><br><span class="line">json_str = json.dumps(list1,ensure_ascii=<span class="literal">False</span>)</span><br><span class="line">json_str1 = json.dumps(tuple1,ensure_ascii=<span class="literal">False</span>)</span><br><span class="line"><span class="comment"># json_str2 = json.dumps(set1,ensure_ascii=False)   注意:集合不能被序列化成json类型</span></span><br><span class="line">json_str3 = json.dumps(dict1,ensure_ascii=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">print(json_str)</span><br><span class="line">print(type(json_str))</span><br><span class="line"><span class="comment"># 输出结果:["sean", "坦克", "123"]  &lt;class 'str'&gt;</span></span><br><span class="line"></span><br><span class="line">print(json_str1)</span><br><span class="line"><span class="comment"># 输出结果["sean", "坦克", "123"]  ,元组返回的也是列表</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(json_str2)   注意:集合不能被序列化成json类型</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(json_str3)</span><br><span class="line"><span class="comment"># 输出结果:&#123;"name": "sean", "name2": "坦克", "编号": "123"&#125; # 字典依然是字典,但是是字符串类型</span></span><br><span class="line">print(type(json_str))</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">str</span>'&gt;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"># 在<span class="title">json</span>中，所有的字符串都是双引号</span></span><br><span class="line"># json_str = json.dumps(list1,ensure_ascii=True)</span><br><span class="line"><span class="comment"># print(json_str)</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># 中文显示的是bytes类型</span></span><br><span class="line"><span class="comment"># 输出结果;["sean", "\u5766\u514b", "123"]  &lt;class 'str'&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># json.loads()字符串 ----&gt; json数据格式 ---》将python数据</span></span><br><span class="line">python_date = json.loads(json_str)</span><br><span class="line">print(python_date)</span><br><span class="line">print(type(python_date))</span><br><span class="line"><span class="comment"># 输出结果:['sean', '坦克', '123']  &lt;class 'list'&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 简单注册功能</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">register</span><span class="params">()</span>:</span></span><br><span class="line">    user_name = input(<span class="string">'请输入用户名:'</span>).strip()</span><br><span class="line">    pass_word = input(<span class="string">'请输入密码:'</span>).strip()</span><br><span class="line">    re_pwd =  input(<span class="string">'请输入密码:'</span>).strip()</span><br><span class="line">    <span class="keyword">if</span> pass_word == re_pwd:</span><br><span class="line">        user_dic = &#123;<span class="string">'用户名'</span>:user_name,<span class="string">'密码'</span>:re_pwd&#125;</span><br><span class="line">        json_str = json.dumps(user_dic,ensure_ascii=<span class="literal">False</span>)   <span class="comment"># 转换成json序列,并且可以中文显示</span></span><br><span class="line">        <span class="keyword">with</span> open(<span class="string">'user_count'</span>,<span class="string">'w'</span>,encoding=<span class="string">'utf-8'</span>)<span class="keyword">as</span> f:</span><br><span class="line">            f.write(json_str)</span><br><span class="line">        print(<span class="string">'注册成功'</span>)</span><br><span class="line"></span><br><span class="line">register()</span><br><span class="line">关于dump，load功能</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- json.dump()：  </span><br><span class="line"><span class="comment"># 序列化: python数据类型 ---》 json ---》 字符串 ---》 json文件中        </span></span><br><span class="line"><span class="comment">#- 内部实现 f.write()  </span></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">user_dic = &#123;<span class="string">'name'</span>:<span class="string">'tank'</span>,<span class="string">'age'</span>:<span class="string">'73'</span>&#125;</span><br><span class="line">f = open(<span class="string">'tank'</span>,<span class="string">'w'</span>,encoding=<span class="string">'utf-8'</span>)</span><br><span class="line">json_user = json.dumps(user_dic,ensure_ascii=<span class="literal">False</span>)</span><br><span class="line">f.write(json_user)   <span class="comment"># 写入文件必须以字符串的格式，字典及其他类型都不可以</span></span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">user_dic1 = &#123;<span class="string">'name'</span>:<span class="string">'tank'</span>,<span class="string">'age'</span>:<span class="string">'73'</span>&#125;</span><br><span class="line">wf = open(<span class="string">'tank2'</span>,<span class="string">'w'</span>,encoding=<span class="string">'utf-8'</span>)</span><br><span class="line">json.dump(user_dic1,wf,ensure_ascii=<span class="literal">False</span>)   <span class="comment"># dump可以直接将内容写入文件，将两步变为一步</span></span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line">- json.load()：  </span><br><span class="line"><span class="comment"># 反序列化: json文件中 --》  字符串 ---》 json ---》 python或其他语言数据类型        </span></span><br><span class="line"><span class="comment">#- 内部实现 f.read()  </span></span><br><span class="line"><span class="comment"># import json</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'tank'</span>,<span class="string">'r'</span>,encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> rf:</span><br><span class="line">    print(rf.read())</span><br><span class="line">    print(type(rf.read()))   <span class="comment"># 打印出来的是个字符串</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    res = json.load(rf)</span><br><span class="line">    print(res)</span><br><span class="line">    print(type(res))    <span class="comment"># 打印出来是原类型，元组会转换成列表</span></span><br><span class="line"></span><br><span class="line">- dump, load: 使用更方便</span><br><span class="line">注意: 保存json数据时，用.json作为文件的后缀名</span><br></pre></td></tr></table></figure>

<h2 id="8-pickle模块"><a href="#8-pickle模块" class="headerlink" title="8.pickle模块"></a>8.pickle模块</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">pickle模块:</span></span><br><span class="line"><span class="string">    pickle是一个python自带的序列化模块。功能上也是dump,laod,dmps,loads</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    优点:</span></span><br><span class="line"><span class="string">        - 可以支持python中所有的数据类型</span></span><br><span class="line"><span class="string">        - 可以直接存 "bytes类型" 的数据，pickle存取速度更快</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    缺点: （致命的缺点）</span></span><br><span class="line"><span class="string">        - 只能支持python去使用，不能跨平台</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="comment"># set1 = &#123;</span></span><br><span class="line"><span class="comment">#     'tank', 'sean', 'jason', '大脸'</span></span><br><span class="line"><span class="comment"># &#125;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># # 写 dump</span></span><br><span class="line"><span class="comment"># with open('tank ', 'wb') as f:</span></span><br><span class="line"><span class="comment">#     pickle.dump(set1, f)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读 load</span></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'tank'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    python_set = pickle.load(f)</span><br><span class="line">    print(python_set)</span><br><span class="line">    print(type(python_set))</span><br></pre></td></tr></table></figure>

<h2 id="9-collections模块"><a href="#9-collections模块" class="headerlink" title="9.collections模块"></a>9.collections模块</h2><p>collections模块: 提供一些python八大数据类型 “以外的数据类型” 。</p>
<p>以具名元组，有序字典为例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">- python默认八大数据:</span></span><br><span class="line"><span class="string">            - 整型</span></span><br><span class="line"><span class="string">            - 浮点型</span></span><br><span class="line"><span class="string">            - 字符串</span></span><br><span class="line"><span class="string">            - 字典</span></span><br><span class="line"><span class="string">            - 元组</span></span><br><span class="line"><span class="string">            - 列表</span></span><br><span class="line"><span class="string">            - 集合</span></span><br><span class="line"><span class="string">            - 布尔</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">主要应用:</span></span><br><span class="line"><span class="string">- 具名元组: from collections import namedtuple</span></span><br><span class="line"><span class="string">        具名元组 只是一个名字。</span></span><br><span class="line"><span class="string">        应用场景:</span></span><br><span class="line"><span class="string">            - 坐标</span></span><br><span class="line"><span class="string">           </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    - 有序字典: from collections import OrderedDict</span></span><br><span class="line"><span class="string">        - python中字典默认是无序</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        - collections中提供了有序的字典   </span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="comment"># 第一种具名元组</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># # 坐标</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple  <span class="comment"># 导入namedtuple</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">point = namedtuple(<span class="string">'坐标'</span>,[<span class="string">'x'</span>,<span class="string">'y'</span>,<span class="string">'z'</span>])</span><br><span class="line">point1 = namedtuple(<span class="string">'坐标'</span>,(<span class="string">'x'</span>,<span class="string">'y'</span>,<span class="string">'z'</span>))</span><br><span class="line">point2 = namedtuple(<span class="string">'坐标'</span>,<span class="string">'x,y,z'</span>)</span><br><span class="line">point3 = namedtuple(<span class="string">'坐标'</span>,&#123;<span class="string">'x'</span>,<span class="string">'y'</span>,<span class="string">'z'</span>&#125;)</span><br><span class="line">point4 = namedtuple(<span class="string">'坐标'</span>,&#123;<span class="string">'x'</span>:<span class="number">8</span>,<span class="string">'y'</span>:<span class="number">9</span>,<span class="string">'z'</span>:<span class="number">10</span>&#125;)   <span class="comment"># 字典更换了key</span></span><br><span class="line">p = point(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)  <span class="comment"># 传参的个数要与nametuple的第二个参数个数一一对应</span></span><br><span class="line">p1 = point1(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)  <span class="comment"># 传参的个数要与nametuple的第二个参数个数一一对应</span></span><br><span class="line">p2 = point2(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)  <span class="comment"># 传参的个数要与nametuple的第二个参数个数一一对应</span></span><br><span class="line">p3 = point3(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)  <span class="comment"># 传参的个数要与nametuple的第二个参数个数一一对应</span></span><br><span class="line">p4 = point3(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)  <span class="comment"># 传参的个数要与nametuple的第二个参数个数一一对应</span></span><br><span class="line">print(p)</span><br><span class="line">print(p1)</span><br><span class="line">print(p2)</span><br><span class="line">print(p3)</span><br><span class="line">print(p4)</span><br><span class="line">print(type(p))</span><br><span class="line">print(type(p1))</span><br><span class="line">print(type(p2))</span><br><span class="line">print(type(p3))</span><br><span class="line">print(type(p4))</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># '''</span></span><br><span class="line"><span class="comment"># 输出结果：</span></span><br><span class="line"><span class="comment"># 坐标(x=1, y=2, z=3)</span></span><br><span class="line"><span class="comment"># 坐标(x=1, y=2, z=3)</span></span><br><span class="line"><span class="comment"># 坐标(x=1, y=2, z=3)</span></span><br><span class="line"><span class="comment"># 坐标(x=1, z=2, y=3)</span></span><br><span class="line"><span class="comment"># 坐标(x=1, z=2, y=3)  # 字典将key更换了</span></span><br><span class="line"><span class="comment"># &lt;class '__main__.坐标'&gt;</span></span><br><span class="line"><span class="comment"># &lt;class '__main__.坐标'&gt;</span></span><br><span class="line"><span class="comment"># &lt;class '__main__.坐标'&gt;</span></span><br><span class="line"><span class="comment"># &lt;class '__main__.坐标'&gt;</span></span><br><span class="line"><span class="comment"># &lt;class '__main__.坐标'&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 扑克牌</span></span><br><span class="line">card = namedtuple(<span class="string">'扑克牌'</span>,[<span class="string">'color'</span>,<span class="string">'number'</span>])</span><br><span class="line">red = card(<span class="string">'♥'</span>,<span class="string">'A'</span>)</span><br><span class="line">print(red)</span><br><span class="line"></span><br><span class="line">black = card(<span class="string">'♠'</span>,<span class="string">'A'</span>)</span><br><span class="line">print(black)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二种 有序字典</span></span><br><span class="line"><span class="comment"># python中的字典默认为无序字典 </span></span><br><span class="line">dic = dict(&#123;<span class="string">'x'</span>: <span class="number">1</span>, <span class="string">'y'</span>: <span class="number">2</span>, <span class="string">'z'</span>: <span class="number">3</span>&#125;)</span><br><span class="line">print(dic)</span><br><span class="line">print(type(dic))</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> dic:</span><br><span class="line">    print(line)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict  <span class="comment"># 导入OrderedDict</span></span><br><span class="line"></span><br><span class="line">order_dict = OrderedDict(&#123;<span class="string">'x'</span>: <span class="number">1</span>, <span class="string">'y'</span>: <span class="number">2</span>, <span class="string">'z'</span>: <span class="number">3</span>&#125;)</span><br><span class="line">print(order_dict, <span class="string">'打印有序的字典'</span>)</span><br><span class="line">print(type(order_dict))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果：</span></span><br><span class="line"><span class="comment"># OrderedDict([('x', 1), ('y', 2), ('z', 3)]) 打印有序的字典</span></span><br><span class="line"><span class="comment"># &lt;class 'collections.OrderedDict'&gt;</span></span><br><span class="line"></span><br><span class="line">print(order_dict.get(<span class="string">'y'</span>))  <span class="comment"># 都可以取到指定value</span></span><br><span class="line"><span class="comment"># 输出结果：2</span></span><br><span class="line">print(order_dict[<span class="string">'y'</span>])</span><br><span class="line"><span class="comment"># 输出结果：2</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> order_dict:</span><br><span class="line">    print(line)</span><br></pre></td></tr></table></figure>

<h2 id="10-openpyxl模块"><a href="#10-openpyxl模块" class="headerlink" title="10.openpyxl模块"></a>10.openpyxl模块</h2><p>openpyxl模块：第三方模块 - 可以对Excle表格进行操作的模块</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">openpyxl模块：第三方模块</span></span><br><span class="line"><span class="string">    - 可以对Excle表格进行操作的模块</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    - 下载:</span></span><br><span class="line"><span class="string">        pip3 install openpyxl</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    - Excel版本:</span></span><br><span class="line"><span class="string">        2003之前:</span></span><br><span class="line"><span class="string">            excle名字.xls</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        2003以后:</span></span><br><span class="line"><span class="string">            excle名字.xlsx</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    - 清华源: https://pypi.tuna.tsinghua.edu.cn/simple</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    - 配置永久第三方源:</span></span><br><span class="line"><span class="string">        D:\Python36\Lib\site-packages\pip\_internal\models\index.py</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"> <span class="keyword">from</span> openpyxl <span class="keyword">import</span> Workbook</span><br><span class="line"><span class="comment"># # 写入数据</span></span><br><span class="line"><span class="comment"># # 获取excel文件对象</span></span><br><span class="line"> wb_obj = Workbook()</span><br><span class="line"><span class="comment"># # 建立工作表</span></span><br><span class="line"> wb1 = wb_obj.create_sheet(<span class="string">'本月第一周销售明细表'</span>,<span class="number">1</span>)</span><br><span class="line"> wb2 = wb_obj.create_sheet(<span class="string">'本月销售第二周明细表'</span>,<span class="number">2</span>)</span><br><span class="line"><span class="comment"># 修改工作表中的名字:</span></span><br><span class="line">print(wb1.title)  <span class="comment"># 将本月第一周销售明细表改为总明细表</span></span><br><span class="line">wb1.title = <span class="string">'总明细表'</span></span><br><span class="line">print(wb1.title)</span><br><span class="line"><span class="comment"># 为第一张工作表添加值</span></span><br><span class="line"><span class="comment">#方式： wb1['工作簿中的表格位置']</span></span><br><span class="line">wb1[<span class="string">'A10'</span>] = <span class="number">200</span></span><br><span class="line">wb1[<span class="string">'B10'</span>] = <span class="number">1000</span></span><br><span class="line">wb1[<span class="string">'C10'</span>] = <span class="string">'=SUM(A10:B10)'</span></span><br><span class="line"></span><br><span class="line">wb_obj.save(<span class="string">'本月销售明细表.xlsx'</span>)   <span class="comment"># 生成excel表格</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取数据</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> load_workbook   <span class="comment"># 导入load_workbook</span></span><br><span class="line"></span><br><span class="line">wb_obj = load_workbook(<span class="string">'本月销售明细表.xlsx'</span>)</span><br><span class="line">print(wb_obj)   <span class="comment"># 读取文件对象</span></span><br><span class="line">wb1 = wb_obj[<span class="string">'总明细表'</span>]  <span class="comment"># 指定工作簿</span></span><br><span class="line">print(wb1[<span class="string">'A10'</span>].value)  <span class="comment"># 取指定工作簿中的指定位置的值</span></span><br><span class="line"><span class="comment"># 输出结果：200</span></span><br><span class="line">wb2 = wb_obj[<span class="string">'本月销售第二周明细表'</span>]</span><br><span class="line">print(wb2[<span class="string">'A3'</span>].value)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 批量写入数据</span></span><br><span class="line"><span class="keyword">from</span> openpyxl <span class="keyword">import</span> Workbook</span><br><span class="line">wb_obj = Workbook()</span><br><span class="line"></span><br><span class="line">wb1 = wb_obj.create_sheet(<span class="string">'记录表1'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># wb1['表格位置'] = 对应的值</span></span><br><span class="line">n = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">    wb1[<span class="string">'A%s'</span>% n] = line + <span class="number">1</span></span><br><span class="line">    n += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">wb_obj.save(<span class="string">'批量插入的数据1.xlsx'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 插入字典</span></span><br><span class="line">dict1 = &#123;</span><br><span class="line">    <span class="string">'name'</span>: <span class="string">'tank'</span>,</span><br><span class="line">    <span class="string">'age'</span>: <span class="number">17</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">n = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> key, value <span class="keyword">in</span> dict1.items():</span><br><span class="line">    wb1[<span class="string">'A%s'</span> % n] = key</span><br><span class="line">    wb1[<span class="string">'B%s'</span> % n] = value</span><br><span class="line">    n += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">wb_obj.save(<span class="string">'批量插入的数据2.xlsx'</span>)</span><br></pre></td></tr></table></figure>

<h2 id="11-subprocess模块"><a href="#11-subprocess模块" class="headerlink" title="11.subprocess模块"></a>11.subprocess模块</h2><p>subprocess模块可以通过python代码给操作系统终端发送命令，并且可以返回结果。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment"># 让用户输入终端命令</span></span><br><span class="line">    cmd_str = input(<span class="string">'请输入终端命令：'</span>).strip()</span><br><span class="line">   <span class="comment"># 调用Popen就会将用户的终端命令发送给本地操作系统的终端</span></span><br><span class="line">   <span class="comment"># 得到一个对象，对象中包含着正确或错误的结果。</span></span><br><span class="line">    obj = subprocess.Popen(</span><br><span class="line">        cmd_str,shell=<span class="literal">False</span>,    <span class="comment"># 默认是False，需要改成True</span></span><br><span class="line">        stdout=subprocess.PIPE,</span><br><span class="line">        stderr=subprocess.PIPE</span><br><span class="line">    )</span><br><span class="line">    success = obj.stdout.read().decode(<span class="string">'gbk'</span>)   <span class="comment"># windows默认gbk格式</span></span><br><span class="line">    <span class="keyword">if</span> success: <span class="comment"># 如果终端命令正确，输入成功</span></span><br><span class="line">        print(success,<span class="string">'正确的结果'</span>)</span><br><span class="line"></span><br><span class="line">    error = obj.stderr.read().decode(<span class="string">'gbk'</span>)</span><br><span class="line">    <span class="keyword">if</span> error:  <span class="comment"># 如果终端命令错误，输入失败</span></span><br><span class="line">        print(error,<span class="string">'错误的结果'</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://user-images.githubusercontent.com/57135669/88484055-6dac1d00-cf9e-11ea-9de9-f36d6b43dbe6.png" alt="1843708-20191119225621942-1504385340"></p>
<h2 id="12-re模块和正则表达式"><a href="#12-re模块和正则表达式" class="headerlink" title="12.re模块和正则表达式"></a>12.re模块和正则表达式</h2><ul>
<li><p>什么是re模块和正则表达式</p>
<p>正则表达式:</p>
<p>正则表达式是一门独立的技术, 任何语言都可以使用正则表达式，正则表达式是由一堆特殊的字符组合而来的。</p>
<p>由<strong>字符组</strong>和<strong>元字符</strong> 来 组合使用</p>
<p>re模块:</p>
<p>在python中，若想使用正则表达式，必须通过re模块来实现。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">字符组:  </span><br><span class="line">    - [<span class="number">0</span><span class="number">-9</span>] 可以匹配到一个<span class="number">0</span><span class="number">-9</span>的字符  </span><br><span class="line">    - [<span class="number">9</span><span class="number">-0</span>]: 报错, 必须从小到大  </span><br><span class="line">    - [a-z]: 从小写的a-z  </span><br><span class="line">    - [A-Z]: 从大写A-Z  </span><br><span class="line">    - [z-A]: 错误, 只能从小到大，根据ascii表来匹配大小。 </span><br><span class="line">    - [A-z]: 总大写的A到小写的z。  </span><br><span class="line">    注意: 顺序必须要按照ASCII码数值的顺序编写。</span><br></pre></td></tr></table></figure>

<p>元字符：<a href="https://images2015.cnblogs.com/blog/1036857/201705/1036857-20170529203214461-666088398.png" target="_blank" rel="noopener">https://images2015.cnblogs.com/blog/1036857/201705/1036857-20170529203214461-666088398.png</a></p>
</li>
</ul>
<p>元字符组合使用</p>
<p>\w\W: 匹配字母数字下划线与非字母数字下划线，匹配所有。</p>
<p>\d\D: 无论是数字或者非数字都可以匹配。</p>
<p>^$: 配合使用叫做精准匹配，如何限制一个字符串的长度或者内容。</p>
<p>|: 或。ab|abc如果第一个条件成立，则abc不会执行，怎么解决，针对这种情况把长的写在前面就好了，一定要将长的放在前面。</p>
<p><strong>re模块三种比较重要的方法:</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># findall()：</span></span><br><span class="line"><span class="comment"># 可以匹配 "所有字符" ，拿到返回的结果，返回的结果是一个列表。</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">demo = <span class="string">'Sean json tank'</span> <span class="comment">#（不要带逗号，否则会返回空列表</span></span><br><span class="line"><span class="comment"># res = re.findall(元字符，分割范围，需要分割的字符串)</span></span><br><span class="line">res = re.findall(<span class="string">'[A-z]&#123;4&#125;'</span>,demo)</span><br><span class="line">print(res)   <span class="comment"># 返回的结果是个列表</span></span><br><span class="line"><span class="comment"># 输出结果：['Sean', 'json', 'tank']</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># #search()：----&gt; obj ----&gt; obj.group()</span></span><br><span class="line"><span class="comment"># #在匹配一个字符成功后，拿到结果后结束，不往后匹配。</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">demo1 = <span class="string">'Sean json tank'</span></span><br><span class="line">res1 = re.search(<span class="string">'[A-z]&#123;4&#125;'</span>,demo1)</span><br><span class="line">print(res1)    <span class="comment"># 直接打印是一个re.Match object，需要group一下</span></span><br><span class="line">print(type(res1))</span><br><span class="line">print(res1.group())  <span class="comment"># 找出第一个元素后就不会再往下找了</span></span><br><span class="line"><span class="comment"># 输出结果：Sean</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># match()：----&gt; obj ----&gt; obj.group()</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">demo3 = <span class="string">'Sean json tank'</span></span><br><span class="line">res2 = re.match(<span class="string">'[A-z]'</span>,demo3)</span><br><span class="line"><span class="comment"># print(res2)   # 从匹配字符的开头匹配,若开头不是想要的内容，则返回None，若是则继续往下匹配，直到全部匹配出结果</span></span><br><span class="line"><span class="comment"># print(res2.group())</span></span><br><span class="line"><span class="keyword">if</span> res2:     <span class="comment"># 可以通过判断是否匹配成功</span></span><br><span class="line">   print(res2)</span><br><span class="line">   print(<span class="string">'匹配成功'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">   print(<span class="string">'匹配失败'</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>为什么要使用正则</li>
</ul>
<p>比如要获取“一堆字符串”中的“某些字符”，正则表达式可以帮我们过滤，并提取出想要的字符数据。</p>
<p>例如：’dkljdwqoweiurorwytfc nnclaxxnjspwacmjdssu;slaksdoa’</p>
<p>我们需要在上面的字符串里面提取dssu，则可以使用正则表达式取过滤提取我们需要的数据</p>
<p>应用场景:</p>
<ul>
<li><p>爬虫: re, BeautifulSoup4, Xpath, selector</p>
</li>
<li><p>数据分析过滤数据: re, pandas, numpy…</p>
</li>
<li><p>用户名与密码、手机认证：检测输入内容的合法性</p>
<ul>
<li>用户名: alex</li>
</ul>
</li>
<li><p>如何使用正则表达式和re模块</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检测手机号码的合法性</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="comment"># phon_number = input('请输入11位手机号：').strip()</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    phon_number = input(<span class="string">'请输入11位手机号：'</span>).strip()</span><br><span class="line">    <span class="comment"># 需求: 11位、开头13/14/15/17/19</span></span><br><span class="line">    <span class="comment">#     # 参数1: 正则表达式  ''</span></span><br><span class="line">    <span class="comment">#     # 参数2: 需要过滤的字符串</span></span><br><span class="line">    <span class="comment">#     # ^: 代表“开头”</span></span><br><span class="line">    <span class="comment">#     # $: 代表“结束”</span></span><br><span class="line">    <span class="comment">#     # |: 代表“或”</span></span><br><span class="line">    <span class="comment">#     # (13|14): 可以获取一个值，判断是否是13或14.</span></span><br><span class="line">    <span class="comment">#     # &#123;1&#125;: 需要获取1个值 限制数量</span></span><br><span class="line">    <span class="comment">#     # []: 分组限制取值范围</span></span><br><span class="line">    <span class="comment"># #     # [0-9]: 限制只能获取0——9的某一个字符。</span></span><br><span class="line">    <span class="comment"># if re.match(参数1，参数2）: match表示从头开始比较</span></span><br><span class="line">    <span class="comment"># if re.match('^(13|15|14|17|19)[0-9]&#123;9&#125;$',phon_number):</span></span><br><span class="line">    <span class="keyword">if</span> re.match(<span class="string">'(13|15|14|17|19)[0-9]&#123;9&#125;'</span>, phon_number):</span><br><span class="line">        print(<span class="string">'手机号合法'</span>)</span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(<span class="string">'不合法'</span>)</span><br></pre></td></tr></table></figure>

<h2 id="13-logging模块"><a href="#13-logging模块" class="headerlink" title="13.logging模块"></a>13.logging模块</h2><p>配置日志的模块</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">logging的配置信息</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string">logging配置</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> logging.config</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义三种日志输出格式 开始</span></span><br><span class="line">standard_format = <span class="string">'[%(asctime)s][%(threadName)s:%(thread)d][task_id:%(name)s][%(filename)s:%(lineno)d]'</span> \</span><br><span class="line">                  <span class="string">'[%(levelname)s][%(message)s]'</span> <span class="comment">#其中name为getlogger指定的名字</span></span><br><span class="line"></span><br><span class="line">simple_format = <span class="string">'[%(levelname)s][%(asctime)s][%(filename)s:%(lineno)d]%(message)s'</span></span><br><span class="line"></span><br><span class="line">id_simple_format = <span class="string">'[%(levelname)s][%(asctime)s] %(message)s'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义日志输出格式 结束</span></span><br><span class="line"><span class="comment"># ****************注意1: log文件的目录</span></span><br><span class="line">BASE_PATH = os.path.dirname(os.path.dirname(__file__))</span><br><span class="line">logfile_dir = os.path.join(BASE_PATH, <span class="string">'log'</span>)</span><br><span class="line"><span class="comment"># print(logfile_dir)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ****************注意2: log文件名</span></span><br><span class="line">logfile_name = <span class="string">'user.log'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果不存在定义的日志目录就创建一个</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.isdir(logfile_dir):</span><br><span class="line">    os.mkdir(logfile_dir)</span><br><span class="line"></span><br><span class="line"><span class="comment"># log文件的全路径</span></span><br><span class="line">logfile_path = os.path.join(logfile_dir, logfile_name)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ****************注意3: log配置字典</span></span><br><span class="line">LOGGING_DIC = &#123;</span><br><span class="line">    <span class="string">'version'</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="string">'disable_existing_loggers'</span>: <span class="literal">False</span>,</span><br><span class="line">    <span class="string">'formatters'</span>: &#123;</span><br><span class="line">        <span class="string">'standard'</span>: &#123;</span><br><span class="line">            <span class="string">'format'</span>: standard_format</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">'simple'</span>: &#123;</span><br><span class="line">            <span class="string">'format'</span>: simple_format</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">'filters'</span>: &#123;&#125;,</span><br><span class="line">    <span class="string">'handlers'</span>: &#123;</span><br><span class="line">        <span class="comment">#打印到终端的日志</span></span><br><span class="line">        <span class="string">'console'</span>: &#123;</span><br><span class="line">            <span class="string">'level'</span>: <span class="string">'DEBUG'</span>,</span><br><span class="line">            <span class="string">'class'</span>: <span class="string">'logging.StreamHandler'</span>,  <span class="comment"># 打印到屏幕</span></span><br><span class="line">            <span class="string">'formatter'</span>: <span class="string">'simple'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment"># 打印到文件的日志,收集info及以上的日志</span></span><br><span class="line">        <span class="string">'default'</span>: &#123;</span><br><span class="line">            <span class="string">'level'</span>: <span class="string">'DEBUG'</span>,</span><br><span class="line">            <span class="string">'class'</span>: <span class="string">'logging.handlers.RotatingFileHandler'</span>,  <span class="comment"># 保存到文件</span></span><br><span class="line">            <span class="string">'formatter'</span>: <span class="string">'standard'</span>,</span><br><span class="line">            <span class="string">'filename'</span>: logfile_path,  <span class="comment"># 日志文件</span></span><br><span class="line">            <span class="string">'maxBytes'</span>: <span class="number">1024</span>*<span class="number">1024</span>*<span class="number">5</span>,  <span class="comment"># 日志大小 5M</span></span><br><span class="line">            <span class="string">'backupCount'</span>: <span class="number">5</span>,</span><br><span class="line">            <span class="string">'encoding'</span>: <span class="string">'utf-8'</span>,  <span class="comment"># 日志文件的编码，再也不用担心中文log乱码了</span></span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">'loggers'</span>: &#123;</span><br><span class="line">        <span class="comment">#logging.getLogger(__name__)拿到的logger配置</span></span><br><span class="line">        <span class="string">''</span>: &#123;</span><br><span class="line">            <span class="string">'handlers'</span>: [<span class="string">'default'</span>, <span class="string">'console'</span>],  <span class="comment"># 这里把上面定义的两个handler都加上，即log数据既写入文件又打印到屏幕</span></span><br><span class="line">            <span class="string">'level'</span>: <span class="string">'DEBUG'</span>,</span><br><span class="line">            <span class="string">'propagate'</span>: <span class="literal">True</span>,  <span class="comment"># 向上（更高level的logger）传递</span></span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意4:</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_logger</span><span class="params">(user_type)</span>:</span></span><br><span class="line">    <span class="comment"># 1.加载log配置字典到logging模块的配置中</span></span><br><span class="line">    logging.config.dictConfig(LOGGING_DIC)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2.获取日志对象</span></span><br><span class="line">    <span class="comment"># logger = logging.getLogger('user')</span></span><br><span class="line">    <span class="comment"># logger = logging.getLogger('bank')</span></span><br><span class="line">    <span class="comment"># logger = logging.getLogger('shop')</span></span><br><span class="line">    logger = logging.getLogger(user_type)</span><br><span class="line">    <span class="keyword">return</span> logger</span><br><span class="line"></span><br><span class="line"><span class="comment"># logging.config.dictConfig(LOGGING_DIC)</span></span><br><span class="line"><span class="comment"># # 调用获取日志函数的到日志对象</span></span><br><span class="line"><span class="comment"># logger = logging.getLogger('user')</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过logger日志对象，调用内部的日志打印</span></span><br><span class="line">logger = get_logger(<span class="string">'user'</span>)</span><br><span class="line"><span class="comment"># '只要思想不滑坡，方法总比问题多!'就是需要记录的日志信息</span></span><br><span class="line">logger.info(<span class="string">'学习不要浮躁，一步一个脚印!'</span>)</span><br><span class="line"><span class="comment"># logger.info('只要思想不滑坡，方法总比问题多!')</span></span><br></pre></td></tr></table></figure>

<p>15.XML模块<br>xml是实现不同语言或程序之间进行数据交换的协议，跟json差不多，但json使用起来更简单，不过，古时候，在json还没诞生的黑暗年代，大家只能选择用xml呀，至今很多传统公司如金融行业的很多系统的接口还主要是xml。</p>
<p>xml的格式如下，就是通过&lt;&gt;节点来区别数据结构的:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0"?&gt;</span><br><span class="line">&lt;data&gt;</span><br><span class="line">    &lt;country name=<span class="string">"Liechtenstein"</span>&gt;</span><br><span class="line">        &lt;rank updated="yes"&gt;2&lt;/rank&gt;</span><br><span class="line">        &lt;year&gt;2008&lt;/year&gt;</span><br><span class="line">        &lt;gdppc&gt;141100&lt;/gdppc&gt;</span><br><span class="line">        &lt;neighbor name=<span class="string">"Austria"</span> direction=<span class="string">"E"</span>/&gt;</span><br><span class="line">        &lt;neighbor name=<span class="string">"Switzerland"</span> direction=<span class="string">"W"</span>/&gt;</span><br><span class="line">    &lt;/country&gt;</span><br><span class="line">    &lt;country name=<span class="string">"Singapore"</span>&gt;</span><br><span class="line">        &lt;rank updated="yes"&gt;5&lt;/rank&gt;</span><br><span class="line">        &lt;year&gt;2011&lt;/year&gt;</span><br><span class="line">        &lt;gdppc&gt;59900&lt;/gdppc&gt;</span><br><span class="line">        &lt;neighbor name=<span class="string">"Malaysia"</span> direction=<span class="string">"N"</span>/&gt;</span><br><span class="line">    &lt;/country&gt;</span><br><span class="line">    &lt;country name=<span class="string">"Panama"</span>&gt;</span><br><span class="line">        &lt;rank updated="yes"&gt;69&lt;/rank&gt;</span><br><span class="line">        &lt;year&gt;2011&lt;/year&gt;</span><br><span class="line">        &lt;gdppc&gt;13600&lt;/gdppc&gt;</span><br><span class="line">        &lt;neighbor name=<span class="string">"Costa Rica"</span> direction=<span class="string">"W"</span>/&gt;</span><br><span class="line">        &lt;neighbor name=<span class="string">"Colombia"</span> direction=<span class="string">"E"</span>/&gt;</span><br><span class="line">    &lt;/country&gt;</span><br><span class="line">&lt;/data&gt;</span><br></pre></td></tr></table></figure>

<p>xml协议在各个语言里的都 是支持的，在python中可以用以下模块操作xml：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># print(root.iter('year')) #全文搜索</span></span><br><span class="line"><span class="comment"># print(root.find('country')) #在root的子节点找，只找一个</span></span><br><span class="line"><span class="comment"># print(root.findall('country')) #在root的子节点找，找所有</span></span><br><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"> </span><br><span class="line">tree = ET.parse(<span class="string">"xmltest.xml"</span>)</span><br><span class="line">root = tree.getroot()</span><br><span class="line">print(root.tag)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#遍历xml文档</span></span><br><span class="line"><span class="keyword">for</span> child <span class="keyword">in</span> root:</span><br><span class="line">    print(<span class="string">'========&gt;'</span>,child.tag,child.attrib,child.attrib[<span class="string">'name'</span>])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> child:</span><br><span class="line">        print(i.tag,i.attrib,i.text)</span><br><span class="line"> </span><br><span class="line"><span class="comment">#只遍历year 节点</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> root.iter(<span class="string">'year'</span>):</span><br><span class="line">    print(node.tag,node.text)</span><br><span class="line"><span class="comment">#---------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"> </span><br><span class="line">tree = ET.parse(<span class="string">"xmltest.xml"</span>)</span><br><span class="line">root = tree.getroot()</span><br><span class="line"> </span><br><span class="line"><span class="comment">#修改</span></span><br><span class="line"><span class="keyword">for</span> node <span class="keyword">in</span> root.iter(<span class="string">'year'</span>):</span><br><span class="line">    new_year=int(node.text)+<span class="number">1</span></span><br><span class="line">    node.text=str(new_year)</span><br><span class="line">    node.set(<span class="string">'updated'</span>,<span class="string">'yes'</span>)</span><br><span class="line">    node.set(<span class="string">'version'</span>,<span class="string">'1.0'</span>)</span><br><span class="line">tree.write(<span class="string">'test.xml'</span>)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="comment">#删除node</span></span><br><span class="line"><span class="keyword">for</span> country <span class="keyword">in</span> root.findall(<span class="string">'country'</span>):</span><br><span class="line">   rank = int(country.find(<span class="string">'rank'</span>).text)</span><br><span class="line">   <span class="keyword">if</span> rank &gt; <span class="number">50</span>:</span><br><span class="line">     root.remove(country)</span><br><span class="line"> </span><br><span class="line">tree.write(<span class="string">'output.xml'</span>)</span><br><span class="line"><span class="comment">#在country内添加（append）节点year2</span></span><br><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line">tree = ET.parse(<span class="string">"a.xml"</span>)</span><br><span class="line">root=tree.getroot()</span><br><span class="line"><span class="keyword">for</span> country <span class="keyword">in</span> root.findall(<span class="string">'country'</span>):</span><br><span class="line">    <span class="keyword">for</span> year <span class="keyword">in</span> country.findall(<span class="string">'year'</span>):</span><br><span class="line">        <span class="keyword">if</span> int(year.text) &gt; <span class="number">2000</span>:</span><br><span class="line">            year2=ET.Element(<span class="string">'year2'</span>)</span><br><span class="line">            year2.text=<span class="string">'新年'</span></span><br><span class="line">            year2.attrib=&#123;<span class="string">'update'</span>:<span class="string">'yes'</span>&#125;</span><br><span class="line">            country.append(year2) <span class="comment">#往country节点下添加子节点</span></span><br><span class="line"></span><br><span class="line">tree.write(<span class="string">'a.xml.swap'</span>)</span><br></pre></td></tr></table></figure>

<p>自己创建xml文档：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xml.etree.ElementTree <span class="keyword">as</span> ET</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">new_xml = ET.Element(<span class="string">"namelist"</span>)</span><br><span class="line">name = ET.SubElement(new_xml,<span class="string">"name"</span>,attrib=&#123;<span class="string">"enrolled"</span>:<span class="string">"yes"</span>&#125;)</span><br><span class="line">age = ET.SubElement(name,<span class="string">"age"</span>,attrib=&#123;<span class="string">"checked"</span>:<span class="string">"no"</span>&#125;)</span><br><span class="line">sex = ET.SubElement(name,<span class="string">"sex"</span>)</span><br><span class="line">sex.text = <span class="string">'33'</span></span><br><span class="line">name2 = ET.SubElement(new_xml,<span class="string">"name"</span>,attrib=&#123;<span class="string">"enrolled"</span>:<span class="string">"no"</span>&#125;)</span><br><span class="line">age = ET.SubElement(name2,<span class="string">"age"</span>)</span><br><span class="line">age.text = <span class="string">'19'</span></span><br><span class="line"> </span><br><span class="line">et = ET.ElementTree(new_xml) <span class="comment">#生成文档对象</span></span><br><span class="line">et.write(<span class="string">"test.xml"</span>, encoding=<span class="string">"utf-8"</span>,xml_declaration=<span class="literal">True</span>)</span><br><span class="line"> </span><br><span class="line">ET.dump(new_xml) <span class="comment">#打印生成的格式</span></span><br></pre></td></tr></table></figure>

<p>16.typing模块</p>
<p><a href="https://www.cnblogs.com/liuqingzheng/p/11012099.html#_label1" target="_blank" rel="noopener">https://www.cnblogs.com/liuqingzheng/p/11012099.html#_label1</a></p>
<h2 id="14-包"><a href="#14-包" class="headerlink" title="14.包"></a>14.包</h2><h3 id="1-什么是包？"><a href="#1-什么是包？" class="headerlink" title="1.什么是包？"></a>1.什么是包？</h3><p>包是一个带有__ init__.py的文件夹，包也可以被导入，并且可以一并导入包下的所有模块。</p>
<h3 id="2-为什么要使用包？"><a href="#2-为什么要使用包？" class="headerlink" title="2.为什么要使用包？"></a>2.为什么要使用包？</h3><p>包可以帮我们管理模块，在包中有一个<strong>init</strong>.py, 由它来帮我们管理模块。</p>
<h3 id="3-怎么使用包？"><a href="#3-怎么使用包？" class="headerlink" title="3.怎么使用包？"></a>3.怎么使用包？</h3><ul>
<li>import 包.模块名</li>
<li>from 包 import 模块名</li>
<li>from 包.模块名 import 模块中的名字</li>
</ul>
<h3 id="4-导入包时发生的事情"><a href="#4-导入包时发生的事情" class="headerlink" title="4.导入包时发生的事情:"></a>4.导入包时发生的事情:</h3><p>1.当包被导入时，会以包中的__ init __.py来产生一个名称空间。</p>
<p>2.然后执行__ init <em>.py文件, 会将 _</em> init __.py中的所有名字添加到名称空间中。</p>
<p>3.接着会将包下所有的模块的名字加载到__ init__.py产生的名称空间中。</p>
<p>4.导入的模块指向的名称空间其实就是<em>ini_</em>.py产生的名称空间中。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/10/21/python%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97/" data-id="ckd3cw4i9000nrcut66c6ftl5" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/" rel="tag">Python</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/" rel="tag">MySQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C%E5%92%8C%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" rel="tag">网络和并发编程</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/MySQL/" style="font-size: 15px;">MySQL</a> <a href="/tags/Python/" style="font-size: 20px;">Python</a> <a href="/tags/%E7%BD%91%E7%BB%9C%E5%92%8C%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/" style="font-size: 10px;">网络和并发编程</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/11/29/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/">并发编程基础</a>
          </li>
        
          <li>
            <a href="/2018/11/25/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/">网络编程基础</a>
          </li>
        
          <li>
            <a href="/2018/11/24/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E5%92%8C%E9%94%81/">MySQL数据库的隔离级别和锁</a>
          </li>
        
          <li>
            <a href="/2018/11/16/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C/">MySQL数据库的基本操作</a>
          </li>
        
          <li>
            <a href="/2018/11/11/MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%AD%97%E6%AE%B5%E7%B1%BB%E5%9E%8B%E5%92%8C%E7%BA%A6%E6%9D%9F%E6%9D%A1%E4%BB%B6/">MySQL数据库的字段类型和约束条件</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 Mr Jiang<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>